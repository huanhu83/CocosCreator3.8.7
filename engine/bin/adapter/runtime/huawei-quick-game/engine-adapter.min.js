!function a(c,i,r){function o(n,e){if(!i[n]){if(!c[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(s)return s(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}t=i[n]={exports:{}},c[n][0].call(t.exports,function(e){return o(c[n][1][e]||e)},t,t.exports,a,c,i,r)}return i[n].exports}for(var s="function"==typeof require&&require,e=0;e<r.length;e++)o(r[e]);return o}({1:[function(e,n,t){"use strict";function a(){this._delegate=null,this._editing=!1,this._eventListeners={onKeyboardInput:null,onKeyboardConfirm:null,onKeyboardComplete:null}}var c,i,r,o,s;cc&&cc.internal&&cc.internal.EditBox&&(c=cc.internal.EditBox,i=cc.js,r=c.KeyboardReturnType,s=o=null,i.extend(a,c._EditBoxImpl),c._EditBoxImpl=a,Object.assign(a.prototype,{init:function(e){e?this._delegate=e:cc.error("EditBox init failed")},beginEditing:function(){var n=this;this._editing||this._ensureKeyboardHide(function(){var e=n._delegate;n._showKeyboard(),n._registerKeyboardEvent(),n._editing=!0,s=n,e._editBoxEditingDidBegan()})},endEditing:function(){this._hideKeyboard();var e=this._eventListeners;e.onKeyboardComplete&&e.onKeyboardComplete()},_registerKeyboardEvent:function(){var t=this,a=this._delegate,e=this._eventListeners;e.onKeyboardInput=function(e){a._string!==e.value&&a._editBoxTextChanged(e.value)},e.onKeyboardConfirm=function(e){a._editBoxEditingReturn();var n=t._eventListeners;n.onKeyboardComplete&&n.onKeyboardComplete()},e.onKeyboardComplete=function(){t._editing=!1,s=null,t._unregisterKeyboardEvent(),a._editBoxEditingDidEnded()},ral.onKeyboardInput(e.onKeyboardInput),ral.onKeyboardConfirm(e.onKeyboardConfirm),ral.onKeyboardComplete(e.onKeyboardComplete)},_unregisterKeyboardEvent:function(){var e=this._eventListeners;e.onKeyboardInput&&(ral.offKeyboardInput(e.onKeyboardInput),e.onKeyboardInput=null),e.onKeyboardConfirm&&(ral.offKeyboardConfirm(e.onKeyboardConfirm),e.onKeyboardConfirm=null),e.onKeyboardComplete&&(ral.offKeyboardComplete(e.onKeyboardComplete),e.onKeyboardComplete=null)},_otherEditing:function(){return!!s&&s!==this&&s._editing},_ensureKeyboardHide:function(e){var n=this._otherEditing();if(!n&&!o)return e();o&&clearTimeout(o),n&&s.endEditing(),o=setTimeout(function(){o=null,e()},600)},_showKeyboard:function(){var e=this._delegate,n=e.inputMode===c.InputMode.ANY;ral.showKeyboard({defaultValue:e.string,maxLength:e.maxLength<0?65535:e.maxLength,multiple:n,confirmHold:!1,confirmType:function(e){switch(e){case r.DEFAULT:case r.DONE:return"done";case r.SEND:return"send";case r.SEARCH:return"search";case r.GO:return"go";case r.NEXT:return"next"}return"done"}(e.returnType),success:function(e){},fail:function(e){cc.warn(e.errMsg)}})},_hideKeyboard:function(){ral.hideKeyboard({success:function(e){},fail:function(e){cc.warn(e.errMsg)}})}}))},{}],2:[function(s,j,A){"use strict";var l=s("./cache-manager"),e=s("./fs-utils"),u=e.downloadFile,c=e.readText,i=e.readArrayBuffer,a=e.readJson,f=e.loadSubpackage,d=e.getUserDataPath,h=e._subpackagesPath,g=(cc.assetManager.fsUtils=ral.fsUtils,/^https?:\/\/.*/),m=cc.assetManager.downloader,e=cc.assetManager.parser,n=cc.assetManager.presets,p=(m.maxConcurrency=12,m.maxRequestsPerFrame=64,n.scene.maxConcurrency=12,n.scene.maxRequestsPerFrame=64,{}),b={};function t(e,n,t){if(g.test(e))t&&t(new Error("Can not load remote scripts"));else{if(b[e])return t&&t();s(e),b[e]=!0,t&&t(null)}}function r(n,e,t){cc.AudioPlayer.load(n).then(function(e){e={player:e,url:n,duration:e.duration,type:e.type};t(null,e)}).catch(function(e){t(e)})}function o(a,n,c,e,i){var t=I(a,c);t.inLocal?n(t.url,c,i):t.inCache?(l.updateLastTime(a),n(t.url,c,function(e,n){e&&l.removeCache(a),i(e,n)})):u(a,null,c.header,e,function(e,t){e?i(e,null):n(t,c,function(e,n){e||(l.tempFiles.add(a,t),l.cacheFile(a,t,c.cacheEnabled,c.__cacheBundleRoot__,!0)),i(e,n)})})}function y(e,n,t){i(e,t)}function w(e,n,t){c(e,t)}function v(e,n,t){a(e,t)}function F(e,n,t){o(e,v,n,n.onFileProgress,t)}function _(e,n,t){var a=function(e){var n=e.lastIndexOf(".ttf");-1===n&&(n=e.lastIndexOf(".tmp"));if(-1===n)return e;var t=e.lastIndexOf("/");e="".concat(-1===t?e.substring(0,n):e.substring(t+1,n),"_LABEL");return e}(e),e=new FontFace(a,"url('".concat(e,"')"));document.fonts.add(e),e.load(),e.loaded.then(function(){t(null,a)},function(){cc.warnID(4933,a),t(null,a)})}function x(e,n,t){t(null,e)}function C(e,n,t){o(e,x,n,n.onFileProgress,t)}function E(e,t,a){i(e,function(e,n){if(e)return a(e);K(n,t,a)})}function M(e,t,a){i(e,function(e,n){if(e)return a(e);P(n,t,a)})}function S(e,t,a){i(e,function(e,n){if(e)return a(e);T(n,t,a)})}function D(e,t,a){c(e,function(e,n){if(e)return a(e);B(n,t,a)})}var K=e.parsePVRTex,P=e.parsePKMTex,T=e.parseASTCTex,B=e.parsePlist,I=(m.downloadScript=t,m._downloadArrayBuffer=function(e,n,t){o(e,y,n,n.onFileProgress,t)},m._downloadJson=F,e.parsePVRTex=E,e.parsePKMTex=M,e.parseASTCTex=S,e.parsePlist=D,m.register({".js":t,".mp3":C,".ogg":C,".wav":C,".m4a":C,".png":C,".jpg":C,".bmp":C,".jpeg":C,".gif":C,".ico":C,".tiff":C,".image":C,".webp":C,".pvr":C,".pkm":C,".astc":C,".font":C,".eot":C,".ttf":C,".woff":C,".svg":C,".ttc":C,".txt":C,".xml":C,".vsh":C,".fsh":C,".atlas":C,".tmx":C,".tsx":C,".plist":C,".fnt":C,".json":F,".ExportJson":C,".binary":C,".bin":C,".dbbin":C,".skel":C,".mp4":C,".avi":C,".mov":C,".mpg":C,".mpeg":C,".rm":C,".rmvb":C,bundle:function(e,n,r){var t,o,a,c=cc.path.basename(e),i=(i=n.version||cc.assetManager.downloader.bundleVers[c])?"".concat(i,"."):"";p[c]?(a="".concat(h).concat(c,"/config.").concat(i,"json"),f(c,n.onFileProgress,function(e){e?r(e,null):F(a,n,function(e,n){n&&(n.base="".concat(h).concat(c,"/")),r(e,n)})})):(g.test(e)||e.startsWith(d())?(o=e,t="src/bundle-scripts/".concat(c,"/index.").concat(i,"js"),l.makeBundleFolder(c)):-1!==m.remoteBundles.indexOf(c)?(o="".concat(m.remoteServerAddress,"remote/").concat(c),t="src/bundle-scripts/".concat(c,"/index.").concat(i,"js"),l.makeBundleFolder(c)):(o="assets/".concat(c),t="assets/".concat(c,"/index.").concat(i,"js")),b[t]||(s(t),b[t]=!0),n.__cacheBundleRoot__=c,F(a="".concat(o,"/config.").concat(i,"json"),n,function(e,t){var a,c,i;e?r&&r(e):t.isZip?(e=t.zipVersion,e="".concat(o,"/res.").concat(e?"".concat(e,"."):"","zip"),a=e,c=n,i=function(e,n){e?r&&r(e):(t.base="".concat(n,"/res/"),r&&r(null,t))},(e=l.cachedFiles.get(a))?(l.updateLastTime(a),i&&i(null,e.url)):g.test(a)?u(a,null,c.header,c.onFileProgress,function(e,n){e?i&&i(e):l.unzipAndCacheBundle(a,n,c.__cacheBundleRoot__,i)}):l.unzipAndCacheBundle(a,a,c.__cacheBundleRoot__,i)):(t.base="".concat(o,"/"),r&&r(null,t))}))},default:function(e,n,t){o(e,w,n,n.onFileProgress,t)}}),e.register({".png":m.downloadDomImage,".jpg":m.downloadDomImage,".bmp":m.downloadDomImage,".jpeg":m.downloadDomImage,".gif":m.downloadDomImage,".ico":m.downloadDomImage,".tiff":m.downloadDomImage,".image":m.downloadDomImage,".webp":m.downloadDomImage,".pvr":E,".pkm":M,".astc":S,".font":_,".eot":_,".ttf":_,".woff":_,".svg":_,".ttc":_,".mp3":r,".ogg":r,".wav":r,".m4a":r,".txt":w,".xml":w,".vsh":w,".fsh":w,".atlas":w,".tmx":w,".tsx":w,".fnt":w,".plist":D,".binary":y,".bin":y,".dbbin":y,".skel":y,".ExportJson":v}),function(e,n){var t=!1,a=!1;return!e.startsWith(d())&&g.test(e)?n.reload||((n=l.cachedFiles.get(e))?(a=!0,e=n.url):(n=l.tempFiles.get(e))&&(t=!0,e=n)):t=!0,{url:e,inLocal:t,inCache:a}}),O=(cc.assetManager.transformPipeline.append(function(e){for(var n=e.output=e.input,t=0,a=n.length;t<a;t++){var c=n[t],i=c.options;if(c.config)i.__cacheBundleRoot__=c.config.name;else{if("bundle"===c.ext)continue;i.cacheEnabled=void 0!==i.cacheEnabled&&i.cacheEnabled}".cconb"===c.ext?c.url=c.url.replace(c.ext,".bin"):".ccon"===c.ext&&(c.url=c.url.replace(c.ext,".json"))}}),cc.assetManager.init);cc.assetManager.init=function(e){O.call(cc.assetManager,e);e=cc.settings.querySettings("assets","subpackages");e&&e.forEach(function(e){return p[e]="".concat(h).concat(e)}),l.init()}},{"./cache-manager":3,"./fs-utils":5}],3:[function(e,n,t){"use strict";var e=e("./fs-utils"),a=e.getUserDataPath,c=e.readJsonSync,o=e.makeDirSync,i=e.writeFileSync,u=e.copyFile,f=e.downloadFile,r=e.deleteFile,s=e.rmdirSync,l=e.unzip,d=e.isOutOfStorage,h=!1,g=null,m=!1,p=0,b=/^https?:\/\/.*/;cc.assetManager.cacheManager=n.exports={cacheDir:"gamecaches",cachedFileName:"cacheList.json",cacheEnabled:!0,autoClear:!0,cacheInterval:500,deleteInterval:500,writeFileInterval:2e3,outOfStorage:!1,tempFiles:null,cachedFiles:null,cacheQueue:{},version:"1.0",getCache:function(e){return this.cachedFiles.has(e)?this.cachedFiles.get(e).url:""},getTemp:function(e){return this.tempFiles.has(e)?this.tempFiles.get(e):""},init:function(){this.cacheDir="".concat(a(),"/").concat(this.cacheDir);var e="".concat(this.cacheDir,"/").concat(this.cachedFileName),n=c(e);n instanceof Error||!n.version?(n instanceof Error||s(this.cacheDir,!0),this.cachedFiles=new cc.AssetManager.Cache,o(this.cacheDir,!0),i(e,JSON.stringify({files:this.cachedFiles._map,version:this.version}),"utf8")):this.cachedFiles=new cc.AssetManager.Cache(n.files),this.tempFiles=new cc.AssetManager.Cache},updateLastTime:function(e){this.cachedFiles.has(e)&&(this.cachedFiles.get(e).lastTime=Date.now())},_write:function(){g=null,i("".concat(this.cacheDir,"/").concat(this.cachedFileName),JSON.stringify({files:this.cachedFiles._map,version:this.version}),"utf8")},writeCacheFile:function(){g=g||setTimeout(this._write.bind(this),this.writeFileInterval)},_cache:function(){h=!1;var e,n,t,a,c,i,r,o=this,s="";for(e in this.cacheQueue){s=e;break}function l(e){if(e){if(d(e.message))return o.outOfStorage=!0,void(o.autoClear&&o.clearLRU())}else o.cachedFiles.add(s,{bundle:c,url:r,lastTime:i}),o.writeCacheFile();delete o.cacheQueue[s],cc.js.isEmptyObject(o.cacheQueue)||h||(h=!0,setTimeout(o._cache.bind(o),o.cacheInterval))}s&&(t=(n=this.cacheQueue[s]).srcUrl,a=n.isCopy,c=n.cacheBundleRoot,i=Date.now().toString(),r="",r=(c?"".concat(this.cacheDir,"/").concat(c,"/"):"".concat(this.cacheDir,"/")).concat(i).concat(p++).concat(cc.path.extname(s)),a?u(t,r,l):f(t,r,null,l))},cacheFile:function(e,n,t,a,c){!(t=void 0!==t?t:this.cacheEnabled)||this.cacheQueue[e]||this.cachedFiles.has(e)||(this.cacheQueue[e]={srcUrl:n,cacheBundleRoot:a,isCopy:c},h)||this.outOfStorage||(h=!0,setTimeout(this._cache.bind(this),this.cacheInterval))},clearCache:function(){var n=this;s(this.cacheDir,!0),this.cachedFiles=new cc.AssetManager.Cache,o(this.cacheDir,!0),this.outOfStorage=!1,clearTimeout(g),this._write(),cc.assetManager.bundles.forEach(function(e){b.test(e.base)&&n.makeBundleFolder(e.name)})},clearLRU:function(){if(!m){m=!0;var t=[],a=this;this.cachedFiles.forEach(function(n,e){a._isZipFile(e)&&cc.assetManager.bundles.find(function(e){return-1!==e.base.indexOf(n.url)})||t.push({originUrl:e,url:n.url,lastTime:n.lastTime})}),t.sort(function(e,n){return e.lastTime-n.lastTime}),t.length=Math.floor(t.length/3),t.length<3?console.warn("Insufficient storage, cleaning now"):t.length=Math.floor(t.length/3);for(var e=0,n=t.length;e<n;e++){var c="".concat(cc.assetManager.utils.getUuidFromURL(t[e].originUrl),"@native");cc.assetManager.files.remove(c),this.cachedFiles.remove(t[e].originUrl)}clearTimeout(g),this._write(),setTimeout(function e(){var n=t.pop();a._removePathOrFile(n.originUrl,n.url),0<t.length?setTimeout(e,a.deleteInterval):m=!1},a.deleteInterval)}},removeCache:function(e){var n;this.cachedFiles.has(e)&&(n=this.cachedFiles.remove(e).url,clearTimeout(g),this._write(),this._removePathOrFile(e,n))},_removePathOrFile:function(e,n){!this._isZipFile(e)||this._isZipFile(n)?r(n,this._deleteFileCB.bind(this)):(s(n,!0),this._deleteFileCB())},_deleteFileCB:function(e){e||(this.outOfStorage=!1)},makeBundleFolder:function(e){o("".concat(this.cacheDir,"/").concat(e),!0)},unzipAndCacheBundle:function(n,e,t,a){var c=Date.now().toString(),i="".concat(this.cacheDir,"/").concat(t,"/").concat(c).concat(p++),r=this;o(i,!0),l(e,i,function(e){e?(s(i,!0),d(e.message)&&(r.outOfStorage=!0,r.autoClear)&&r.clearLRU(),a&&a(e)):(r.cachedFiles.add(n,{bundle:t,url:i,lastTime:c}),r.writeCacheFile(),a&&a(null,i))})},_isZipFile:function(e){return".zip"===e.slice(-4)}}},{"./fs-utils":5}],4:[function(e,n,t){"use strict";var a=ral.createCanvas.bind(ral);ral.createCanvas=function(){var e=a();return e.style={},e}},{}],5:[function(e,n,t){"use strict";var c=ral.getFileSystemManager?ral.getFileSystemManager():null,a=/the maximum size of the file storage/,r={fs:c,_subpackagesPath:"usr_",isOutOfStorage:function(e){return a.test(e)},getUserDataPath:function(){return ral.env.USER_DATA_PATH},checkFsValid:function(){return!!c||(console.warn("can not get the file system!"),!1)},deleteFile:function(n,t){c.unlink({filePath:n,success:function(){t&&t(null)},fail:function(e){console.warn("Delete file failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error(e.errMsg))}})},downloadFile:function(n,e,t,a,c){var i={url:n,success:function(e){200===e.statusCode?c&&c(null,e.tempFilePath||e.filePath):(e.filePath&&r.deleteFile(e.filePath),console.warn("Download file failed: path: ".concat(n," message: ").concat(e.statusCode)),c&&c(new Error(e.statusCode),null))},fail:function(e){console.warn("Download file failed: path: ".concat(n," message: ").concat(e.errMsg)),c&&c(new Error(e.errMsg),null)}},e=(e&&(i.filePath=e),t&&(i.header=t),ral.downloadFile(i));a&&e.onProgressUpdate(a)},saveFile:function(n,e,t){ral.saveFile({tempFilePath:n,filePath:e,success:function(e){t&&t(null)},fail:function(e){console.warn("Save file failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error(e.errMsg))}})},copyFile:function(n,e,t){c.copyFile({srcPath:n,destPath:e,success:function(){t&&t(null)},fail:function(e){console.warn("Copy file failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error(e.errMsg))}})},writeFile:function(n,e,t,a){c.writeFile({filePath:n,encoding:t,data:e,success:function(){a&&a(null)},fail:function(e){console.warn("Write file failed: path: ".concat(n," message: ").concat(e.errMsg)),a&&a(new Error(e.errMsg))}})},writeFileSync:function(n,e,t){try{return c.writeFileSync(n,e,t),null}catch(e){return console.warn("Write file failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},readFile:function(n,e,t){c.readFile({filePath:n,encoding:e,success:function(e){t&&t(null,e.data)},fail:function(e){console.warn("Read file failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error(e.errMsg),null)}})},readDir:function(n,t){c.readdir({dirPath:n,success:function(e){t&&t(null,e.files)},fail:function(e){console.warn("Read directory failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error(e.errMsg),null)}})},readText:function(e,n){r.readFile(e,"utf8",n)},readArrayBuffer:function(e,n){r.readFile(e,"binary",n)},readJson:function(a,c){r.readFile(a,"utf8",function(n,e){var t=null;if(!n)try{t=JSON.parse(e)}catch(e){console.warn("Read json failed: path: ".concat(a," message: ").concat(e.message)),n=new Error(e.message)}c&&c(n,t)})},readJsonSync:function(n){try{var e=c.readFileSync(n,"utf8");return JSON.parse(e)}catch(e){return console.warn("Read json failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},makeDirSync:function(n,e){try{return c.mkdirSync(n,e),null}catch(e){return console.warn("Make directory failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},rmdirSync:function(n,e){try{return c.rmdirSync(n,e),null}catch(e){return console.warn("rm directory failed: path: ".concat(n," message: ").concat(e.message)),new Error(e.message)}},exists:function(e,n){c.access({path:e,success:function(){n&&n(!0)},fail:function(){n&&n(!1)}})},loadSubpackage:function(n,e,t){var a=ral.loadSubpackage({name:"".concat(r._subpackagesPath).concat(n),success:function(){t&&t()},fail:function(e){console.warn("Load Subpackage failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error("Failed to load subpackage ".concat(n,": ").concat(e.errMsg)))}});return e&&a.onProgressUpdate(e),a},unzip:function(n,e,t){c.unzip({zipFilePath:n,targetPath:e,success:function(){t&&t(null)},fail:function(e){console.warn("unzip failed: path: ".concat(n," message: ").concat(e.errMsg)),t&&t(new Error("unzip failed: ".concat(e.errMsg)))}})}};window.fsUtils=n.exports=r},{}],6:[function(e,n,t){"use strict";cc.game.restart=function(){},ral.onWindowResize&&ral.onWindowResize(function(e,n){cc.game.canvas&&cc.view.setCanvasSize(e,n)})},{}],7:[function(e,n,t){"use strict";e("./fs-utils"),e("./canvas"),e("./asset-manager.js"),e("./EditBox.js"),e("./game.js"),e("./wasm.js")},{"./EditBox.js":1,"./asset-manager.js":2,"./canvas":4,"./fs-utils":5,"./game.js":6,"./wasm.js":8}],8:[function(e,n,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"===a(ral.WebAssembly)&&"function"==typeof ral.WebAssembly.instantiateFromFile&&(ral.WebAssembly.instantiate=ral.WebAssembly.instantiateFromFile,window.CCWebAssembly=ral.WebAssembly)},{}],9:[function(e,n,t){"use strict";e("../../../common/engine/index")},{"../../../common/engine/index":7}]},{},[9]);