System.register(["./sorting-2d-CIasnD0H.js","./sprite-frame-CT0e6iHI.js","./sprite-8ksyG6DL.js","./label-PJV2Zpvv.js","./gc-object-BD6DANSw.js","./index-BcjqSS2q.js","./_virtual_internal_constants-CVZmBipG.js","./global-exports-ZavlJGEN.js","./pipeline-state-manager-C4BAah3w.js","./ui-renderer-BG8n0rhU.js","./node-event-BDYemSfE.js","./director-D6Xf3-Ej.js","./deprecated-gv6rCJsk.js","./mask.js","./rich-text.js","./graphics-pPwH7fWA.js","./scene-D5fG1En6.js","./prefab-CJahvMeV.js","./touch-Ch03mDFP.js","./sprite-renderer-CC0tdWTR.js","./sorting-layers-sC9IxUEk.js","./device-manager-BCOP-4pU.js","./buffer-barrier-CZBuOw0V.js","./debug-view-zRQBd5E1.js","./deprecated-BaebfHhU.js","./deprecated-BfPl6EQ2.js","./create-mesh-CgNcAxLl.js","./mesh-BsaPYlYJ.js","./wasm-web-DpHjq6qw.js","./zlib.min-CyXMsivM.js","./renderer-DVTO-7-w.js","./camera-component-DK1ym1MK.js","./deprecated-B2PZGYTz.js","./model-renderer-KnEZ5pPV.js"],(function(t){"use strict";var e,n,a,i,r,o,s,h,l,u,c,f,d,v,p,g,m,_,y,x,S,D,w,C,b,T,L,F,I,A,O,R,E,z,M,P,B,U,k,H,V,W,N,j,X,Y,q,G,Q,K,Z,J,$,tt,et,nt,at,it,rt,ot,st,ht,lt,ut,ct,ft,dt,vt,pt,gt,mt,_t,yt,xt,St,Dt,wt,Ct;return{setters:[function(i){e=i.D,n=i.f,a=i.B,t("UI",i.B)},function(e){i=e.S,r=e.d,t({Atlas:e.A,DynamicAtlasManager:e.D,SpriteFrame:e.S,SpriteFrameEvent:e.a,dynamicAtlasManager:e.d})},function(e){o=e.S,t({Sprite:e.S,SpriteAtlas:e.b,SpriteComponent:e.S})},function(e){s=e.L,h=e.C,l=e.s,u=e.O,c=e.a,f=e.b,d=e.f,v=e.H,p=e.V,g=e.g,m=e.c,_=e.i,y=e.d,x=e.e,S=e.h,D=e.j,w=e.k,C=e.F,b=e.l,T=e.B,t({BASELINE_RATIO:e.a,BitmapFont:e.B,CacheMode:e.k,Font:e.n,HorizontalTextAlignment:e.H,HtmlTextParser:e.o,LRUCache:e.p,Label:e.L,LabelAtlas:e.m,LabelComponent:e.L,MIDDLE_RATIO:e.M,Overflow:e.O,TTFFont:e.T,VerticalTextAlignment:e.V,fragmentText:e.f,getBaselineOffset:e.h,getEnglishWordPartAtFirst:e.t,getEnglishWordPartAtLast:e.u,getSymbolAt:e.c,getSymbolCodeAt:e.d,getSymbolLength:e.g,isEnglishWordPartAtFirst:e.q,isEnglishWordPartAtLast:e.r,isUnicodeCJK:e.e,isUnicodeSpace:e.i,safeMeasureText:e.b})},function(t){L=t._,F=t.w,I=t.a,A=t.H,O=t.l,R=t.b,E=t.k,z=t.T,M=t.h,P=t.au,B=t.aB,U=t.d},function(t){k=t.c,H=t.j,V=t.K,W=t.I,N=t.d,j=t.a,X=t.b,Y=t.s,q=t.r,G=t.q,Q=t.l,K=t.V,Z=t.C,J=t.a7,$=t.M,tt=t.i},null,function(t){et=t.c},function(t){nt=t.R},function(e){at=e.S,it=e.R,rt=e.b,ot=e.U,st=e.m,ht=e.M,lt=e.i,t({BaseRenderData:e.B,InstanceMaterialType:e.I,MeshBuffer:e.m,MeshRenderData:e.M,RenderComponent:e.U,RenderData:e.i,Renderable2D:e.U,StencilManager:e.n,UIRenderable:e.U,UIRenderer:e.U,UITransform:e.c,UITransformComponent:e.c,UIVertexFormat:e.o})},function(t){ut=t.C},function(t){ct=t.u,ft=t.d},function(t){dt=t.v},function(e){vt=e.Mask,pt=e.MaskType,t("MaskComponent",e.Mask)},function(e){gt=e.RichText,t("RichTextComponent",e.RichText)},function(e){mt=e.G,t("GraphicsComponent",e.G)},function(t){_t=t.W,yt=t.aH,xt=t.aI},function(t){St=t.E,Dt=t.i},function(t){wt=t.I,Ct=t.d},function(e){t({Canvas:e.C,CanvasComponent:e.C,RenderRoot2D:e.R,SpriteRenderer:e.S,UIComponent:e.U})},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var bt,Tt,Lt=k("cc.UIMeshRenderer")(bt=H(110)(bt=function(t){function e(){var e;return(e=t.call(this)||this)._modelComponent=null,e._dirtyVersion=-1,e._internalId=-1,e.stencilStage=at.DISABLED,e._renderData=null,e._renderEntity=new it(rt.DYNAMIC),e}L(e,t);var n=e.prototype;return n.__preload=function(){this.node._uiProps.uiComp=this},n.onEnable=function(){ct.addRenderer(this),this._markForUpdateRenderData()},n.onDisable=function(){ct.removeRenderer(this),this.renderEntity.enabled=this._canRender()},n.onLoad=function(){this.node._getUITransformComp()||this.node.addComponent("cc.UITransform"),this._modelComponent=this.getComponent("cc.ModelRenderer"),this._modelComponent?this.renderEntity.setNode(this.node):F(16378,this.node?this.node.name:"")},n.onDestroy=function(){this.renderEntity.setNode(null),this.node._uiProps.uiComp===this&&(this.node._uiProps.uiComp=null),this._modelComponent=this.getComponent("cc.ModelRenderer"),this._modelComponent&&(this._modelComponent._sceneGetter=null)},n._render=function(t){if(this._modelComponent){var e=this._modelComponent._collectModels();this._modelComponent._detachFromScene();for(var n=0;n<e.length;n++)e[n].enabled&&t.commitModel(this,e[n],this._modelComponent.material);return!0}return!1},n.fillBuffers=function(t){this.enabled&&this._render(t)},n.updateRenderer=function(){},n._uploadRenderData=function(){},n.postUpdateAssembler=function(){},n.update=function(){this._fitUIRenderQueue()},n._fitUIRenderQueue=function(){if(this._modelComponent)for(var t=this._modelComponent.sharedMaterials.length,e=0;e<t;e++){var n=this._modelComponent.getMaterialInstance(e);if(null!=n)for(var a=n.passes,i=a.length,r=0;r<i;r++)a[r].setPriority(nt.MAX-11),n.recompileShaders({CC_FORCE_FORWARD_SHADING:!0},r)}},n.markForUpdateRenderData=function(t){void 0===t&&(t=!0),this._markForUpdateRenderData(t)},n._markForUpdateRenderData=function(){ct.markDirtyRenderer(this)},n.setNodeDirty=function(){},n.setTextureDirty=function(){},n._canRender=function(){return this.enabled&&null!==this._modelComponent},I(e,[{key:"modelComponent",get:function(){return this._modelComponent}},{key:"renderEntity",get:function(){return A(Boolean(this._renderEntity),"this._renderEntity should not be invalid"),this._renderEntity}},{key:"renderData",get:function(){return this._renderData}}]),e}(ut))||bt)||bt;t({UIMeshRenderer:Lt,UIModelComponent:Lt}),et.UIMeshRenderer=Lt;var Ft,It,At=k("cc.LabelOutline")(Tt=H(110)(Tt=V(s)(Tt=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var n=e.prototype;return n.onEnable=function(){var t=this.node.getComponent(s);O(t),t.enableOutline=!0},n.onDisable=function(){var t=this.node.getComponent(s);O(t),t.enableOutline=!1},I(e,[{key:"color",get:function(){var t=this.node.getComponent(s);return O(t),t.outlineColor},set:function(t){var e=this.node.getComponent(s);O(e),e.outlineColor=t}},{key:"width",get:function(){var t=this.node.getComponent(s);return O(t),t.outlineWidth},set:function(t){var e=this.node.getComponent(s);O(e),e.outlineWidth=t}}]),e}(ut))||Tt)||Tt)||Tt;t({LabelOutline:At,LabelOutlineComponent:At}),et.LabelOutline=At;var Ot,Rt=k("cc.UIStaticBatch")(Ft=H(110)((It=function(t){function n(){var e;return(e=t.call(this)||this)._init=!1,e._bufferAccessor=null,e._dirty=!0,e._uiDrawBatchList=[],e}L(n,t);var a=n.prototype;return a.postUpdateAssembler=function(){},a.markAsDirty=function(){},a._requireDrawBatch=function(){var t=new e;return t.isStatic=!0,this._uiDrawBatchList.push(t),t},a._clearData=function(){if(this._bufferAccessor){this._bufferAccessor.reset();for(var t=this._getBatcher(),e=0;e<this._uiDrawBatchList.length;e++)this._uiDrawBatchList[e].destroy(t)}this._uiDrawBatchList.length=0,this._init=!1},a._getBatcher=function(){return ft.root&&ft.root.batcher2D?ft.root.batcher2D:(F(9301),null)},I(n,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&this._color.set(t)}},{key:"drawBatchList",get:function(){return this._uiDrawBatchList}}]),n}(ot),R(It.prototype,"color",[W],Object.getOwnPropertyDescriptor(It.prototype,"color"),It.prototype),Ft=It))||Ft)||Ft;t({UIStaticBatch:Rt,UIStaticBatchComponent:Rt});var Et,zt,Mt,Pt=t("LabelShadow",k("cc.LabelShadow")(Ot=H(110)(Ot=V(s)(Ot=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var n=e.prototype;return n.onEnable=function(){var t=this.node.getComponent(s);O(t),t.enableShadow=!0},n.onDisable=function(){var t=this.node.getComponent(s);O(t),t.enableShadow=!1},I(e,[{key:"color",get:function(){var t=this.node.getComponent(s);return O(t),t.shadowColor},set:function(t){var e=this.node.getComponent(s);O(e),e.shadowColor=t}},{key:"offset",get:function(){var t=this.node.getComponent(s);return O(t),t.shadowOffset},set:function(t){var e=this.node.getComponent(s);O(e),e.shadowOffset=t}},{key:"blur",get:function(){var t=this.node.getComponent(s);return O(t),t.shadowBlur},set:function(t){var e=this.node.getComponent(s);O(e),e.shadowBlur=t}}]),e}(ut))||Ot)||Ot)||Ot),Bt=k("cc.UIOpacity")(Et=H(110)(Et=N((zt=function(t){function e(){var e;return(e=t.call(this)||this)._opacity=Mt&&Mt(),e}L(e,t);var n=e.prototype;return n.onEnable=function(){this._syncLocalOpacity(this._opacity/255)},n.onDisable=function(){this._syncLocalOpacity(1)},n._syncLocalOpacity=function(t){this.node._uiProps.localOpacity=t},I(e,[{key:"opacity",get:function(){return this._opacity},set:function(t){this._opacity!==t&&(t=X(t,0,255),this._opacity=t,this._syncLocalOpacity(t/255))}}]),e}(ut),Mt=j(zt.prototype,"_opacity",[Y],(function(){return 255})),Et=zt))||Et)||Et)||Et;t({UIOpacity:Bt,UIOpacityComponent:Bt}),et.MaskComponent=vt,E(vt,"cc.MaskComponent"),et.LabelComponent=s,E(s,"cc.LabelComponent"),et.LabelOutlineComponent=At,E(At,"cc.LabelOutlineComponent"),et.RichTextComponent=gt,E(gt,"cc.RichTextComponent"),et.SpriteComponent=o,E(o,"cc.SpriteComponent"),et.UIModelComponent=Lt,E(Lt,"cc.UIModelComponent"),et.GraphicsComponent=mt,E(mt,"cc.GraphicsComponent"),E(Rt,"cc.UIStaticBatchComponent"),E(Bt,"cc.UIOpacityComponent"),q(vt.prototype,"Mask",[{name:"graphics",newName:"subComp",target:vt.prototype,targetName:"Mask"}]),q(pt,"MaskType",[{name:"RECT",newName:"GRAPHICS_RECT",target:pt,targetName:"MaskType"},{name:"ELLIPSE",newName:"GRAPHICS_ELLIPSE",target:pt,targetName:"MaskType"},{name:"IMAGE_STENCIL",newName:"SPRITE_STENCIL",target:pt,targetName:"MaskType"}]),G(At.prototype,"LabelOutline",[{name:"width",suggest:"Please use Label.outlineWidth instead."},{name:"color",suggest:"Please use Label.outlineColor instead."}]),G(Pt.prototype,"LabelShadow",[{name:"color",suggest:"Please use Label.shadowColor instead."},{name:"offset",suggest:"Please use Label.shadowOffset instead."},{name:"blur",suggest:"Please use Label.shadowBlur instead."}]);var Ut=["left","center","right"],kt=2048,Ht=S(),Vt=(1/255).toFixed(3),Wt=function(){this.char="",this.valid=!0,this.x=0,this.y=0,this.line=0,this.hash=""},Nt=function(){function t(){this._context=null,this._canvas=null,this._canvasData=null,this._lettersInfo=[],this._tmpRect=new Q,this._maxFontSize=100,this._fontScale=1;var t=this._canvasData=h.getInstance().get();this._canvas=t.canvas,this._context=t.context}var e=t.prototype;return e.destroy=function(){h.getInstance().put(this._canvasData),this._canvasData=null,this._canvas=null,this._context=null,this._lettersInfo.length=0},e.processingString=function(t,e,n,a,i,r){if(t)e.fntConfig?this._fontScale=1:this._fontScale=this._getStyleFontScale(e.originFontSize,e.fontScale),l.fontScale=this._fontScale,this._setupBMFontOverflowMetrics(n,a),this._updateFontScale(e),this._computeHorizontalKerningForText(e,n,i),this._alignText(e,n,a,i);else{var o=0;for(this._fontScale=this._getStyleFontScale(e.fontSize,e.fontScale),this._updatePaddingRect(e,a),this._calculateLabelFont(e,n,a,i);(a.canvasSize.width>kt||a.canvasSize.height>kt)&&o<=3;){if(++o>3)this._fontScale=1;else{var s=Math.max(a.canvasSize.width,a.canvasSize.height),h=kt/s;this._fontScale*=h,this._fontScale=Math.max(1,this._fontScale)}this._updatePaddingRect(e,a),this._calculateLabelFont(e,n,a,i)}}r&&(r=a.parsedString)},e.generateRenderInfo=function(t,e,n,a,i,r,o){t?(this._computeAlignmentOffset(e,n,a),this.generateVertexData(t,e,n,a,i,r,o)):(this._updateLabelDimensions(e,n,a),this._updateTexture(e,n,a,i),this.generateVertexData(t,e,n,a,i,r,o))},e.setCanvasUsed=function(t,e){this._canvas=t,this._context=e},e._getStyleFontScale=function(t,e){var n=e,a=this._maxFontSize;return n*t>a&&t<a&&(n=a/t),n<1&&(n=1),n},e._calculateLabelFont=function(t,e,n,a){if(this._context){t.actualFontSize=t.fontSize*this._fontScale;var i=a.split("\n"),r=n.parsedString=i,o=this._getFontDesc(t.actualFontSize,t.fontFamily,t.isBold,t.isItalic);this._context.font=t.fontDesc=o;var s=n.canvasSize,h=n.nodeContentSize,l=n.canvasPadding,d=n.contentSizeExtend,v=this._fontScale;switch(e.overFlow){case u.NONE:for(var p=0,g=0;g<i.length;++g){var m=f(this._context,i[g],o);p=p>m?p:m}var _=p,y=(r.length+c)*this._getLineHeight(e.lineHeight,t.actualFontSize,t.fontSize);s.width=_+l.width*v,s.height=y+l.height*v,h.width=(_+d.width*v)/v,h.height=(y+d.height*v)/v;break;case u.SHRINK:this._calculateShrinkFont(i,t,e,n),this._calculateWrapText(i,t,e,n),s.width=h.width*v,s.height=h.height*v;break;case u.CLAMP:this._calculateWrapText(i,t,e,n),s.width=h.width*v,s.height=h.height*v;break;case u.RESIZE_HEIGHT:this._calculateWrapText(i,t,e,n);var x=(n.parsedString.length+c)*this._getLineHeight(e.lineHeight,t.actualFontSize,t.fontSize);s.width=h.width*v,s.height=x+l.height*v,h.height=(x+d.height*v)/v}}},e._getFontDesc=function(t,e,n,a){var i=t.toString()+"px ";return i+=e,n&&(i="bold "+i),a&&(i="italic "+i),i},e._getLineHeight=function(t,e,n){return 0===t?e:t*e/n},e._calculateShrinkFont=function(t,e,n,a){if(this._context){var i=this._getFontDesc(e.actualFontSize,e.fontFamily,e.isBold,e.isItalic);this._context.font=i;var r=this._calculateParagraphLength(t,this._context,i),o=0,s=0,h=0,l=e.actualFontSize,u=a.canvasSize,c=a.nodeContentSize,v=a.canvasPadding,p=this._fontScale;if(n.wrapping){var g=c.width*p,m=c.height*p;if(g<0||m<0)return;s=m+1;for(var _=0,y=0|e.actualFontSize+1,x=0;_<y;){if((x=_+y+1>>1)<=0){z(4003);break}l=x,i=this._getFontDesc(l,e.fontFamily,e.isBold,e.isItalic),this._context.font=i;var S=this._getLineHeight(n.lineHeight,l,e.fontSize);for(s=0,o=0;o<t.length;++o){var D=f(this._context,t[o],i);s+=d(t[o],D,g,this._measureText(this._context,i)).length*S}s>m?y=x-1:_=x}0===_?z(4003):(l=_,i=this._getFontDesc(l,e.fontFamily,e.isBold,e.isItalic),this._context.font=i)}else{for(s=t.length*this._getLineHeight(n.lineHeight,l,e.fontSize),o=0;o<t.length;++o)h<r[o]&&(h=r[o]);var w=(u.width-v.width)*p/h,C=u.height*p/s;l=e.actualFontSize*Math.min(1,w,C)|0,i=this._getFontDesc(l,e.fontFamily,e.isBold,e.isItalic),this._context.font=i}e.actualFontSize=l,e.fontDesc=i}},e._calculateWrapText=function(t,e,n,a){if(n.wrapping&&this._context){var i=[],r=a.nodeContentSize.width*this._fontScale,o=this._getFontDesc(e.actualFontSize,e.fontFamily,e.isBold,e.isItalic);this._context.font=o;for(var s=0;s<t.length;++s){var h=f(this._context,t[s],o),l=d(t[s],h,r,this._measureText(this._context,o));i=i.concat(l)}a.parsedString=i,e.fontDesc=o}},e._measureText=function(t,e){return function(n){return f(t,n,e)}},e._calculateParagraphLength=function(t,e,n){return t.map((function(t){return f(e,t,n)}))},e._updatePaddingRect=function(t,e){var n=0,a=0,i=0,r=0,o=0,s=e.contentSizeExtend,h=e.canvasPadding;if(s.width=s.height=0,t.isOutlined&&(n=a=i=r=o=t.outlineWidth,s.width=s.height=2*o),t.hasShadow){var l=t.shadowBlur+o,u=t.shadowOffsetX,c=t.shadowOffsetY;i=Math.max(i,-u+l),r=Math.max(r,u+l),n=Math.max(n,c+l),a=Math.max(a,-c+l)}if(t.isItalic){var f=t.fontSize*Math.tan(.20943951);r+=f,s.width+=f}h.x=i,h.y=n,h.width=i+r,h.height=n+a},e._updateLabelDimensions=function(t,e,n){var a=n.canvasSize;a.width=Math.min(a.width,kt),a.height=Math.min(a.height,kt);var i=this._canvas,r=this._context;i.width=a.width,i.height=a.height,r.font=t.fontDesc,r.textAlign=Ut[e.horizontalAlign],r.textBaseline="alphabetic"},e._calculateFillTextStartPosition=function(t,e,n){var a=0,i=n.canvasSize,r=n.canvasPadding;e.horizontalAlign===v.RIGHT?a=i.width-r.width:e.horizontalAlign===v.CENTER&&(a=(i.width-r.width)/2);var o=this._getLineHeight(e.lineHeight,t.actualFontSize,t.fontSize)*(n.parsedString.length-1),s=t.actualFontSize*(1-c/2);if(e.verticalAlign!==p.TOP){var h=o+r.height+t.actualFontSize-i.height;e.verticalAlign===p.BOTTOM?s-=h+=c/2*t.actualFontSize:s-=h/2}s+=Ht*t.actualFontSize,n.startPosition.set(a+r.x,s+r.y)},e._updateTexture=function(t,e,n,a){var i=this._context,r=this._canvas;if(i&&r){i.clearRect(0,0,r.width,r.height),i.font=t.fontDesc,this._calculateFillTextStartPosition(t,e,n);var o=this._getLineHeight(e.lineHeight,t.actualFontSize,t.fontSize);i.lineJoin="round",t.isOutlined?(i.fillStyle="rgba("+t.outlineColor.r+", "+t.outlineColor.g+", "+t.outlineColor.b+", "+Vt+")",i.fillRect(0,0,r.width,r.height)):(i.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+Vt+")",i.fillRect(0,0,r.width,r.height)),i.fillStyle="rgb("+t.color.r+", "+t.color.g+", "+t.color.b+")";var s=n.startPosition,h=new K(s.x,s.y),l=h.x,u=0;this._drawTextEffect(h,o,t,e,n);for(var c=n.parsedString,f=0;f<c.length;++f)u=h.y+f*o,t.hasShadow&&(this._setupShadow(t),i.fillText(c[f],l,u)),t.isOutlined&&(this._setupOutline(t),i.strokeText(c[f],l,u)),t.hasShadow&&!t.isOutlined||i.fillText(c[f],l,u);t.hasShadow&&(i.shadowColor="transparent"),this._uploadTexture(a)}},e._uploadTexture=function(t){var e,n=this._canvas;t.texture&&n&&(e=t.texture instanceof i?t.texture.texture:t.texture,0!==n.width&&0!==n.height&&(e.getGFXTexture(),e.getGFXSampler(),e.reset({width:n.width,height:n.height,mipmapLevel:1}),e.uploadData(n),e.setWrapMode(_t.CLAMP_TO_EDGE,_t.CLAMP_TO_EDGE),t.texture instanceof i&&(t.texture.rect=new Q(0,0,n.width,n.height),t.texture._calculateUV()),et.director.root&&et.director.root.batcher2D&&et.director.root.batcher2D._releaseDescriptorSetCache(e.getHash())))},e._drawTextEffect=function(t,e,n,a,i){if(n.hasShadow||n.isOutlined||n.isUnderline){for(var r=this._context,o=i.parsedString,s=o.length>1&&n.hasShadow,h=this._measureText(this._context,n.fontDesc),l=0,u=0,c=0;c<o.length;++c)if(l=t.x,u=t.y+c*e,s&&(n.hasShadow&&(this._setupShadow(n),r.fillText(o[c],l,u)),n.isOutlined&&(this._setupOutline(n),r.strokeText(o[c],l,u)),n.hasShadow&&!n.isOutlined||r.fillText(o[c],l,u)),n.isUnderline){var f=h(o[c]),d=new K;a.horizontalAlign===v.RIGHT?d.x=t.x-f:a.horizontalAlign===v.CENTER?d.x=t.x-f/2:d.x=t.x,d.y=u+n.actualFontSize/8,r.fillRect(d.x,d.y,f,n.underlineHeight*this._fontScale)}s&&(r.shadowColor="transparent")}},e._setupOutline=function(t){var e=this._context;e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.strokeStyle="rgba("+t.outlineColor.r+", "+t.outlineColor.g+", "+t.outlineColor.b+", "+t.outlineColor.a/255+")",e.lineWidth=2*t.outlineWidth*this._fontScale},e._setupShadow=function(t){var e=this._context,n=this._fontScale;e.shadowColor="rgba("+t.shadowColor.r+", "+t.shadowColor.g+", "+t.shadowColor.b+", "+t.shadowColor.a/255+")",e.shadowBlur=t.shadowBlur*n,e.shadowOffsetX=t.shadowOffsetX*n,e.shadowOffsetY=-t.shadowOffsetY*n},e.generateVertexData=function(t,e,n,a,i,r,o){t?this._updateQuads(e,n,a,i,r,o):(this.updateQuatCount(i),o(e,a,i))},e.updateQuatCount=function(t){var e=t.vertexBuffer,n=t.quadCount;if(e.length!==n){for(var a=e.length;a<n;a++)e.push({x:0,y:0,z:0,u:0,v:0,color:Z.WHITE.clone()});e.length=n}},e._setupBMFontOverflowMetrics=function(t,e){var n=e.nodeContentSize,a=n.width,i=n.height;t.overFlow===u.RESIZE_HEIGHT&&(i=0),t.overFlow===u.NONE&&(a=0,i=0),t.textWidthTemp=a,t.textHeightTemp=i,t.textDimensions.width=a,t.textDimensions.height=i,t.maxLineWidth=a},e._updateFontScale=function(t){t.bmfontScale=t.actualFontSize/(t.originFontSize*this._fontScale)},e._computeHorizontalKerningForText=function(t,e,n){var a=n,i=a.length;if(t.fntConfig){var r=t.fntConfig.kerningDict,o=e.horizontalKerning;if(r&&0!==r.length)for(var s=-1,h=0;h<i;++h){var l=a.charCodeAt(h),u=r[s<<16|65535&l]||0;o[h]=h<i-1?u:0,s=l}}},e._alignText=function(t,e,n,a){this._multilineTextWrap(t,e,n,a,this._getFirstWordLen),e.overFlow===u.SHRINK&&(t.fontSize>0&&this._isVerticalClamp(t,e,n,a,this)&&this._shrinkLabelToContentSize(t,e,n,a,this._isVerticalClamp),t.fontSize>0&&this._isHorizontalNeedShrink(e,n)&&this._shrinkLabelToContentSize(t,e,n,a,this._isHorizontalClamp)),this._parsedString(n,a)},e._parsedString=function(t,e){for(var n=[],a="",i=0,r=0,o=g(e);i<o;++i){var s=this._lettersInfo[i];s.valid&&(r===s.line?a+=s.char:(n=n.concat(a),r=s.line,a=""))}n=n.concat(a),t.parsedString=n},e._multilineTextWrap=function(t,e,n,a,i){e.linesWidth.length=0;for(var r=a,o=r.length,s=0,h=0,u=0,c=0,f=0,d=0,v=0,p=null,g=0;g<o;){var y=m(r,g);if("\n"!==y){for(var x=i(t,e,r,g,o),S=d,D=v,w=f,C=h,b=!1,T=new K,L=0;L<x;++L){var F=g+L;if("\r"!==(y=m(r,F)))if(p=l.fontAtlas.getLetterDefinitionForChar(y,l)){var I=C+p.offsetX*t.bmfontScale-l.margin;if(e.wrapping&&e.maxLineWidth>0&&h>0&&I+p.w*t.bmfontScale>e.maxLineWidth&&!_(y)){e.linesWidth.push(f),f=0,s++,h=0,u-=e.lineHeight*this._getFontScale(t,e)+0,b=!0;break}T.x=I,T.y=u-p.offsetY*t.bmfontScale,this._recordLetterInfo(T,y,F,s),F+1<e.horizontalKerning.length&&F<o-1&&(C+=e.horizontalKerning[F+1]*t.bmfontScale),C+=p.xAdvance*t.bmfontScale+e.spacingX,w=T.x+p.w*t.bmfontScale,S<T.y&&(S=T.y),D>T.y-p.h*t.bmfontScale&&(D=T.y-p.h*t.bmfontScale)}else this._recordPlaceholderInfo(F,y),null!=t.fntConfig?z(16354,t.fntConfig.atlasName,y):z(16355,t.fontFamily,y);else this._recordPlaceholderInfo(F,y)}b||(h=C,d<S&&(d=S),v>D&&(v=D),c<(f=w)&&(c=f),g+=x)}else e.linesWidth.push(f),f=0,s++,h=0,u-=e.lineHeight*this._getFontScale(t,e)+0,this._recordPlaceholderInfo(g,y),g++}e.linesWidth.push(f),e.numberOfLines=s+1,e.textDesiredHeight=e.numberOfLines*e.lineHeight*this._getFontScale(t,e),e.numberOfLines>1&&(e.textDesiredHeight+=0*(e.numberOfLines-1));var A=n.nodeContentSize;return A.width=e.textWidthTemp,A.height=e.textHeightTemp,e.textWidthTemp<=0&&(A.width=parseFloat(c.toFixed(2))+2*l.margin),e.textHeightTemp<=0&&(A.height=parseFloat(e.textDesiredHeight.toFixed(2))+2*l.margin),e.tailoredTopY=A.height,e.tailoredBottomY=0,d>0&&(e.tailoredTopY=A.height+d),v<-e.textDesiredHeight&&(e.tailoredBottomY=e.textDesiredHeight+v),!0},e._recordPlaceholderInfo=function(t,e){var n=this._lettersInfo;if(t>=n.length){var a=new Wt;n.push(a)}n[t].char=e,n[t].hash=""+y(e,0)+l.hash,n[t].valid=!1},e._recordLetterInfo=function(t,e,n,a){var i=this._lettersInfo;if(n>=i.length){var r=new Wt;i.push(r)}var o=""+y(e,0)+l.hash;i[n].line=a,i[n].char=e,i[n].hash=o,i[n].valid=l.fontAtlas.getLetter(o).valid,i[n].x=t.x,i[n].y=t.y},e._getFirstWordLen=function(t,e,n,a,i){var r=m(n,a);if(x(r)||"\n"===r||_(r))return 1;var o=l.fontAtlas,s=1,h=o.getLetterDefinitionForChar(r,l);if(!h)return s;for(var u=h.xAdvance*t.bmfontScale+e.spacingX,c=a+1;c<i&&(r=m(n,c),h=o.getLetterDefinitionForChar(r,l));++c){if(u+h.offsetX*t.bmfontScale+h.w*t.bmfontScale>e.maxLineWidth&&!_(r)&&e.maxLineWidth>0)return s;if(u+=h.xAdvance*t.bmfontScale+e.spacingX,"\n"===r||_(r)||x(r))break;s++}return s},e._computeAlignmentOffset=function(t,e,n){var a=n.nodeContentSize;switch(e.linesOffsetX.length=0,e.letterOffsetY=0,e.horizontalAlign){case v.LEFT:for(var i=0;i<e.numberOfLines;++i)e.linesOffsetX.push(0);break;case v.CENTER:for(var r=0,o=e.linesWidth.length;r<o;r++)e.linesOffsetX.push((a.width-e.linesWidth[r])/2);break;case v.RIGHT:for(var s=0,h=e.linesWidth.length;s<h;s++)e.linesOffsetX.push(a.width-e.linesWidth[s])}if(e.letterOffsetY=a.height,e.verticalAlign!==p.TOP){var l=a.height-e.textDesiredHeight+e.lineHeight*this._getFontScale(t,e)-t.originFontSize*this._fontScale*t.bmfontScale;e.verticalAlign===p.BOTTOM?e.letterOffsetY-=l:e.letterOffsetY-=l/2}},e._getFontScale=function(t,e){return e.overFlow===u.SHRINK?t.bmfontScale:1},e._isVerticalClamp=function(t,e,n){return e.textDesiredHeight>n.nodeContentSize.height},e._isHorizontalClamp=function(t,e,n,a,i){for(var r=!1,o=0,s=g(a);o<s;++o){var h=i._lettersInfo[o];if(h.valid){var u=l.fontAtlas.getLetterDefinitionForChar(h.char,l);if(!u)continue;var c=h.x+u.w*t.bmfontScale,f=h.line;if(e.textWidthTemp>0){var d=n.nodeContentSize;if(e.wrapping){if(e.linesWidth[f]>d.width&&(c>d.width||c<0)){r=!0;break}}else if(c>d.width){r=!0;break}}}}return r},e._isHorizontalNeedShrink=function(t,e){for(var n=0,a=t.linesWidth.length;n<a;++n)if(t.linesWidth[n]>e.nodeContentSize.width)return!0;return!1},e._shrinkLabelToContentSize=function(t,e,n,a,i){for(var r=0,o=0|t.actualFontSize,s=0;r<o;){var h=s=r+o+1>>1;if(h<=0)break;t.bmfontScale=h/(t.originFontSize*this._fontScale),this._multilineTextWrap(t,e,n,a,this._getFirstWordLen),this._computeAlignmentOffset(t,e,n),i(t,e,n,a,this)?o=s-1:r=s}r>=0&&this._scaleFontSizeDown(t,e,n,a,r)},e._scaleFontSizeDown=function(t,e,n,a,i){var r=!0;i||(i=.1,r=!1),t.actualFontSize=i,r&&(this._updateFontScale(t),this._multilineTextWrap(t,e,n,a,this._getFirstWordLen))},e._updateQuads=function(t,e,n,a,i,r){for(var o=l.fontAtlas,s=t.spriteFrame?t.spriteFrame.texture:o.getTexture(),h=n.nodeContentSize,c=a.uiTransAnchorX*h.width,f=a.uiTransAnchorY*h.height,d=0,v=g(i);d<v;++d){var p=this._lettersInfo[d];if(p.valid){var m=o.getLetter(p.hash);if(m){var _=this._tmpRect;_.height=m.h,_.width=m.w,_.x=m.u,_.y=m.v;var y=p.y+e.letterOffsetY;if(e.textHeightTemp>0){if(y>e.tailoredTopY){var x=y-e.tailoredTopY;_.y+=x,_.height-=x,y-=x}y-_.height*t.bmfontScale<e.tailoredBottomY&&e.overFlow===u.CLAMP&&(_.height=y<e.tailoredBottomY?0:(y-e.tailoredBottomY)/t.bmfontScale)}var S=p.line,D=p.x+m.w/2*t.bmfontScale+e.linesOffsetX[S];if(e.textWidthTemp>0&&this._isHorizontalClamped(e,n,D,S)&&e.overFlow===u.CLAMP&&(_.width=0),_.height>0&&_.width>0){var w=this._determineRect(t),C=p.x+e.linesOffsetX[p.line],b=a.quadCount;a.quadCount+=4,this.updateQuatCount(a),r(t,n,a,b,s,_,w,C-c,y-f)}}else F(16353)}}return!0},e._isHorizontalClamped=function(t,e,n,a){var i=e.nodeContentSize,r=t.linesWidth[a],o=n>i.width||n<0;return t.wrapping?r>i.width&&o:o},e._determineRect=function(t){var e=t.spriteFrame;if(!e)return!1;var n=e.isRotated(),a=e.getOriginalSize(),i=e.getRect(),r=e.getOffset(),o=r.x+(a.width-i.width)/2,s=r.y-(a.height-i.height)/2,h=this._tmpRect;if(n){var l=h.x;h.x=i.x+i.height-h.y-h.height-s,h.y=l+i.y-o,h.y<0&&(h.height+=s)}else h.x+=i.x-o,h.y+=i.y+s;return n},t}();Nt.instance=void 0,Nt.instance=new Nt;var jt=new D(64,64),Xt=new C(null),Yt=null,qt=null,Gt=null,Qt=null,Kt=null,Zt=function(){function t(){}var e=t.prototype;return e.updateProcessingData=function(t,e,n,a,i,r){t.fontSize=i.fontSize,t.actualFontSize=i.fontSize,t.originFontSize=Gt?Gt.fontSize:i.fontSize,e.horizontalAlign=i.horizontalAlign,e.verticalAlign=i.verticalAlign,e.spacingX=i.spacingX;var o=i.overflow;e.overFlow=o,e.lineHeight=i.lineHeight;var s=n.nodeContentSize;s.width=r.width,s.height=r.height,o===u.NONE?(e.wrapping=!1,s.width+=2*l.margin,s.height+=2*l.margin):o===u.RESIZE_HEIGHT?(e.wrapping=!0,s.height+=2*l.margin):e.wrapping=i.enableWrapText,a.uiTransAnchorX=r.anchorX,a.uiTransAnchorY=r.anchorY,l.lineHeight=i.lineHeight,l.fontSize=i.fontSize,t.spriteFrame=Qt,t.fntConfig=Gt,t.fontFamily=l.fontFamily,t.color.set(i.color)},e.updateRenderData=function(t){if(t.renderData&&Yt!==t){if(t.renderData.vertDirty){qt=(Yt=t).node._getUITransformComp();var e=t.renderData,n=Nt.instance,a=t.textStyle,i=t.textLayout,r=t.textLayoutData,o=t.textRenderData;a.fontScale=dt.getScaleX(),this._updateFontFamily(t),this.updateProcessingData(a,i,r,o,t,qt),this._updateLabelInfo(t),a.fontDesc=l.fontDesc,n.processingString(!0,a,i,r,t.string),o.quadCount=0,n.generateRenderInfo(!0,a,i,r,o,t.string,this.generateVertexData),e.dataLength!==o.quadCount&&(this.resetRenderData(t),e.dataLength=o.quadCount,e.resize(e.dataLength,e.dataLength/2*3));for(var s=e.data,h=0,u=o.quadCount;h<u;h++)s[h]=o.vertexBuffer[h];var c=e.indexCount;this.createQuadIndices(c),e.chunk.setIndexBuffer(Kt),Yt.actualFontSize=a.actualFontSize,qt.setContentSize(r.nodeContentSize),this.updateUVs(t),e.vertDirty=!1,Yt=null,this._resetProperties()}t.spriteFrame&&t.renderData.updateRenderData(t,t.spriteFrame)}},e.updateUVs=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=e.vertexCount,i=e.floatStride,r=e.data,o=3,s=0;s<a;s++){var h=r[s];n[o]=h.u,n[o+1]=h.v,o+=i}},e.updateColor=function(t){t.renderData},e.resetRenderData=function(t){var e=t.renderData;e&&(e.dataLength=0,e.resize(0,0))},e.generateVertexData=function(t,e,n,a,i,r,o,s,h){var l=a,u=t.bmfontScale,c=n.vertexBuffer,f=i.width,d=i.height,v=r.width,p=r.height,g=0,m=0,_=0,y=0;o?(g=r.x/f,y=(r.x+p)/f,m=(r.y+v)/d,_=r.y/d,c[l].u=g,c[l].v=_,c[l+1].u=g,c[l+1].v=m,c[l+2].u=y,c[l+2].v=_,c[l+3].u=y,c[l+3].v=m):(g=r.x/f,y=(r.x+v)/f,m=(r.y+p)/d,_=r.y/d,c[l].u=g,c[l].v=m,c[l+1].u=y,c[l+1].v=m,c[l+2].u=g,c[l+2].v=_,c[l+3].u=y,c[l+3].v=_),c[l].x=s,c[l].y=h-p*u,c[l+1].x=s+v*u,c[l+1].y=h-p*u,c[l+2].x=s,c[l+2].y=h,c[l+3].x=s+v*u,c[l+3].y=h},e._updateFontFamily=function(t){var e=t.font;Qt=e.spriteFrame,Gt=e.fntConfig,l.fontAtlas=e.fontDefDictionary,l.fontAtlas||(t.cacheMode===w.CHAR?l.fontAtlas=jt:l.fontAtlas=Xt),r.packToDynamicAtlas(t,Qt)},e._updateLabelInfo=function(){l.hash="",l.margin=0},e._resetProperties=function(){Gt=null,Qt=null,l.hash="",l.margin=0},e.createQuadIndices=function(t){if(t%6==0){var e=t/6;Kt=new Uint16Array(t);for(var n=0,a=0;a<e;a++)Kt[n++]=0+4*a,Kt[n++]=1+4*a,Kt[n++]=2+4*a,Kt[n++]=1+4*a,Kt[n++]=3+4*a,Kt[n++]=2+4*a}else M(16308)},t}(),Jt=new Z(255,255,255,255),$t=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var a=e.prototype;return a.createData=function(t){var e=t.requestRenderData();return e.resize(0,0),e},a.fillBuffers=function(t,e){var a=t.node;Jt.set(t.color),Jt.a=255*a._uiProps.opacity,n(a,e,t.renderData,Jt)},e}(Zt),te=new $t,ee=null,ne=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var n=e.prototype;return n.getAssemblerData=function(){return ee||(ee=new D(1024,1024)),ee.getTexture()},n._updateFontFamily=function(t){l.fontAtlas=ee,l.fontFamily=this._getFontFamily(t),t.enableOutline&&t.outlineWidth>0?(l.isOutlined=!0,l.margin=t.outlineWidth,l.out=t.outlineColor.clone(),l.out.a=t.outlineColor.a*t.color.a/255):(l.isOutlined=!1,l.margin=0)},n._getFontFamily=function(t){var e="Arial";return t.useSystemFont?e=t.fontFamily||"Arial":t.font&&(e=t.font._nativeAsset||"Arial"),e},n._updateLabelInfo=function(t){l.fontDesc=this._getFontDesc(),l.color.set(t.color),l.hash=b(l)},n._getFontDesc=function(){return l.fontSize.toString()+"px "+l.fontFamily},e}(Zt),ae=new Z(255,255,255,255),ie=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var a=e.prototype;return a.createData=function(t){var e=t.requestRenderData();return e.resize(0,0),e},a.fillBuffers=function(t,e){if(t.renderData){var a=t.node;ae.a=255*a._uiProps.opacity,n(a,e,t.renderData,ae)}},a.updateColor=function(t){t.renderData},e}(ne),re=new ie,oe=s.Overflow,se=function(){function t(){}var e=t.prototype;return e.updateProcessingData=function(t,e,n,a,i,r){t.isSystemFontUsed=i.useSystemFont,t.fontSize=i.fontSize,n.nodeContentSize.width=n.canvasSize.width=r.width,n.nodeContentSize.height=n.canvasSize.height=r.height,e.lineHeight=i.lineHeight,e.overFlow=i.overflow,i.overflow===oe.NONE?e.wrapping=!1:i.overflow===oe.RESIZE_HEIGHT?e.wrapping=!0:e.wrapping=i.enableWrapText,t.isBold=i.isBold,t.isItalic=i.isItalic,t.isUnderline=i.isUnderline,t.underlineHeight=i.underlineHeight,i.enableOutline&&i.outlineWidth>0?(t.isOutlined=!0,t.outlineColor.set(i.outlineColor),t.outlineWidth=i.outlineWidth):t.isOutlined=!1,i.enableShadow&&(i.shadowBlur>0||!J(i.shadowOffset.x,0)||!J(i.shadowOffset.y,0))?(t.hasShadow=!0,t.shadowColor.set(i.shadowColor),t.shadowBlur=i.shadowBlur,t.shadowOffsetX=i.shadowOffset.x,t.shadowOffsetY=i.shadowOffset.y):t.hasShadow=!1,t.color.set(i.color),a.texture=i.spriteFrame,a.uiTransAnchorX=r.anchorX,a.uiTransAnchorY=r.anchorY,e.horizontalAlign=i.horizontalAlign,e.verticalAlign=i.verticalAlign},e.getAssemblerData=function(){var t=s._canvasPool.get();return t.canvas.width=t.canvas.height=1,t},e.resetAssemblerData=function(t){t&&s._canvasPool.put(t)},e.updateRenderData=function(t){var e=t.renderData;if(e){if(e.vertDirty){var n=t.node._getUITransformComp(),a=Nt.instance,i=t.textStyle,r=t.textLayout,o=t.textLayoutData,s=t.textRenderData;i.fontScale=dt.getScaleX(),this.updateProcessingData(i,r,o,s,t,n),a.setCanvasUsed(t.assemblerData.canvas,t.assemblerData.context),i.fontFamily=this._updateFontFamily(t),this._resetDynamicAtlas(t),a.processingString(!1,i,r,o,t.string),a.generateRenderInfo(!1,i,r,o,s,t.string,this.generateVertexData),e.textureDirty=!0,this._calDynamicAtlas(t,o),t.actualFontSize=i.actualFontSize,n.setContentSize(o.nodeContentSize);var h=e.data,l=s.vertexBuffer;h[0]=l[0],h[1]=l[1],h[2]=l[2],h[3]=l[3],this.updateUVs(t),e.vertDirty=!1,t.contentWidth=o.nodeContentSize.width}t.spriteFrame&&t.renderData.updateRenderData(t,t.spriteFrame)}},e.generateVertexData=function(t,e,n){var a=n.vertexBuffer,i=e.nodeContentSize,r=i.width,o=i.height,s=n.uiTransAnchorX*r,h=n.uiTransAnchorY*o;a[0].x=-s,a[0].y=-h,a[1].x=r-s,a[1].y=-h,a[2].x=-s,a[2].y=o-h,a[3].x=r-s,a[3].y=o-h},e.updateVertexData=function(){},e.updateUVs=function(){},e._updateFontFamily=function(t){return t.useSystemFont?t.fontFamily||"Arial":t.font&&t.font._nativeAsset||"Arial"},e._calDynamicAtlas=function(t,e){if(!(t.cacheMode!==w.BITMAP||e.canvasSize.width<=0||e.canvasSize.height<=0)){var n=t.ttfSpriteFrame;r.packToDynamicAtlas(t,n)}},e._resetDynamicAtlas=function(t){if(t.cacheMode===w.BITMAP){var e=t.ttfSpriteFrame;r.deleteAtlasSpriteFrame(e),e._resetDynamicAtlasFrame()}},t}(),he=Z.WHITE.clone(),le=Uint16Array.from([0,1,2,1,3,2]),ue=function(t){function e(){return t.apply(this,arguments)||this}L(e,t);var n=e.prototype;return n.createData=function(t){var e=t.requestRenderData();e.dataLength=4,e.resize(4,6),t.textRenderData.quadCount=4;for(var n=e.chunk.vb,a=e.floatStride,i=[{u:0,v:1},{u:1,v:1},{u:0,v:0},{u:1,v:0}],r=3,o=0,s=e.dataLength;o<s;++o)n[r]=i[o].u,n[r+1]=i[o].v,r+=a;for(var h=5,l=0;l<e.dataLength;l++)Z.toArray(n,he,h),h+=a;return e.chunk.setIndexBuffer(le),e},n.fillBuffers=function(t){var e=t.renderData;if(e){for(var n=e.chunk,a=e.data,i=t.node,r=n.vb,o=i.worldMatrix,s=e.floatStride,h=0,l=a.length,u=0;u<l;u++){var c=a[u],f=c.x,d=c.y,v=o.m03*f+o.m07*d+o.m15;v=v?1/v:1,r[0+(h=u*s)]=(o.m00*f+o.m04*d+o.m12)*v,r[h+1]=(o.m01*f+o.m05*d+o.m13)*v,r[h+2]=(o.m02*f+o.m06*d+o.m14)*v}var p=n.vertexOffset,g=n.meshBuffer,m=n.meshBuffer.iData,_=g.indexOffset;m[_++]=p,m[_++]=p+1,m[_++]=p+2,m[_++]=p+2,m[_++]=p+1,m[_++]=p+3,g.indexOffset+=6}},n.updateVertexData=function(t){var e=t.renderData;if(e){var n=t.node._getUITransformComp(),a=n.width,i=n.height,r=n.anchorX*a,o=n.anchorY*i,s=e.data;s[0].x=-r,s[0].y=-o,s[1].x=a-r,s[1].y=-o,s[2].x=-r,s[2].y=i-o,s[3].x=a-r,s[3].y=i-o}},n.updateUVs=function(t){var e=t.renderData;if(e&&t.ttfSpriteFrame)for(var n=e.chunk.vb,a=t.ttfSpriteFrame.uv,i=e.floatStride,r=3,o=0;o<e.dataLength;++o){var s=2*o;n[r]=a[s],n[r+1]=a[s+1],r+=i}},n.updateColor=function(){},e}(se),ce=new ue,fe=t("labelAssembler",{getAssembler:function(t){var e=ce;return t.font instanceof T?e=te:t.cacheMode===w.CHAR&&(e=re),e}});s.Assembler=fe;var de=o.FillType,ve=new $,pe=Uint16Array.from([0,1,2,1,3,2]),ge=function(){function t(){}var e=t.prototype;return e.updateRenderData=function(t){var e=t.spriteFrame;r.packToDynamicAtlas(t,e);var n=t.renderData;if(n&&e){if(!n.vertDirty)return;var a=t.fillStart,i=t.fillRange;i<0&&(a+=i,i=-i),i=(i=(i=a+i)>1?1:i)<0?0:i;var o=(a=(a=a>1?1:a)<0?0:a)+(i=(i-=a)<0?0:i);o=o>1?1:o,this.updateUVs(t,a,o),this.updateVertexData(t,a,o),n.updateRenderData(t,e)}},e.updateUVs=function(t,e,n){var a=t.spriteFrame,i=t.renderData;if(i){var r=i.chunk.vb,o=a.width,s=a.height,h=a.rect,l=0,u=0,c=0,f=0,d=0,v=0,p=0,g=0,m=0,_=0;a.isRotated()?(l=h.x/o,u=(h.y+h.width)/s,c=d=l,p=m=(h.x+h.height)/o,v=_=u,f=g=h.y/s):(l=h.x/o,u=(h.y+h.height)/s,c=p=l,d=m=(h.x+h.width)/o,f=v=u,g=_=h.y/s);var y=i.floatStride,x=3;switch(t.fillType){case de.HORIZONTAL:r[x]=c+(d-c)*e,r[x+1]=f+(v-f)*e,r[x+=y]=c+(d-c)*n,r[x+1]=f+(v-f)*n,r[x+=y]=p+(m-p)*e,r[x+1]=g+(_-g)*e,r[x+=y]=p+(m-p)*n,r[x+1]=g+(_-g)*n;break;case de.VERTICAL:r[x]=c+(p-c)*e,r[x+1]=f+(g-f)*e,r[x+=y]=d+(m-d)*e,r[x+1]=v+(_-v)*e,r[x+=y]=c+(p-c)*n,r[x+1]=f+(g-f)*n,r[x+=y]=d+(m-d)*n,r[x+1]=v+(_-v)*n;break;default:M(2626)}}},e.updateVertexData=function(t,e,n){var a=t.renderData;if(a){var i=a.data,r=t.node._getUITransformComp(),o=r.width,s=r.height,h=r.anchorX*o,l=r.anchorY*s,u=-h,c=-l,f=o-h,d=s-l,v=0;switch(t.fillType){case de.HORIZONTAL:v=u+(f-u)*n,u+=(f-u)*e,f=v;break;case de.VERTICAL:v=c+(d-c)*n,c+=(d-c)*e,d=v;break;default:M(2626)}i[0].x=u,i[0].y=c,i[1].x=f,i[1].y=c,i[2].x=u,i[2].y=d,i[3].x=f,i[3].y=d}},e.createData=function(t){var e=t.requestRenderData();return e.dataLength=4,e.resize(4,6),e.chunk.setIndexBuffer(pe),e.data.forEach((function(t){t.z=0})),e},e.updateWorldVertexData=function(t,e){t.node.getWorldMatrix(ve);var n=t.renderData;if(n)for(var a=n.floatStride,i=t.renderData.data,r=e.vb,o=0,s=0;s<4;s++){var h=i[s],l=h.x,u=h.y,c=ve.m03*l+ve.m07*u+ve.m15;c=c?1/c:1,r[o=s*a]=(ve.m00*l+ve.m04*u+ve.m12)*c,r[o+1]=(ve.m01*l+ve.m05*u+ve.m13)*c,r[o+2]=(ve.m02*l+ve.m06*u+ve.m14)*c}},e.fillBuffers=function(t){var e=t.renderData;if(e){var n=e.chunk;(t._flagChangedVersion!==t.node.flagChangedVersion||e.vertDirty)&&(this.updateWorldVertexData(t,n),e.vertDirty=!1,t._flagChangedVersion=t.node.flagChangedVersion),n.bufferId;var a=n.vertexOffset,i=n.meshBuffer,r=n.meshBuffer.iData,o=i.indexOffset;r[o++]=a,r[o++]=a+1,r[o++]=a+2,r[o++]=a+2,r[o++]=a+1,r[o++]=a+3,i.indexOffset+=6}},e.updateColor=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=e.floatStride,i=5,r=t.color,o=r.r/255,s=r.g/255,h=r.b/255,l=t.node._uiProps.opacity,u=0;u<4;u++)n[i]=o,n[i+1]=s,n[i+2]=h,n[i+3]=l,i+=a},t}(),me=new ge,_e=2*Math.PI,ye=1e-6,xe=new $,Se=[new K,new K,new K,new K],De=new Array(4),we=new Array(8),Ce=[new K,new K,new K,new K],be=[new K,new K,new K,new K],Te=new K,Le=[new K,new K,new K,new K];function Fe(t,e,n,a,i,r,o){var s=Math.sin(r);s=Math.abs(s)>ye?s:0;var h=Math.cos(r),l=0,u=0;if(0!==(h=Math.abs(h)>ye?h:0)){if(l=s/h,(t-i.x)*h>0){var c=i.y+l*(t-i.x);o[0].x=t,o[0].y=c}if((e-i.x)*h>0){var f=i.y+l*(e-i.x);o[2].x=e,o[2].y=f}}if(0!==s){if(u=h/s,(a-i.y)*s>0){var d=i.x+u*(a-i.y);o[3].x=d,o[3].y=a}if((n-i.y)*s>0){var v=i.x+u*(n-i.y);o[1].x=v,o[1].y=n}}}function Ie(t){var e=t.node._getUITransformComp(),n=e.width,a=e.height,i=e.anchorX*n,r=e.anchorY*a,o=-i,s=-r,h=n-i,l=a-r,u=De;u[0]=o,u[1]=s,u[2]=h,u[3]=l;var c=t.fillCenter,f=Te.x=Math.min(Math.max(0,c.x),1)*(h-o)+o,d=Te.y=Math.min(Math.max(0,c.y),1)*(l-s)+s;Se[0].x=Se[3].x=o,Se[1].x=Se[2].x=h,Se[0].y=Se[1].y=s,Se[2].y=Se[3].y=l,Le.forEach((function(t){K.set(t,0,0)})),f!==u[0]&&K.set(Le[0],3,0),f!==u[2]&&K.set(Le[2],1,2),d!==u[1]&&K.set(Le[1],0,1),d!==u[3]&&K.set(Le[3],2,3)}function Ae(t,e){var n=e.x-t.x,a=e.y-t.y;if(0===n&&0===a)return 0;if(0===n)return a>0?.5*Math.PI:1.5*Math.PI;var i=Math.atan(a/n);return n<0&&(i+=Math.PI),i}function Oe(t,e,n,a,i){var r=De,o=r[0],s=r[1],h=r[2],l=r[3];t[e].x=n.x,t[e].y=n.y,t[e+1].x=a.x,t[e+1].y=a.y,t[e+2].x=i.x,t[e+2].y=i.y,Re((n.x-o)/(h-o),(n.y-s)/(l-s),t,e),Re((a.x-o)/(h-o),(a.y-s)/(l-s),t,e+1),Re((i.x-o)/(h-o),(i.y-s)/(l-s),t,e+2)}function Re(t,e,n,a){var i=we,r=i[0]+(i[2]-i[0])*t,o=i[4]+(i[6]-i[4])*t,s=i[1]+(i[3]-i[1])*t,h=i[5]+(i[7]-i[5])*t,l=n[a];l.u=r+(o-r)*e,l.v=s+(h-s)*e}for(var Ee=function(){function t(){}var e=t.prototype;return e.createData=function(t){return t.requestRenderData()},e.updateRenderData=function(t){var e=t.spriteFrame;r.packToDynamicAtlas(t,e),this.updateUVs(t);var n,a,i,o,s,h,l,u,c,f=t.renderData;if(f&&e){if(!f.vertDirty)return;var d=f.data,v=t.fillStart,p=t.fillRange;for(p<0&&(v+=p,p=-p);v>=1;)v-=1;for(;v<0;)v+=1;var g=(v*=_e)+(p*=_e);Ie(t),a=(n=e).width,i=n.height,o=n.getRect(),s=0,h=0,l=0,u=0,c=we,n.isRotated()?(s=o.x/a,h=(o.x+o.height)/a,l=o.y/i,u=(o.y+o.width)/i,c[0]=c[2]=s,c[4]=c[6]=h,c[3]=c[7]=u,c[1]=c[5]=l):(s=o.x/a,h=(o.x+o.width)/a,l=o.y/i,u=(o.y+o.height)/i,c[0]=c[4]=s,c[2]=c[6]=h,c[1]=c[3]=u,c[5]=c[7]=l),Fe(De[0],De[2],De[1],De[3],Te,v,Ce),Fe(De[0],De[2],De[1],De[3],Te,v+p,be);for(var m=0,_=0;_<4;++_){var y=Le[_];if(y)if(p>=_e)f.dataLength=m+3,Oe(d,m,Te,Se[y.x],Se[y.y]),m+=3;else{var x=Ae(Te,Se[y.x]),S=Ae(Te,Se[y.y]);S<x&&(S+=_e),x-=_e,S-=_e;for(var D=0;D<3;++D)x>=g||(x>=v?(f.dataLength=m+3,Oe(d,m,Te,Se[y.x],S>=g?be[_]:Se[y.y]),m+=3):S>v&&(S<=g?(f.dataLength=m+3,Oe(d,m,Te,Ce[_],Se[y.y]),m+=3):(f.dataLength=m+3,Oe(d,m,Te,Ce[_],be[_]),m+=3))),x+=_e,S+=_e}}0===m&&(f.dataLength=0),f.resize(m,m),f.updateRenderData(t,e)}},e.createQuadIndices=function(){},e.fillBuffers=function(t){var e=t.node,n=t.renderData;if(n){var a=n.chunk;(t._flagChangedVersion!==e.flagChangedVersion||n.vertDirty)&&(this.updateWorldVertexAndUVData(t,a),n.vertDirty=!1,t._flagChangedVersion=e.flagChangedVersion),this.updateColorLate(t),a.bufferId;for(var i=a.vertexOffset,r=a.meshBuffer,o=a.meshBuffer.iData,s=r.indexOffset,h=0;h<n.indexCount;h++)o[s+h]=i+h;r.indexOffset+=n.indexCount,r.setDirty()}},e.updateWorldUVData=function(){},e.updateWorldVertexAndUVData=function(t,e){t.node.getWorldMatrix(xe);var n=t.renderData;if(n)for(var a=n.floatStride,i=t.renderData.data,r=e.vb,o=n.vertexCount,s=0,h=0;h<o;h++){var l=i[h],u=l.x,c=l.y,f=xe.m03*u+xe.m07*c+xe.m15;f=f?1/f:1,r[s+0]=(xe.m00*u+xe.m04*c+xe.m12)*f,r[s+1]=(xe.m01*u+xe.m05*c+xe.m13)*f,r[s+2]=(xe.m02*u+xe.m06*c+xe.m14)*f,r[s+3]=l.u,r[s+4]=l.v,s+=a}},e.updateUVs=function(t){var e=t.renderData;e&&(e.vertDirty=!0,t._markForUpdateRenderData())},e.updateColorLate=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=e.floatStride,i=e.vertexCount,r=5,o=t.color,s=o.r/255,h=o.g/255,l=o.b/255,u=t.node._uiProps.opacity,c=0;c<i;c++)n[r]=s,n[r+1]=h,n[r+2]=l,n[r+3]=u,r+=a},e.updateColor=function(){},t}(),ze=new Ee,Me=Uint16Array.from([0,1,2,1,3,2]),Pe=function(){function t(){}var e=t.prototype;return e.createData=function(t){var e=t.requestRenderData();return e.dataLength=4,e.resize(4,6),e.chunk.setIndexBuffer(Me),e},e.updateRenderData=function(t){var e=t.spriteFrame;r.packToDynamicAtlas(t,e),this.updateUVs(t);var n=t.renderData;n&&e&&(n.vertDirty&&this.updateVertexData(t),n.updateRenderData(t,e))},e.updateWorldVerts=function(t,e){var n=t.renderData;if(n)for(var a=e.vb,i=n.data,r=t.node.worldMatrix,o=r.m00,s=r.m01,h=r.m02,l=r.m03,u=r.m04,c=r.m05,f=r.m06,d=r.m07,v=r.m12,p=r.m13,g=r.m14,m=r.m15,_=n.floatStride,y=0,x=i.length,S=0;S<x;++S){var D=i[S],w=D.x,C=D.y,b=l*w+d*C+m;b=b?1/b:1,a[0+(y=S*_)]=(o*w+u*C+v)*b,a[y+1]=(s*w+c*C+p)*b,a[y+2]=(h*w+f*C+g)*b}},e.fillBuffers=function(t){if(null!==t){var e=t.renderData;if(e){var n=e.chunk;(t._flagChangedVersion!==t.node.flagChangedVersion||e.vertDirty)&&(this.updateWorldVerts(t,n),e.vertDirty=!1,t._flagChangedVersion=t.node.flagChangedVersion);var a=n.vertexOffset,i=n.meshBuffer,r=n.meshBuffer.iData,o=i.indexOffset,s=a;r[o++]=s,r[o++]=s+1,r[o++]=s+2,r[o++]=s+1,r[o++]=s+3,r[o++]=s+2,i.indexOffset+=6}}},e.updateVertexData=function(t){var e=t.renderData;if(e){var n=t.node._getUITransformComp(),a=e.data,i=n.width,r=n.height,o=n.anchorX*i,s=n.anchorY*r,h=0,l=0,u=0,c=0;if(t.trim)h=-o,l=-s,u=i-o,c=r-s;else{var f=t.spriteFrame,d=f.originalSize,v=i/d.width,p=r/d.height,g=f.trimmedBorder;h=g.x*v-o,l=g.z*p-s,u=i+g.y*v-o,c=r+g.w*p-s}a[0].x=h,a[0].y=l,a[1].x=u,a[1].y=l,a[2].x=h,a[2].y=c,a[3].x=u,a[3].y=c,e.vertDirty=!0}},e.updateUVs=function(t){var e=t.renderData;if(t.spriteFrame&&e)for(var n=e.chunk.vb,a=t.spriteFrame.uv,i=e.floatStride,r=3,o=0;o<e.dataLength;++o){var s=2*o;n[r]=a[s],n[r+1]=a[s+1],r+=i}},e.updateColor=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=5,i=t.color,r=i.r/255,o=i.g/255,s=i.b/255,h=i.a/255,l=0;l<4;l++,a+=e.floatStride)n[a]=r,n[a+1]=o,n[a+2]=s,n[a+3]=h},t}(),Be=new Pe,Ue=[],ke=0;ke<4;ke++)Ue.push({x:0,y:0,z:0,u:0,v:0,color:new Z});var He,Ve,We,Ne,je,Xe,Ye,qe=function(){function t(){this.QUAD_INDICES=void 0}var e=t.prototype;return e.createData=function(t){var e=t.requestRenderData();e.dataLength=16,e.resize(16,54);var n=this.QUAD_INDICES=new Uint16Array(54);return this.createQuadIndices(4,4),e.chunk.setIndexBuffer(n),e},e.createQuadIndices=function(t,e){for(var n=0,a=this.QUAD_INDICES,i=0;i<t-1;i++)for(var r=0;r<e-1;r++){var o=i*e+r;a[n++]=o,a[n++]=o+1,a[n++]=o+e,a[n++]=o+1,a[n++]=o+1+e,a[n++]=o+e}},e.updateRenderData=function(t){var e=t.spriteFrame;r.packToDynamicAtlas(t,e),this.updateUVs(t);var n=t.renderData;n&&e&&(n.vertDirty&&this.updateVertexData(t),n.updateRenderData(t,e))},e.updateVertexData=function(t){var e=t.renderData;if(e){var n=e.data,a=t.node._getUITransformComp(),i=a.width,r=a.height,o=a.anchorX*i,s=a.anchorY*r,h=t.spriteFrame,l=h.insetLeft,u=h.insetRight,c=h.insetTop,f=h.insetBottom,d=i-l-u,v=r-c-f,p=i/(l+u),g=r/(c+f);p=Number.isNaN(p)||p>1?1:p,g=Number.isNaN(g)||g>1?1:g,d=d<0?0:d,v=v<0?0:v,Ue[0].x=-o,Ue[0].y=-s,Ue[1].x=l*p-o,Ue[1].y=f*g-s,Ue[2].x=Ue[1].x+d,Ue[2].y=Ue[1].y+v,Ue[3].x=i-o,Ue[3].y=r-s;for(var m=0;m<4;m++)for(var _=0;_<4;_++){var y=4*m+_;y<e.dataLength&&m<Ue.length&&_<Ue.length&&(n[y].x=Ue[_].x,n[y].y=Ue[m].y)}}},e.fillBuffers=function(t){var e=t.renderData;if(e){var n=e.chunk;(t._flagChangedVersion!==t.node.flagChangedVersion||e.vertDirty)&&(this.updateWorldVertexData(t,n),e.vertDirty=!1,t._flagChangedVersion=t.node.flagChangedVersion),n.bufferId;for(var a=n.vertexOffset,i=n.meshBuffer,r=n.meshBuffer.iData,o=i.indexOffset,s=0;s<3;++s)for(var h=0;h<3;++h){var l=a+4*s+h;r[o++]=l,r[o++]=l+1,r[o++]=l+4,r[o++]=l+1,r[o++]=l+5,r[o++]=l+4}i.indexOffset=o}},e.updateWorldVertexData=function(t,e){var n=t.renderData;if(n)for(var a=n.floatStride,i=n.data,r=e.vb,o=t.node.worldMatrix,s=o.m00,h=o.m01,l=o.m02,u=o.m03,c=o.m04,f=o.m05,d=o.m06,v=o.m07,p=o.m12,g=o.m13,m=o.m14,_=o.m15,y=0,x=0;x<4;++x)for(var S=i[4*x],D=0;D<4;++D){var w=i[D].x,C=S.y,b=u*w+v*C+_;b=b?1/b:1,r[0+(y=(4*x+D)*a)]=(s*w+c*C+p)*b,r[y+1]=(h*w+f*C+g)*b,r[y+2]=(l*w+d*C+m)*b}},e.updateUVs=function(t){var e=t.renderData;if(t.spriteFrame&&e)for(var n=e.chunk.vb,a=e.floatStride,i=t.spriteFrame.uvSliced,r=3,o=0;o<16;o++)n[r]=i[o].u,n[r+1]=i[o].v,r+=a},e.updateColor=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=e.floatStride,i=5,r=t.color,o=r.r/255,s=r.g/255,h=r.b/255,l=t.node._uiProps.opacity,u=0;u<16;u++)n[i]=o,n[i+1]=s,n[i+2]=h,n[i+3]=l,i+=a},t}(),Ge=new qe,Qe=new $,Ke=0,Ze=[];function Je(t){return t&&(t.insetTop>0||t.insetBottom>0||t.insetLeft>0||t.insetRight>0)?2:0}var $e=function(){function t(){}var e=t.prototype;return e.createData=function(t){return t.requestRenderData()},e.updateRenderData=function(t){var e=t.renderData;if(e){var n=t.spriteFrame;if(n&&e&&(r.packToDynamicAtlas(t,n),e.vertDirty)){var a=t.node._getUITransformComp(),i=Math.abs(a.width),o=Math.abs(a.height),s=n.getRect(),h=n.insetLeft,l=n.insetRight,u=s.width-h-l,c=n.insetTop,f=n.insetBottom,d=s.height-c-f,v=i-h-l,p=o-c-f;v=v>0?v:0,p=p>0?p:0;var g=0===u?v:v/u,m=0===d?p:p/d,_=Je(n),y=Math.ceil(m+_),x=Math.ceil(g+_);e.dataLength=4*y*x,this.updateVerts(t,v,p,y,x),e.resize(y*x*4,y*x*6),e.updateRenderData(t,n)}}},e.createQuadIndices=function(){},e.updateUVs=function(t){var e=t.renderData;e&&(e.vertDirty=!0,t._markForUpdateRenderData())},e.fillBuffers=function(t){var e=t.node,n=t.renderData;if(n){var a=n.chunk;if(null!==a){(t._flagChangedVersion!==e.flagChangedVersion||n.vertDirty)&&(this.updateWorldVertexAndUVData(t,a),n.vertDirty=!1,t._flagChangedVersion=e.flagChangedVersion),this.updateColorLate(t),a.bufferId;for(var i=a.vertexOffset,r=a.meshBuffer,o=a.meshBuffer.iData,s=r.indexOffset,h=0;h<n.indexCount;h+=6)o[s++]=i,o[s++]=i+1,o[s++]=i+2,o[s++]=i+1,o[s++]=i+3,o[s++]=i+2,i+=4,r.indexOffset+=6;r.setDirty()}}},e.updateWorldUVData=function(t){var e=t.renderData;if(e)for(var n=e.floatStride,a=e.data,i=e.chunk.vb,r=0;r<a.length;r++){var o=r*n;i[o+3]=a[r].u,i[o+4]=a[r].v}},e.updateWorldVertexAndUVData=function(t,e){var n=t.renderData;if(n){t.node.getWorldMatrix(Qe);for(var a=n.floatStride,i=n.data,r=e.vb,o=i.length,s=0;s<o;s++){var h=i[s].x,l=i[s].y,u=i[s].z,c=Qe.m03*h+Qe.m07*l+Qe.m11*u+Qe.m15;c=c?1/c:1;var f=s*a;r[f]=(Qe.m00*h+Qe.m04*l+Qe.m08*u+Qe.m12)*c,r[f+1]=(Qe.m01*h+Qe.m05*l+Qe.m09*u+Qe.m13)*c,r[f+2]=(Qe.m02*h+Qe.m06*l+Qe.m10*u+Qe.m14)*c}this.updateWorldUVData(t)}},e.updateVerts=function(t,e,n,a,i){var r=t.node._getUITransformComp(),o=t.renderData;if(o){var s,h,l=o.data,u=t.spriteFrame,c=u.rect,f=Math.abs(r.width),d=Math.abs(r.height),v=r.anchorX*f,p=r.anchorY*d,g=u.insetLeft,m=u.insetRight,_=c.width-g-m,y=u.insetTop,x=u.insetBottom,S=c.height-y-x,D=r.width/(g+m)>1?1:r.width/(g+m),w=r.height/(y+x)>1?1:r.height/(y+x);s=_>0?Math.floor(1e3*e)/1e3%_==0?_:e%_:e,h=S>0?Math.floor(1e3*n)/1e3%S==0?S:n%S:n,Ze.length=0,Ke=Math.max(a+1,i+1);for(var C=0;C<Ke;C++)Ze.push({x:0,y:0,z:0,u:0,v:0,color:new Z});var b=Je(u);if(0===b)for(var T=0;T<Ke;T++)Ze[T].x=T>=i?f-v:T*_-v,Ze[T].y=T>=a?d-p:T*S-p;else for(var L=0;L<Ke;L++)0===L?Ze[L].x=-v:1===L?Ze[L].x=g*D-v:L>1&&L<i-1?Ze[L].x=_>0?g*D-v+_*(L-1):g+e-v:L===i-1?Ze[L].x=g*D-v+s+_*(L-2):L>=i&&(Ze[L].x=Math.min(g+e+m,f)-v),0===L?Ze[L].y=-p:1===L?Ze[L].y=x*w-p:L>1&&L<a-1?Ze[L].y=S>0?x*w-p+S*(L-1):x+n-p:L===a-1?Ze[L].y=x*w-p+h+S*(L-2):L>=a&&(Ze[L].y=Math.min(x+n+y,d)-p);for(var F=0,I=0,A=0,O=0,R=0;R<a;++R){A=Ze[R].y,O=Ze[R+1].y;for(var E=0;E<i;++E){F=Ze[E].x,I=Ze[E+1].x;var z=4*(R*i+E);l[z].x=F,l[z].y=A,l[z+1].x=I,l[z+1].y=A,l[z+2].x=F,l[z+2].y=O,l[z+3].x=I,l[z+3].y=O}}var M=u.rotated;u.uv;var P=u.uvSliced;He=P[0],Ve=P[1],We=P[2],Ne=P[3],je=P[4],Xe=P[8],Ye=P[12];for(var B=0,U=0,k=0===_?e:e/_,H=0===S?n:n/S,V=[],W=[],N=0;N<a;++N){U=n>S?n>=(b>0?N:N+1)*S?1:H%1:H;for(var j=0;j<i;++j){B=e>_?e>=(b>0?j:j+1)*_?1:k%1:k,M?(0===b?(V[0]=je.u,V[1]=je.u,V[2]=je.u+(Xe.u-je.u)*U,W[0]=Ve.v,W[1]=Ve.v+(We.v-Ve.v)*B,W[2]=Ve.v):(0===N?(V[0]=He.u,V[1]=He.u,V[2]=je.u):N<a-1?(V[0]=je.u,V[1]=je.u,V[2]=je.u+(Xe.u-je.u)*U):N===a-1&&(V[0]=Xe.u,V[1]=Xe.u,V[2]=Ye.u),0===j?(W[0]=He.v,W[1]=Ve.v,W[2]=He.v):j<i-1?(W[0]=Ve.v,W[1]=Ve.v+(We.v-Ve.v)*B,W[2]=Ve.v):j===i-1&&(W[0]=We.v,W[1]=Ne.v,W[2]=We.v)),V[3]=V[2],W[3]=W[1]):(0===b?(V[0]=Ve.u,V[1]=Ve.u+(We.u-Ve.u)*B,V[2]=Ve.u,W[0]=je.v,W[1]=je.v,W[2]=je.v+(Xe.v-je.v)*U):(0===j?(V[0]=He.u,V[1]=Ve.u,V[2]=He.u):j<i-1?(V[0]=Ve.u,V[1]=Ve.u+(We.u-Ve.u)*B,V[2]=Ve.u):j===i-1&&(V[0]=We.u,V[1]=Ne.u,V[2]=We.u),0===N?(W[0]=He.v,W[1]=He.v,W[2]=je.v):N<a-1?(W[0]=je.v,W[1]=je.v,W[2]=je.v+(Xe.v-je.v)*U):N===a-1&&(W[0]=Xe.v,W[1]=Xe.v,W[2]=Ye.v)),V[3]=V[1],W[3]=W[2]);var X=4*(N*i+j);l[X].u=V[0],l[X].v=W[0],l[X+1].u=V[1],l[X+1].v=W[1],l[X+2].u=V[2],l[X+2].v=W[2],l[X+3].u=V[3],l[X+3].v=W[3]}}}},e.updateColorLate=function(t){var e=t.renderData;if(e)for(var n=e.chunk.vb,a=e.floatStride,i=e.vertexCount,r=5,o=t.color,s=o.r/255,h=o.g/255,l=o.b/255,u=t.node._uiProps.opacity,c=0;c<i;c++)n[r]=s,n[r+1]=h,n[r+2]=l,n[r+3]=u,r+=a},e.updateColor=function(){},t}(),tn=new $e,en=o.Type,nn=o.FillType,an=t("spriteAssembler",{getAssembler:function(t){var e=Be,n=t;switch(n.type){case en.SLICED:e=Ge;break;case en.TILED:e=tn;break;case en.FILLED:e=n.fillType===nn.RADIAL?ze:me}return e}});o.Assembler=an;var rn=[wt.MOUSE_DOWN,wt.MOUSE_MOVE,wt.MOUSE_UP,wt.MOUSE_WHEEL,wt.MOUSE_LEAVE,wt.MOUSE_ENTER],on=[wt.TOUCH_START,wt.TOUCH_MOVE,wt.TOUCH_END,wt.TOUCH_CANCEL],sn=function(t){return!!(t._objFlags&U.Destroying||t._objFlags&U.Destroyed)},hn=function(){function t(){this.priority=St.UI,this._isListDirty=!1,this._inDispatchCount=0,this._pointerEventProcessorList=[],this._processorListToAdd=[],this._processorListToRemove=[],Dt._registerEventDispatcher(this);var t=yt.callbacksInvoker;t.on(xt.ADD_POINTER_EVENT_PROCESSOR,this.addPointerEventProcessor,this),t.on(xt.REMOVE_POINTER_EVENT_PROCESSOR,this.removePointerEventProcessor,this),t.on(xt.MARK_LIST_DIRTY,this._markListDirty,this)}var e=t.prototype;return e.onThrowException=function(){this._inDispatchCount=0},e.dispatchEvent=function(t){var e=t.type;return on.includes(e)?this.dispatchEventTouch(t):!rn.includes(e)||this.dispatchEventMouse(t)},e.addPointerEventProcessor=function(t){0===this._inDispatchCount?this._pointerEventProcessorList.includes(t)||(this._pointerEventProcessorList.push(t),this._isListDirty=!0):this._processorListToAdd.includes(t)||this._processorListToAdd.push(t),P(this._processorListToRemove,t)},e.removePointerEventProcessor=function(t){0===this._inDispatchCount?(P(this._pointerEventProcessorList,t),this._isListDirty=!0):this._processorListToRemove.includes(t)||this._processorListToRemove.push(t),P(this._processorListToAdd,t)},e.dispatchEventMouse=function(t){this._inDispatchCount++,this._sortPointerEventProcessorList();for(var e=this._pointerEventProcessorList,n=e.length,a=!0,i=0;i<n;++i){var r=e[i];if(r.isEnabled&&r.shouldHandleEventMouse&&r._handleEventMouse(t)){if(a=!1,!t.preventSwallow)break;t.preventSwallow=!1}}return--this._inDispatchCount<=0&&this._updatePointerEventProcessorList(),a},e.dispatchEventTouch=function(t){this._inDispatchCount++,this._sortPointerEventProcessorList();for(var e=this._pointerEventProcessorList,n=e.length,a=t.touch,i=!0,r=0;r<n;++r){var o=e[r];if(o.isEnabled&&o.shouldHandleEventTouch)if(t.type===wt.TOUCH_START){if(o._handleEventTouch(t)){if(o.isEnabled)o.claimedTouchIdList.push(a.getID());else{var s=new Ct([t.touch],!0,wt.TOUCH_CANCEL);s.touch=t.touch,o.dispatchEvent(s),o.claimedTouchIdList.length=0}if(i=!1,!t.preventSwallow)break;t.preventSwallow=!1}}else if(o.claimedTouchIdList.length>0){var h=o.claimedTouchIdList.indexOf(a.getID());if(-1!==h){if(o._handleEventTouch(t),t.type!==wt.TOUCH_END&&t.type!==wt.TOUCH_CANCEL||(B(o.claimedTouchIdList,h),t.preventSwallow||this._removeClaimedTouch(r+1,a.getID())),i=!1,!t.preventSwallow)break;t.preventSwallow=!1}}}return--this._inDispatchCount<=0&&this._updatePointerEventProcessorList(),i},e._removeClaimedTouch=function(t,e){for(var n=this._pointerEventProcessorList,a=n.length,i=t;i<a;++i){var r=n[i],o=r.claimedTouchIdList.indexOf(e);-1!==o&&B(r.claimedTouchIdList,o)}},e._updatePointerEventProcessorList=function(){for(var t=this._processorListToAdd,e=t.length,n=0;n<e;++n)this.addPointerEventProcessor(t[n]);t.length=0;for(var a=this._processorListToRemove,i=a.length,r=0;r<i;++r)this.removePointerEventProcessor(a[r]);a.length=0},e._sortPointerEventProcessorList=function(){if(this._isListDirty){for(var t=this._pointerEventProcessorList,e=t.length,n=0;n<e;++n){var a=t[n],i=a.node;if(i._uiProps){var r=i._getUITransformComp();a.cachedCameraPriority=r.cameraPriority}}t.sort(this._sortByPriority),this._isListDirty=!1}},e._sortByPriority=function(t,e){var n=t.node,a=e.node;if(!(e&&a&&!sn(a)&&a.activeInHierarchy&&a._getUITransformComp()))return-1;if(!t||!n||sn(n)||!n.activeInHierarchy||!n._getUITransformComp())return 1;if(t.cachedCameraPriority!==e.cachedCameraPriority)return e.cachedCameraPriority-t.cachedCameraPriority;for(var i=n,r=a,o=!1;(null==(s=i.parent)?void 0:s.uuid)!==(null==(h=r.parent)?void 0:h.uuid);){var s,h,l,u,c,f;i=null===(null==(l=i)||null==(u=l.parent)?void 0:u.parent)?(o=!0)&&a:i&&i.parent,r=null===(null==(c=r)||null==(f=c.parent)?void 0:f.parent)?(o=!0)&&n:r&&r.parent}if(i.uuid===r.uuid){if(i.uuid===a.uuid)return-1;if(i.uuid===n.uuid)return 1}var d=i?i.siblingIndex:0,v=r?r.siblingIndex:0;return o?d-v:v-d},e._markListDirty=function(){this._isListDirty=!0},t}();new hn,t("UIDrawBatch",function(t){function e(){return t.apply(this,arguments)||this}return L(e,t),e}(e)),G(st.prototype,"MeshBuffer",["byteStart","vertexStart","indicesStart","request"].map((function(t){return{name:t,suggest:"please use meshBuffer.accessor."+t+" instead"}}))),q(st.prototype,"MeshBuffer",[{name:"indicesOffset",newName:"indexOffset"}]),tt(st.prototype,"MeshBuffer",[{name:"vertexBuffers"},{name:"indexBuffer"}]),q(a.prototype,"Batcher2D",[{name:"currBufferBatch",newName:"currBufferAccessor"},{name:"acquireBufferBatch",newName:"switchBufferAccessor"}]),tt(ht.prototype,"MeshRenderData",[{name:"formatByte"},{name:"byteStart"},{name:"byteCount"}]),q(ht.prototype,"MeshRenderData",[{name:"indicesStart",newName:"indexStart"}]),t("QuadRenderData",function(t){function e(e){var n;return n=t.call(this,e)||this,F(9006),n}return L(e,t),e}(ht)),et.UI={MeshBuffer:st,spriteAssembler:an,labelAssembler:fe,RenderData:lt,MeshRenderData:ht}}}}));
//# sourceMappingURL=2d.js.map
