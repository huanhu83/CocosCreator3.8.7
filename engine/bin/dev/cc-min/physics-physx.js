System.register(["./_virtual_internal_constants-CVZmBipG.js","./index-D-Wi7yQz.js","./gc-object-BD6DANSw.js","./index-BcjqSS2q.js","./wasm-web-DpHjq6qw.js","./util-BWh5q49O.js","./deprecated-gv6rCJsk.js","./director-D6Xf3-Ej.js","./global-exports-ZavlJGEN.js","./scene-D5fG1En6.js","./collision-matrix-DvJE_i6G.js","./tuple-dictionary-By7Ih6PO.js","./prefab-CJahvMeV.js","./pipeline-state-manager-C4BAah3w.js","./node-event-BDYemSfE.js","./capsule-C5D-FUD0.js","./deprecated-BaebfHhU.js","./device-manager-BCOP-4pU.js","./buffer-barrier-CZBuOw0V.js","./debug-view-zRQBd5E1.js","./mesh-BsaPYlYJ.js","./zlib.min-CyXMsivM.js","./skeleton-hXUbiLKQ.js","./terrain-asset-DtjAFN8y.js","./touch-Ch03mDFP.js"],(function(t,e){"use strict";var i,n,s,o,r,a,l,c,h,d,u,p,_,m,f,y,g,S,E,T,C,v,w,D,A,R,L,P,I,M,F,B,O,x,N,b,G,H,k;return{setters:[null,function(t){i=t.P,n=t.q,s=t.s},function(t){o=t.L,r=t.I,a=t.a,l=t.ay,c=t._,h=t.U},function(t){d=t.n,u=t.f,p=t.Q,_=t.G,m=t.C,f=t.ai,y=t.aj,g=t.M,S=t.h},function(t){E=t.e,T=t.i},function(t){C=t.b,v=t.T,w=t.C,D=t.c,A=t.V,R=t.a},function(t){L=t.g,P=t.G},function(t){I=t.d},function(t){M=t.c},function(t){F=t.T},function(t){B=t.P,O=t.a,x=t.c,N=t.E,b=t.d,G=t.e},function(t){H=t.T},null,null,null,function(t){k=t.c},null,null,null,null,null,null,null,null,null],execute:function(){t("loadWasmModulePhysX",(function(){return Promise.resolve()}));var V,Y,U,z,X,K,$=function(){};$.foundation=void 0,$.physics=void 0,$.cooking=void 0,$.pvd=void 0,$.queryfilterData=void 0,$.singleResult=void 0,$.mutipleResults=void 0,$.simulationCB=void 0,$.queryFilterCB=void 0,$.mutipleResultSize=12,$.singleSweepResult=void 0,$.mutipleSweepResults=void 0,function(t){t[t.QUERY_FILTER=1]="QUERY_FILTER",t[t.QUERY_CHECK_TRIGGER=2]="QUERY_CHECK_TRIGGER",t[t.QUERY_SINGLE_HIT=4]="QUERY_SINGLE_HIT",t[t.DETECT_TRIGGER_EVENT=8]="DETECT_TRIGGER_EVENT",t[t.DETECT_CONTACT_EVENT=16]="DETECT_CONTACT_EVENT",t[t.DETECT_CONTACT_POINT=32]="DETECT_CONTACT_POINT",t[t.DETECT_CONTACT_CCD=64]="DETECT_CONTACT_CCD"}(V||(V={})),function(t){t[t.ePOSITION=1]="ePOSITION",t[t.eNORMAL=2]="eNORMAL",t[t.eUV=8]="eUV",t[t.eASSUME_NO_INITIAL_OVERLAP=16]="eASSUME_NO_INITIAL_OVERLAP",t[t.eMESH_MULTIPLE=32]="eMESH_MULTIPLE",t[t.eMESH_ANY=64]="eMESH_ANY",t[t.eMESH_BOTH_SIDES=128]="eMESH_BOTH_SIDES",t[t.ePRECISE_SWEEP=256]="ePRECISE_SWEEP",t[t.eMTD=512]="eMTD",t[t.eFACE_INDEX=1024]="eFACE_INDEX",t[t.eDEFAULT=t.ePOSITION|t.eNORMAL|t.eFACE_INDEX]="eDEFAULT",t[t.eMODIFIABLE_FLAGS=t.eMESH_MULTIPLE|t.eMESH_BOTH_SIDES|t.eASSUME_NO_INITIAL_OVERLAP|t.ePRECISE_SWEEP]="eMODIFIABLE_FLAGS"}(Y||(Y={})),function(t){t[t.eSTATIC=1]="eSTATIC",t[t.eDYNAMIC=2]="eDYNAMIC",t[t.ePREFILTER=4]="ePREFILTER",t[t.ePOSTFILTER=8]="ePOSTFILTER",t[t.eANY_HIT=16]="eANY_HIT",t[t.eNO_BLOCK=32]="eNO_BLOCK",t[t.eRESERVED=32768]="eRESERVED"}(U||(U={})),function(t){t[t.eSOLVE_CONTACT=1]="eSOLVE_CONTACT",t[t.eMODIFY_CONTACTS=2]="eMODIFY_CONTACTS",t[t.eNOTIFY_TOUCH_FOUND=4]="eNOTIFY_TOUCH_FOUND",t[t.eNOTIFY_TOUCH_PERSISTS=8]="eNOTIFY_TOUCH_PERSISTS",t[t.eNOTIFY_TOUCH_LOST=16]="eNOTIFY_TOUCH_LOST",t[t.eNOTIFY_TOUCH_CCD=32]="eNOTIFY_TOUCH_CCD",t[t.eNOTIFY_THRESHOLD_FORCE_FOUND=64]="eNOTIFY_THRESHOLD_FORCE_FOUND",t[t.eNOTIFY_THRESHOLD_FORCE_PERSISTS=128]="eNOTIFY_THRESHOLD_FORCE_PERSISTS",t[t.eNOTIFY_THRESHOLD_FORCE_LOST=256]="eNOTIFY_THRESHOLD_FORCE_LOST",t[t.eNOTIFY_CONTACT_POINTS=512]="eNOTIFY_CONTACT_POINTS",t[t.eDETECT_DISCRETE_CONTACT=1024]="eDETECT_DISCRETE_CONTACT",t[t.eDETECT_CCD_CONTACT=2048]="eDETECT_CCD_CONTACT",t[t.ePRE_SOLVER_VELOCITY=4096]="ePRE_SOLVER_VELOCITY",t[t.ePOST_SOLVER_VELOCITY=8192]="ePOST_SOLVER_VELOCITY",t[t.eCONTACT_EVENT_POSE=16384]="eCONTACT_EVENT_POSE",t[t.eNEXT_FREE=32768]="eNEXT_FREE",t[t.eCONTACT_DEFAULT=1025]="eCONTACT_DEFAULT",t[t.eTRIGGER_DEFAULT=1044]="eTRIGGER_DEFAULT"}(z||(z={})),function(t){t[t.eREMOVED_SHAPE_0=1]="eREMOVED_SHAPE_0",t[t.eREMOVED_SHAPE_1=2]="eREMOVED_SHAPE_1",t[t.eACTOR_PAIR_HAS_FIRST_TOUCH=4]="eACTOR_PAIR_HAS_FIRST_TOUCH",t[t.eACTOR_PAIR_LOST_TOUCH=8]="eACTOR_PAIR_LOST_TOUCH",t[t.eINTERNAL_HAS_IMPULSES=16]="eINTERNAL_HAS_IMPULSES",t[t.eINTERNAL_CONTACTS_ARE_FLIPPED=32]="eINTERNAL_CONTACTS_ARE_FLIPPED"}(X||(X={})),function(t){t[t.eREMOVED_SHAPE_TRIGGER=1]="eREMOVED_SHAPE_TRIGGER",t[t.eREMOVED_SHAPE_OTHER=2]="eREMOVED_SHAPE_OTHER",t[t.eNEXT_FREE=4]="eNEXT_FREE"}(K||(K={}));var J={},W=M._global,q=!!W.PHYSX;function Q(t){W.PhysX=t,t.EPSILON=.001,t.MULTI_THREAD=!1,t.SUB_THREAD_COUNT=1,t.CACHE_MAT={},t.IMPL_PTR={},t.MESH_CONVEX={},t.MESH_STATIC={},t.TERRAIN_STATIC={}}function j(t){t.VECTOR_MAT=new t.PxMaterialVector,t.MeshScale=t.PxMeshScale,t.ShapeFlag=t.PxShapeFlag,t.ActorFlag=t.PxActorFlag,t.ForceMode=t.PxForceMode,t.CombineMode=t.PxCombineMode,t.BoxGeometry=t.PxBoxGeometry,t.QueryHitType=t.PxQueryHitType,t.RigidBodyFlag=t.PxRigidBodyFlag,t.PlaneGeometry=t.PxPlaneGeometry,t.SphereGeometry=t.PxSphereGeometry,t.CapsuleGeometry=t.PxCapsuleGeometry,t.ConvexMeshGeometry=t.PxConvexMeshGeometry,t.D6Motion=t.PxD6Motion,t.D6Axis=t.PxD6Axis,t.D6Drive=t.PxD6Drive,t.D6JointDrive=t.PxD6JointDrive,t.LinearLimitPair=t.PxJointLinearLimitPair,t.AngularLimitPair=t.PxJointAngularLimitPair,t.TriangleMeshGeometry=t.PxTriangleMeshGeometry,t.RigidDynamicLockFlag=t.PxRigidDynamicLockFlag,t.TolerancesScale=t.PxTolerancesScale,t.RevoluteJointFlags={eLIMIT_ENABLED:1,eDRIVE_ENABLED:2,eDRIVE_FREESPIN:4},t.JointAngularLimitPair=t.PxJointAngularLimitPair,t.createRevoluteJoint=function(e,i,n,s){return t.PxRevoluteJointCreate(J.physics,e,i,n,s)},t.createFixedConstraint=function(e,i,n,s){return t.PxFixedJointCreate(J.physics,e,i,n,s)},t.createSphericalJoint=function(e,i,n,s){return t.PxSphericalJointCreate(J.physics,e,i,n,s)},t.createD6Joint=function(e,i,n,s){return t.PxD6JointCreate(J.physics,e,i,n,s)}}L.onPostInfrastructureInitDelegate.add((function(){return E().then((function(){return d.hasFeature(d.Feature.WASM)?Promise.all([e.import("./physx.release.wasm-CngAu4sy.js").then((function(t){return t.p})),e.import("./physx.release.wasm-C6LLqpgQ.js")]).then((function(t){return e=t[0].default,i=t[1].default,W.PhysX=W.PHYSX?W.PHYSX:e,null!=W.PhysX?W.PhysX({instantiateWasm:function(t,e){return T(i,t).then((function(t){e(t.instance,t.module)}))}}).then((function(t){console.debug("[PHYSICS]:",(q?"External":"Internal")+" PhysX wasm libs loaded."),j(t),Q(t),J=t}),(function(t){console.error("[PHYSICS]:","PhysX wasm load failed: "+t)})):(console.error("[PHYSICS]:","Failed to load PhysX wasm libs, package may be not found."),new Promise((function(t){t()})));var e,i})):e.import("./physx.release.asm-8m8pmVgI.js").then((function(t){return t.p})).then((function(t){return e=t.default,W.PhysX=W.PHYSX?W.PHYSX:e,null!=W.PhysX?W.PhysX().then((function(t){console.debug("[PHYSICS]:",(q?"External":"Internal")+" PhysX asm libs loaded."),j(t),Q(t),Object.assign(J,t)}),(function(t){console.error("[PHYSICS]:","PhysX asm load failed: "+t)})):(console.error("[PHYSICS]:","Failed to load PhysX js libs, package may be not found."),new Promise((function(t){t()})));var e}))})).catch((function(t){o(t)}))}));var Z={x:0,y:0,z:0},tt={x:0,y:0,z:0,w:1},et={translation:Z,rotation:tt,p:Z,q:tt};function it(t,e){t.b=e>>16&255,t.g=e>>8&255,t.r=255&e,t.a=255}var nt=et;function st(t,e){e&&e.$$&&(J.IMPL_PTR[e.$$.ptr]=t)}function ot(t,e){e&&e.$$&&(J.IMPL_PTR[e.$$.ptr]=null,delete J.IMPL_PTR[e.$$.ptr])}function rt(t){return J.IMPL_PTR[t.$$.ptr]}function at(t,e){return u.copy(nt.translation,t),p.copy(nt.rotation,e),nt}function lt(t,e){return u.copy(et.p,t),p.copy(et.q,e),et}function ct(t,e){t.addActor(e,null)}function ht(t,e,i){t.setActors(e,i)}function dt(t,e){t.setMassAndUpdateInertia(e)}function ut(t,e){var i=t.worldPosition,n=t.worldRotation;pt(e,i)&&_t(e,n)||(t.setWorldPosition(e.translation),t.setWorldRotation(e.rotation))}function pt(t,e){return u.equals(t.translation,e,J.EPSILON)}function _t(t,e){return p.equals(t.rotation,e,J.EPSILON)}function mt(t,e,i,n){t?e.applyImpulse(i,n):e.applyLocalImpulse(i,n)}function ft(t,e,i,n){t?e.applyForce(i,n):e.applyLocalForce(i,n)}function yt(t,e){t.addTorque(e)}function gt(t,e,i){for(var n=C(t),s=n.length,o=new J.PxVec3Vector,r=0;r<s;r+=3)o.push_back({x:n[r],y:n[r+1],z:n[r+2]});var a=e.createConvexMesh(o,i);return o.delete(),a}function St(t,e){return e?new J.PxConvexMeshGeometryFlags(t):new J.PxMeshGeometryFlags(t)}function Et(t,e,i,n){for(var s=t.length,o=e.length,r=new J.PxVec3Vector,a=0;a<s;a+=3)r.push_back({x:t[a],y:t[a+1],z:t[a+2]});for(var l=new J.PxU16Vector,c=0;c<o;c+=3)l.push_back(e[c]),l.push_back(e[c+1]),l.push_back(e[c+2]);var h=i.createTriMeshExt(r,l,n);return r.delete(),l.delete(),h}function Tt(t,e,i,n){for(var s=t.getVertexCountI(),o=t.getVertexCountJ(),r=new J.PxHeightFieldSampleVector,a=0;a<s;a++)for(var l=0;l<o;l++){var c=new J.PxHeightFieldSample;c.height=t.getHeight(a,l)/e,r.push_back(c)}return i.createHeightFieldExt(s,o,r,n)}function Ct(t,e,i,n,s){return new J.PxHeightFieldGeometry(t,new J.PxMeshGeometryFlags(e),i,n,s)}function vt(t,e,i,n,s){var o=i.maxDistance,r=Y.ePOSITION|Y.eNORMAL,a=V.QUERY_FILTER|(i.queryTrigger?0:V.QUERY_CHECK_TRIGGER),l=U.eSTATIC|U.eDYNAMIC|U.ePREFILTER|U.eNO_BLOCK,c=$.queryfilterData,h=$.queryFilterCB,d=$.mutipleResults;c.setWords(i.mask>>>0,0),c.setWords(a,3),c.setFlags(l);var u=d,p=t.scene.raycastMultiple(e.o,e.d,o,r,u,u.size(),c,h,null);if(p>0){for(var _=0;_<p;_++){var m=u.get(_),f=rt(m.getShape()).collider,y=n.add();y._assign(m.position,m.distance,f,m.normal),s.push(y)}return!0}return-1===p&&console.error("not enough memory."),!1}function wt(t,e,i,n){i.maxDistance;var s=Y.ePOSITION|Y.eNORMAL,o=V.QUERY_FILTER|(i.queryTrigger?0:V.QUERY_CHECK_TRIGGER)|V.QUERY_SINGLE_HIT,r=U.eSTATIC|U.eDYNAMIC|U.ePREFILTER,a=$.queryfilterData,l=$.queryFilterCB;a.setWords(i.mask>>>0,0),a.setWords(o,3),a.setFlags(r);var c=$.singleResult;if(t.scene.raycastSingle(e.o,e.d,i.maxDistance,s,c,a,l,null)){var h=rt(c.getShape()).collider;return n._assign(c.position,c.distance,h,c.normal),!0}return!1}function Dt(t,e,i,n,s,o,r){var a=s.maxDistance,l=Y.ePOSITION|Y.eNORMAL,c=V.QUERY_FILTER|(s.queryTrigger?0:V.QUERY_CHECK_TRIGGER),h=U.eSTATIC|U.eDYNAMIC|U.ePREFILTER|U.eNO_BLOCK,d=$.queryfilterData,u=$.queryFilterCB,p=$.mutipleSweepResults;d.setWords(s.mask>>>0,0),d.setWords(c,3),d.setFlags(h);var _=p,m=t.scene.sweepMultiple(i,at(e.o,n),e.d,a,l,_,_.size(),d,u,null,0);if(m>0){for(var f=0;f<m;f++){var y=_.get(f),g=rt(y.getShape()).collider,S=o.add();S._assign(y.position,y.distance,g,y.normal),r.push(S)}return!0}return-1===m&&console.error("not enough memory."),!1}function At(t,e,i,n,s,o){var r=s.maxDistance,a=Y.ePOSITION|Y.eNORMAL,l=V.QUERY_FILTER|(s.queryTrigger?0:V.QUERY_CHECK_TRIGGER)|V.QUERY_SINGLE_HIT,c=U.eSTATIC|U.eDYNAMIC|U.ePREFILTER,h=$.queryfilterData;h.setWords(s.mask>>>0,0),h.setWords(l,3),h.setFlags(c);var d=$.queryFilterCB,u=$.singleSweepResult;if(t.scene.sweepSingle(i,at(e.o,n),e.d,r,a,u,h,d,null,0)){var p=rt(u.getShape()).collider;return o._assign(u.position,u.distance,p,u.normal),!0}return!1}function Rt(t){if(!$.foundation){var e=J.PX_PHYSICS_VERSION,i=new J.PxDefaultAllocator,n=new J.PxDefaultErrorCallback,s=$.foundation=J.PxCreateFoundation(e,i,n);$.pvd=null;var o=new J.PxTolerancesScale;$.physics=J.physics=J.PxCreatePhysics(e,s,o,!1,$.pvd),$.cooking=J.PxCreateCooking(e,s,new J.PxCookingParams(o)),J.PxInitExtensions($.physics,$.pvd),$.singleResult=new J.PxRaycastHit,($.mutipleResults=new J.PxRaycastHitVector).resize($.mutipleResultSize,$.singleResult),$.queryfilterData=new J.PxQueryFilterData,$.simulationCB=J.PxSimulationEventCallback.implement(t.callback.eventCallback),$.queryFilterCB=J.PxQueryFilterCallback.implement(t.callback.queryCallback),$.singleSweepResult=new J.PxSweepHit,($.mutipleSweepResults=new J.PxSweepHitVector).resize($.mutipleResultSize,$.singleSweepResult)}var r=J.getDefaultSceneDesc($.physics.getTolerancesScale(),0,$.simulationCB);t.scene=$.physics.createScene(r),t.scene.setVisualizationParameter(J.PxVisualizationParameter.eSCALE,1),t.controllerManager=J.PxCreateControllerManager(t.scene,!1)}function Lt(t,e){u.copy(e,t.position)}function Pt(t,e){u.copy(e,t.normal)}function It(t,e){return J.getGContacts().get(t+e)}var Mt=function(){function t(e,i){this.id=void 0,this.node=void 0,this.wrappedWorld=void 0,this.wrappedShapes=[],this.wrappedJoints0=[],this.wrappedJoints1=[],this._index=-1,this._ref=0,this._isStatic=!1,this._isKinematic=!1,this._dynamicActor=void 0,this._staticActor=void 0,this._wrappedBody=null,this._filterData=void 0,this.id=t.idCounter++,this.node=e,this.wrappedWorld=i,this._filterData={word0:1,word1:1,word2:1,word3:0}}t.getSharedBody=function(e,n,s){var o,r=e.uuid;if(t.sharedBodesMap.has(r)?o=t.sharedBodesMap.get(r):((o=new t(e,n)).filterData.word0=B.DEFAULT,o.filterData.word1=i.instance.collisionMatrix[B.DEFAULT],t.sharedBodesMap.set(e.uuid,o)),s){o._wrappedBody=s;var a=s.rigidBody.group,l=i.instance.collisionMatrix[a];o.filterData.word0=a,o.filterData.word1=l}return o};var e=t.prototype;return e._initActor=function(){var t=this._isStatic,e=this.wrappedBody;e?e.rigidBody.type===O.STATIC?(this._isStatic=!0,this._isKinematic=!1,this._initStaticActor()):(this._isStatic=!1,this._initDynamicActor()):(this._isStatic=!0,this._isKinematic=!1,this._initStaticActor()),t!==this._isStatic&&this._switchActor(t)},e._initStaticActor=function(){if(!this._staticActor){var t=at(this.node.worldPosition,this.node.worldRotation);this._staticActor=$.physics.createRigidStatic(t),this._staticActor.setActorFlag(J.ActorFlag.eVISUALIZATION,!0),this._staticActor.$$&&(J.IMPL_PTR[this._staticActor.$$.ptr]=this)}},e._initDynamicActor=function(){if(!this._dynamicActor){var t=at(this.node.worldPosition,this.node.worldRotation);this._dynamicActor=$.physics.createRigidDynamic(t),this._dynamicActor.$$&&(J.IMPL_PTR[this._dynamicActor.$$.ptr]=this);var e=this.wrappedBody;if(e){var i=e.rigidBody;this._dynamicActor.setMass(i.mass),this._dynamicActor.setActorFlag(J.ActorFlag.eVISUALIZATION,!0),this._dynamicActor.setActorFlag(J.ActorFlag.eDISABLE_GRAVITY,!i.useGravity),this.setLinearDamping(i.linearDamping),this.setAngularDamping(i.angularDamping),this.setRigidBodyFlag(J.RigidBodyFlag.eKINEMATIC,i.isKinematic);var n=i.linearFactor;this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_X,!n.x),this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_Y,!n.y),this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_Z,!n.z);var s=i.angularFactor;this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_X,!s.x),this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_Y,!s.y),this._dynamicActor.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_Z,!s.z)}}},e._switchActor=function(t){if(this._staticActor&&this._dynamicActor){var e=t?this._staticActor:this._dynamicActor,i=t?this._dynamicActor:this._staticActor;this._index>=0&&(this.wrappedWorld.scene.removeActor(e,!1),ct(this.wrappedWorld.scene,i));for(var n=0;n<this.wrappedShapes.length;n++){var s=this.wrappedShapes[n];e.detachShape(s.impl,!1),i.attachShape(s.impl)}t&&dt(this._dynamicActor,this._wrappedBody.rigidBody.mass)}},e.addShape=function(t){this.wrappedShapes.indexOf(t)<0&&(t.setIndex(this.wrappedShapes.length),t.updateFilterData(this._filterData),this.impl.attachShape(t.impl),this.wrappedShapes.push(t),t.collider.isTrigger||this.isDynamic&&dt(this.impl,this._wrappedBody.rigidBody.mass))},e.removeShape=function(t){var e=this.wrappedShapes.indexOf(t);e>=0&&(t.setIndex(-1),this.impl.detachShape(t.impl,!0),r(this.wrappedShapes,e),t.collider.isTrigger||this.isDynamic&&dt(this.impl,this._wrappedBody.rigidBody.mass))},e.addJoint=function(t,e){e?this.wrappedJoints1.indexOf(t)<0&&this.wrappedJoints1.push(t):this.wrappedJoints0.indexOf(t)<0&&this.wrappedJoints0.push(t)},e.removeJoint=function(t,e){if(e){var i=this.wrappedJoints1.indexOf(t);i>=0&&r(this.wrappedJoints1,i)}else{var n=this.wrappedJoints0.indexOf(t);n>=0&&r(this.wrappedJoints0,n)}},e.setLinearDamping=function(t){if(this._dynamicActor){var e=i.instance.fixedTimeStep;this._dynamicActor.setLinearDamping((1-Math.pow(1-t,e))/e)}},e.setAngularDamping=function(t){if(this._dynamicActor){var e=i.instance.fixedTimeStep;this._dynamicActor.setAngularDamping((1-Math.pow(1-t,e))/e)}},e.setMass=function(t){t<=0||this.isDynamic&&dt(this.impl,t)},e.setType=function(t){if(this._initActor(),!this.isStatic)switch(t){case O.DYNAMIC:this.setRigidBodyFlag(J.RigidBodyFlag.eKINEMATIC,!1);break;case O.KINEMATIC:default:this.setRigidBodyFlag(J.RigidBodyFlag.eKINEMATIC,!0)}},e.setRigidBodyFlag=function(t,e){t===J.RigidBodyFlag.eKINEMATIC&&(this._isKinematic=e),this.impl.setRigidBodyFlag(t,e)},e.syncSceneToPhysics=function(){var t=this.node;if(t.hasChangedFlags)if(t.hasChangedFlags&F.SCALE&&this.syncScale(),this._isKinematic){var e=at(t.worldPosition,t.worldRotation);this.impl.setKinematicTarget(e)}else{var i=lt(t.worldPosition,t.worldRotation);this.impl.setGlobalPose(i,!0)}},e.syncSceneWithCheck=function(){var t=this.node;if(t.hasChangedFlags){t.hasChangedFlags&F.SCALE&&this.syncScale();var e=t.worldPosition,i=t.worldRotation,n=this.impl.getGlobalPose();if(!pt(n,e)||!_t(n,i))if(this._isKinematic){var s=at(t.worldPosition,t.worldRotation);this.impl.setKinematicTarget(s)}else{var o=lt(t.worldPosition,t.worldRotation);this.impl.setGlobalPose(o,!0)}}},e.syncPhysicsToScene=function(){var t,e;this.isDynamic&&(t=this._dynamicActor,e=this.node,t.isSleeping()||ut(e,t.getGlobalPose()))},e.syncScale=function(){for(var t=0;t<this.wrappedShapes.length;t++)this.wrappedShapes[t].updateScale();for(var e=0;e<this.wrappedJoints0.length;e++)this.wrappedJoints0[e].updateScale0();for(var i=0;i<this.wrappedJoints1.length;i++)this.wrappedJoints1[i].updateScale1()},e.setGroup=function(t){t>>>=0,this._filterData.word0=t,this.updateFilterData()},e.getGroup=function(){return this._filterData.word0},e.addGroup=function(t){t>>>=0,this._filterData.word0|=t,this.updateFilterData()},e.removeGroup=function(t){t>>>=0,this._filterData.word0&=~t,this.updateFilterData()},e.setMask=function(t){t>>>=0,this._filterData.word1=t,this.updateFilterData()},e.getMask=function(){return this._filterData.word1},e.addMask=function(t){t>>>=0,this._filterData.word1|=t,this.updateFilterData()},e.removeMask=function(t){t>>>=0,this._filterData.word1&=~t,this.updateFilterData()},e.updateFilterData=function(){for(var t=0;t<this.wrappedShapes.length;t++)this.wrappedShapes[t].updateFilterData(this._filterData)},e.clearForces=function(){this._isStatic||this._isKinematic||(this.impl.clearForce(J.ForceMode.eFORCE),this.impl.clearForce(J.ForceMode.eIMPULSE),this.impl.clearTorque(J.ForceMode.eFORCE),this.impl.clearTorque(J.ForceMode.eIMPULSE))},e.clearVelocity=function(){this._isStatic||this._isKinematic||(this.impl.setLinearVelocity(u.ZERO,!1),this.impl.setAngularVelocity(u.ZERO,!1))},e.destroy=function(){this._dynamicActor&&(this._dynamicActor.$$&&(J.IMPL_PTR[this._dynamicActor.$$.ptr]=null,delete J.IMPL_PTR[this._dynamicActor.$$.ptr]),this._dynamicActor.release(),this._dynamicActor=null),this._staticActor&&(this._staticActor.$$&&(J.IMPL_PTR[this._staticActor.$$.ptr]=null,delete J.IMPL_PTR[this._staticActor.$$.ptr]),this._staticActor.release(),this._staticActor=null),t.sharedBodesMap.delete(this.node.uuid)},a(t,[{key:"isStatic",get:function(){return this._isStatic}},{key:"isKinematic",get:function(){return this._isKinematic}},{key:"isDynamic",get:function(){return!this._isStatic&&!this._isKinematic}},{key:"wrappedBody",get:function(){return this._wrappedBody}},{key:"filterData",get:function(){return this._filterData}},{key:"isInScene",get:function(){return-1!==this._index}},{key:"impl",get:function(){return this._initActor(),this.isStatic?this._staticActor:this._dynamicActor}},{key:"reference",set:function(t){this._ref=t?this._ref+1:this._ref-1,0===this._ref&&this.destroy()}},{key:"enabled",set:function(t){if(t)this._index<0&&(this._index=this.wrappedWorld.wrappedBodies.length,this.wrappedWorld.addActor(this));else if(this._index>=0){var e=this.wrappedShapes,i=this.wrappedBody;(0===e.length&&null==i||0===e.length&&null!=i&&!i.isEnabled)&&(this._index=-1,this.clearForces(),this.clearVelocity(),this.wrappedWorld.removeActor(this))}}}]),t}();Mt.idCounter=0,Mt.sharedBodesMap=new Map;var Ft,Bt=new p,Ot=function(){function t(t){this.impl=null,this.event=void 0,this.colliderA=void 0,this.colliderB=void 0,this.event=t}var e=t.prototype;return e.getLocalPointOnA=function(t){Lt(this.impl,t,this.event.impl),u.subtract(t,t,this.colliderA.node.worldPosition)},e.getLocalPointOnB=function(t){Lt(this.impl,t,this.event.impl),u.subtract(t,t,this.colliderB.node.worldPosition)},e.getWorldPointOnA=function(t){Lt(this.impl,t,this.event.impl)},e.getWorldPointOnB=function(t){Lt(this.impl,t,this.event.impl)},e.getLocalNormalOnA=function(t){this.getWorldNormalOnA(t),p.conjugate(Bt,this.colliderA.node.worldRotation),u.transformQuat(t,t,Bt)},e.getLocalNormalOnB=function(t){this.getWorldNormalOnB(t),p.conjugate(Bt,this.colliderB.node.worldRotation),u.transformQuat(t,t,Bt)},e.getWorldNormalOnA=function(t){Pt(this.impl,t,this.event.impl),this.isBodyA||u.negate(t,t)},e.getWorldNormalOnB=function(t){Pt(this.impl,t,this.event.impl)},a(t,[{key:"isBodyA",get:function(){return this.colliderA.uuid===this.event.selfCollider.uuid}}]),t}();!function(t){t[t.SPHERE=0]="SPHERE",t[t.BOX=1]="BOX",t[t.CAPSULE=2]="CAPSULE",t[t.CYLINDER=3]="CYLINDER",t[t.CONE=4]="CONE",t[t.PLANE=5]="PLANE",t[t.TERRAIN=6]="TERRAIN",t[t.MESH=7]="MESH"}(Ft||(Ft={}));var xt=function(){function t(e){this.id=void 0,this.type=void 0,this._impl=null,this._collider=null,this._flags=void 0,this._sharedBody=void 0,this._rotation=new p(0,0,0,1),this._index=-1,this._word3=0,this._isEnabled=!1,this.type=e,this.id=t.idCounter++}var e=t.prototype;return e.initialize=function(t){var e;this._collider=t,this._flags=(e=(t.isTrigger?J.PxShapeFlag.eTRIGGER_SHAPE.value:J.PxShapeFlag.eSIMULATION_SHAPE.value)|J.PxShapeFlag.eSCENE_QUERY_SHAPE.value|J.PxShapeFlag.eVISUALIZATION.value,new J.PxShapeFlags(e)),this._sharedBody=i.instance.physicsWorld.getSharedBody(t.node),this._sharedBody.reference=!0,this.onComponentSet(),st(this,this._impl)},e.setIndex=function(t){this._index=t},e.onComponentSet=function(){},e.updateScale=function(){},e.onLoad=function(){this.setMaterial(this._collider.sharedMaterial),this.setCenter(this._collider.center)},e.onEnable=function(){this.addToBody(),this._isEnabled=!0,this._sharedBody.enabled=!0},e.onDisable=function(){this.removeFromBody(),this._isEnabled=!1,this._sharedBody.enabled=!1},e.onDestroy=function(){this._sharedBody.reference=!1,this._impl&&(ot(0,this._impl),this._impl.release(),this._impl=null),this._flags=null,this._collider=null},e.setMaterial=function(t){var e,i=this.getSharedMaterial(t);this._impl.setMaterials((e=i,J.VECTOR_MAT.size()>0?J.VECTOR_MAT.set(0,e):J.VECTOR_MAT.push_back(e),J.VECTOR_MAT))},e.getSharedMaterial=function(t){var e=null==t?i.instance.defaultMaterial:t;if(!J.CACHE_MAT[e.id]){var n=$.physics.createMaterial(e.friction,e.friction,e.restitution);return n.setFrictionCombineMode(J.CombineMode.eMULTIPLY),n.setRestitutionCombineMode(J.CombineMode.eMULTIPLY),J.CACHE_MAT[e.id]=n,n}var s=J.CACHE_MAT[e.id];return s.setStaticFriction(e.friction),s.setDynamicFriction(e.friction),s.setRestitution(e.restitution),s},e.setAsTrigger=function(t){t?(this._impl.setFlag(J.ShapeFlag.eSIMULATION_SHAPE,!t),this._impl.setFlag(J.ShapeFlag.eTRIGGER_SHAPE,t)):(this._impl.setFlag(J.ShapeFlag.eTRIGGER_SHAPE,t),this._impl.setFlag(J.ShapeFlag.eSIMULATION_SHAPE,!t)),this._index>=0&&(this._sharedBody.removeShape(this),this._sharedBody.addShape(this))},e.setCenter=function(t){var e=et.translation,i=et.rotation;u.multiply(e,t,this._collider.node.worldScale),p.copy(i,this._rotation);var n=at(e,i);this._impl.setLocalPose(n)},e.getAABB=function(t){var e,i,n,s;e=this.impl,i=this._sharedBody.impl,n=t,s=e.getWorldBounds(i,1),_.fromPoints(n,s.minimum,s.maximum)},e.getBoundingSphere=function(t){_.toBoundingSphere(t,this._collider.worldBounds)},e.setGroup=function(t){this._sharedBody.setGroup(t)},e.getGroup=function(){return this._sharedBody.getGroup()},e.addGroup=function(t){this._sharedBody.addGroup(t)},e.removeGroup=function(t){this._sharedBody.removeGroup(t)},e.setMask=function(t){this._sharedBody.setMask(t)},e.getMask=function(){return this._sharedBody.getMask()},e.addMask=function(t){this._sharedBody.addMask(t)},e.removeMask=function(t){this._sharedBody.removeMask(t)},e.updateFilterData=function(t){this._word3=V.DETECT_CONTACT_CCD,this._collider.needTriggerEvent&&(this._word3|=V.DETECT_TRIGGER_EVENT),this._collider.needCollisionEvent&&(this._word3|=V.DETECT_CONTACT_EVENT|V.DETECT_CONTACT_POINT),t.word3=this._word3,this.setFilerData(t)},e.updateEventListener=function(){this._sharedBody&&this.updateFilterData(this._sharedBody.filterData)},e.updateByReAdd=function(){this._isEnabled&&(this.removeFromBody(),this.addToBody())},e.setFilerData=function(t){this._impl.setQueryFilterData(t),this._impl.setSimulationFilterData(t)},e.addToBody=function(){this._sharedBody.addShape(this)},e.removeFromBody=function(){this._sharedBody.removeShape(this)},a(t,[{key:"impl",get:function(){return this._impl}},{key:"collider",get:function(){return this._collider}},{key:"attachedRigidBody",get:function(){return null}}],[{key:"MESH_SCALE",get:function(){return this._MESH_SCALE||(this._MESH_SCALE=new J.MeshScale(u.ZERO,p.IDENTITY)),this._MESH_SCALE}}]),t}();xt._MESH_SCALE=void 0,xt.idCounter=0;var Nt=new u(0,0,0),bt=new u(0,0,0),Gt=function(){function t(){this._isEnabled=!1,this._impl=null,this._comp=null,this._pxCollisionFlags=0,this._filterData=void 0,this._queryFilterCB=null,this._word3=0,this._overlapRecovery=!0,this.id=void 0,this.id=t.idCounter++,this._filterData={word0:1,word1:1,word2:1,word3:0}}var e=t.prototype;return e.onComponentSet=function(){},e.create=function(){},e.updateScale=function(){},e.initialize=function(e){this._comp=e,this._queryFilterCB=J.PxQueryFilterCallback.implement(t.queryCallback);var n=this._comp.group;this._filterData.word0=this._comp.group;var s=i.instance.collisionMatrix[n];return this._filterData.word1=s,this.onComponentSet(),null!=this._impl||(o("[Physics]: Initialize PhysXCharacterController Failed"),!1)},e.onEnable=function(){this._isEnabled=!0,this._impl||this.onComponentSet(),this.setDetectCollisions(!0),this.setOverlapRecovery(!0),i.instance.physicsWorld.addCCT(this)},e.onDisable=function(){this._isEnabled=!1,i.instance.physicsWorld.removeCCT(this),this.onDestroy()},e.onLoad=function(){},e.release=function(){if(this._impl){if(this._impl.$$){J.IMPL_PTR[this._impl.$$.ptr]=null,delete J.IMPL_PTR[this._impl.$$.ptr];var t=this._impl.getShape().$$.ptr;J.IMPL_PTR[t]=null,delete J.IMPL_PTR[t]}this._impl.release(),this._impl=null}},e.onDestroy=function(){this.release()},e.getPosition=function(t){this._impl&&u.copy(t,this._impl.getPosition())},e.setPosition=function(t){this._impl&&(this._impl.setPosition(t),this.syncPhysicsToScene())},e.setContactOffset=function(t){this._impl&&this._impl.setContactOffset(t)},e.setStepOffset=function(t){this._impl&&this._impl.setStepOffset(t)},e.setSlopeLimit=function(t){this._impl&&this._impl.setSlopeLimit(Math.cos(l(t)))},e.setDetectCollisions=function(t){this._impl&&this._impl.setCollision(t)},e.setQuery=function(t){this._impl&&this._impl.setQuery(t)},e.setOverlapRecovery=function(t){this._overlapRecovery=t},e.onGround=function(){return(4&this._pxCollisionFlags)>0},e.syncSceneToPhysics=function(){var t=this.characterController.node;t.hasChangedFlags&&(t.hasChangedFlags&F.SCALE&&this.syncScale(),t.hasChangedFlags&F.POSITION&&(u.add(Nt,t.worldPosition,this.scaledCenter),this.setPosition(Nt)))},e.syncPhysicsToScene=function(){this.getPosition(Nt),Nt.subtract(this.scaledCenter),this._comp.node.setWorldPosition(Nt)},e.syncScale=function(){this.updateScale()},e.move=function(t,e,n){this._isEnabled&&(i.instance.physicsWorld.controllerManager.setOverlapRecoveryModule(this._overlapRecovery),this._pxCollisionFlags=this._impl.move(t,e,n,this.filterData,this.queryFilterCB))},e.setGroup=function(t){t>>>=0,this._filterData.word0=t,this.updateFilterData()},e.getGroup=function(){return this._filterData.word0},e.addGroup=function(t){t>>>=0,this._filterData.word0|=t,this.updateFilterData()},e.removeGroup=function(t){t>>>=0,this._filterData.word0&=~t,this.updateFilterData()},e.setMask=function(t){t>>>=0,this._filterData.word1=t,this.updateFilterData()},e.getMask=function(){return this._filterData.word1},e.addMask=function(t){t>>>=0,this._filterData.word1|=t,this.updateFilterData()},e.removeMask=function(t){t>>>=0,this._filterData.word1&=~t,this.updateFilterData()},e.updateEventListener=function(){this.updateFilterData()},e.updateFilterData=function(){this._impl&&this._impl.setSimulationFilterData(this.filterData)},a(t,[{key:"isEnabled",get:function(){return this._isEnabled}},{key:"impl",get:function(){return this._impl}},{key:"characterController",get:function(){return this._comp}},{key:"filterData",get:function(){return this._filterData}},{key:"queryFilterCB",get:function(){return this._queryFilterCB}},{key:"scaledCenter",get:function(){return u.multiply(bt,this._comp.center,this._comp.node.worldScale),bt}}]),t}();Gt.idCounter=0,Gt.queryCallback={preFilter:function(t,e){var i=rt(e);if(!i)return J.QueryHitType.eNONE;var n=i.collider;return t.word0&n.getMask()&&t.word1&n.getGroup()?J.QueryHitType.eBLOCK:J.QueryHitType.eNONE}};var Ht=new p,kt=new u,Vt=new u,Yt=new u,Ut=new m(0,0,0,0),zt=function(t){c(i,t);var e=i.prototype;function i(){var e;return(e=t.call(this)||this).scene=void 0,e.callback=ie,e.wrappedBodies=[],e.ccts=[],e.controllerManager=void 0,e._isNeedFetch=!1,e._debugLineCount=0,e._MAX_DEBUG_LINE_COUNT=16384,e._debugDrawFlags=x.NONE,e._debugConstraintSize=.3,Rt(h(e)),e}return e.setAllowSleep=function(){},e.setDefaultMaterial=function(){},e.setGravity=function(t){this.scene.setGravity(t)},e.destroy=function(){this.wrappedBodies.length&&o("You should destroy all physics component first."),this.scene.release()},e.step=function(t){if(0!==this.wrappedBodies.length){if(this._simulate(t),!J.MULTI_THREAD){this._fetchResults();for(var e=0;e<this.wrappedBodies.length;e++)this.wrappedBodies[e].syncPhysicsToScene()}this._debugDraw()}},e._simulate=function(t){var e;this._isNeedFetch||(e=t,this.scene.simulate(e,!0),this._isNeedFetch=!0)},e._fetchResults=function(){this._isNeedFetch&&(this.scene.fetchResults(!0),this._isNeedFetch=!1)},e.syncSceneToPhysics=function(){for(var t=0;t<this.wrappedBodies.length;t++)this.wrappedBodies[t].syncSceneToPhysics();for(var e=this.ccts,i=e.length,n=0;n<i;n++)e[n].syncSceneToPhysics()},e.syncPhysicsToScene=function(){this._fetchResults();for(var t=0;t<this.wrappedBodies.length;t++)this.wrappedBodies[t].syncPhysicsToScene()},e.syncAfterEvents=function(){for(var t=0;t<this.wrappedBodies.length;t++)this.wrappedBodies[t].syncSceneWithCheck()},e._setDebugDrawMode=function(){this._debugDrawFlags&x.WIRE_FRAME?this.scene.setVisualizationParameter(J.PxVisualizationParameter.eCOLLISION_SHAPES,1):this.scene.setVisualizationParameter(J.PxVisualizationParameter.eCOLLISION_SHAPES,0);var t=Boolean(this._debugDrawFlags&x.CONSTRAINT)?this._debugConstraintSize:0;this.scene.setVisualizationParameter(J.PxVisualizationParameter.eJOINT_LOCAL_FRAMES,t),this.scene.setVisualizationParameter(J.PxVisualizationParameter.eJOINT_LIMITS,t),this._debugDrawFlags&x.AABB?this.scene.setVisualizationParameter(J.PxVisualizationParameter.eCOLLISION_AABBS,1):this.scene.setVisualizationParameter(J.PxVisualizationParameter.eCOLLISION_AABBS,0)},e._getDebugRenderer=function(){var t,e=null==(t=I.root.mainWindow)?void 0:t.cameras;return e?0===e.length?null:e[0]?(e[0].initGeometryRenderer(),e[0].geometryRenderer):null:null},e._debugDraw=function(){if(this._getDebugRenderer()){this._debugLineCount=0;for(var t=this.scene.getRenderBufferPtr(),e=J.PxRenderBuffer_GetNbLines(t),i=0;i<e;i++){var n=J.PxRenderBuffer_GetLineAt(t,i);this._onDebugDrawLine(n)}for(var s=J.PxRenderBuffer_GetNbTriangles(t),o=0;o<s;o++){var r=J.PxRenderBuffer_GetTriangleAt(t,o);this._onDebugDrawTriangle(r)}}},e._onDebugDrawLine=function(t){var e=this._getDebugRenderer();if(e&&this._debugLineCount<this._MAX_DEBUG_LINE_COUNT){this._debugLineCount++;var i=J.HEAPF32.subarray(t/4,t/4+24),n=J.HEAPU32.subarray(t/4,t/4+24);kt.x=i[0],kt.y=i[1],kt.z=i[2];var s=n[3];Vt.x=i[4],Vt.y=i[5],Vt.z=i[6],it(Ut,s),e.addLine(kt,Vt,Ut)}},e._onDebugDrawTriangle=function(t){var e=this._getDebugRenderer();if(e&&this._MAX_DEBUG_LINE_COUNT-this._debugLineCount>=3){this._debugLineCount+=3;var i=J.HEAPF32.subarray(t/4,t/4+36),n=J.HEAPU32.subarray(t/4,t/4+36);kt.x=i[0],kt.y=i[1],kt.z=i[2];var s=n[3];Vt.x=i[4],Vt.y=i[5],Vt.z=i[6],Yt.x=i[8],Yt.y=i[9],Yt.z=i[10],it(Ut,s),e.addLine(kt,Vt,Ut),e.addLine(Vt,Yt,Ut),e.addLine(Yt,kt,Ut)}},e.getSharedBody=function(t,e){return Mt.getSharedBody(t,this,e)},e.addActor=function(t){this.wrappedBodies.indexOf(t)<0&&(ct(this.scene,t.impl),this.wrappedBodies.push(t))},e.removeActor=function(t){var e=this.wrappedBodies.indexOf(t);e>=0&&(this.scene.removeActor(t.impl,!0),r(this.wrappedBodies,e))},e.addCCT=function(t){this.ccts.indexOf(t)<0&&this.ccts.push(t)},e.removeCCT=function(t){var e=this.ccts.indexOf(t);e>=0&&r(this.ccts,e)},e.addConstraint=function(){},e.removeConstraint=function(){},e.raycast=function(t,e,i,n){return vt(this,t,e,i,n)},e.raycastClosest=function(t,e,i){return wt(this,t,e,i)},e.sweepBox=function(t,e,n,s,o,r){return i._sweepBoxGeometry||(i._sweepBoxGeometry=new J.BoxGeometry(e)),i._sweepBoxGeometry.setHalfExtents(e),Dt(this,t,i._sweepBoxGeometry,n,s,o,r)},e.sweepBoxClosest=function(t,e,n,s,o){return i._sweepBoxGeometry||(i._sweepBoxGeometry=new J.BoxGeometry(e)),i._sweepBoxGeometry.setHalfExtents(e),At(this,t,i._sweepBoxGeometry,n,s,o)},e.sweepSphere=function(t,e,n,s,o){return i._sweepSphereGeometry||(i._sweepSphereGeometry=new J.SphereGeometry(e)),i._sweepSphereGeometry.setRadius(e),Dt(this,t,i._sweepSphereGeometry,p.IDENTITY,n,s,o)},e.sweepSphereClosest=function(t,e,n,s){return i._sweepSphereGeometry||(i._sweepSphereGeometry=new J.SphereGeometry(e)),i._sweepSphereGeometry.setRadius(e),At(this,t,i._sweepSphereGeometry,p.IDENTITY,n,s)},e.sweepCapsule=function(t,e,n,s,o,r,a){i._sweepCapsuleGeometry||(i._sweepCapsuleGeometry=new J.CapsuleGeometry(e,n/2)),i._sweepCapsuleGeometry.setRadius(e),i._sweepCapsuleGeometry.setHalfHeight(n/2);var l=Ht;return p.fromEuler(l,0,0,90),p.multiply(l,s,l),Dt(this,t,i._sweepCapsuleGeometry,l,o,r,a)},e.sweepCapsuleClosest=function(t,e,n,s,o,r){i._sweepCapsuleGeometry||(i._sweepCapsuleGeometry=new J.CapsuleGeometry(e,n/2)),i._sweepCapsuleGeometry.setRadius(e),i._sweepCapsuleGeometry.setHalfHeight(n/2);var a=Ht;return p.fromEuler(a,0,0,90),p.multiply(a,s,a),At(this,t,i._sweepCapsuleGeometry,a,o,r)},e.emitEvents=function(){ie.emitTriggerEvent(),ie.emitCollisionEvent(),ie.emitCCTCollisionEvent(),ie.emitCCTTriggerEvent()},a(i,[{key:"impl",get:function(){return this.scene}},{key:"debugDrawFlags",get:function(){return this._debugDrawFlags},set:function(t){this._debugDrawFlags=t,this._setDebugDrawMode()}},{key:"debugDrawConstraintSize",get:function(){return this._debugConstraintSize},set:function(t){this._debugConstraintSize=t,this._setDebugDrawMode()}}]),i}($);zt._sweepBoxGeometry=void 0,zt._sweepSphereGeometry=void 0,zt._sweepCapsuleGeometry=void 0;var Xt=new H,Kt=new H,$t=[],Jt=new H,Wt=[],qt=[],Qt=new H,jt=new n,Zt=new H,te=new H,ee=[],ie={eventCallback:{onContactBegin:function(t,e,i,n,s){var o=rt(t),r=rt(e);ie.onCollision("onCollisionEnter",o,r,i,n,s)},onContactEnd:function(t,e,i,n,s){var o=rt(t),r=rt(e);ie.onCollision("onCollisionExit",o,r,i,n,s)},onContactPersist:function(t,e,i,n,s){var o=rt(t),r=rt(e);ie.onCollision("onCollisionStay",o,r,i,n,s)},onTriggerBegin:function(t,e){var i=rt(t),n=rt(e);i instanceof xt&&n instanceof xt?ie.onTrigger("onTriggerEnter",i,n,!0):i instanceof xt&&n instanceof Gt?ie.onTriggerCCT("onControllerTriggerEnter",i,n,!0):i instanceof Gt&&n instanceof xt&&ie.onTriggerCCT("onControllerTriggerEnter",n,i,!0)},onTriggerEnd:function(t,e){var i=rt(t),n=rt(e);i instanceof xt&&n instanceof xt?ie.onTrigger("onTriggerExit",i,n,!1):i instanceof xt&&n instanceof Gt?ie.onTriggerCCT("onControllerTriggerExit",i,n,!1):i instanceof Gt&&n instanceof xt&&ie.onTriggerCCT("onControllerTriggerExit",n,i,!1)}},queryCallback:{preFilter:function(t,e){var i=t.word3,n=e.getFlags();return i&V.QUERY_CHECK_TRIGGER&&n.isSet(J.ShapeFlag.eTRIGGER_SHAPE)?J.QueryHitType.eNONE:i&V.QUERY_SINGLE_HIT?J.QueryHitType.eBLOCK:J.QueryHitType.eTOUCH},preFilterForByteDance:function(t,e){var i=t.word3;return i&V.QUERY_CHECK_TRIGGER&&e&J.ShapeFlag.eTRIGGER_SHAPE?J.QueryHitType.eNONE:i&V.QUERY_SINGLE_HIT?J.QueryHitType.eBLOCK:J.QueryHitType.eTOUCH}},onTrigger:function(t,e,i,n){var s;e&&i&&(e.collider.needTriggerEvent||i.collider.needTriggerEvent)&&($t.length>0?((s=$t.pop()).a=e,s.b=i,s.times=0):s={a:e,b:i,times:0},n?Xt.set(e.id,i.id,s):Kt.set(e.id,i.id,s))},onTriggerCCT:function(t,e,i,n){var s;e&&i&&e.collider.needTriggerEvent&&(ee.length>0?((s=ee.pop()).a=e,s.b=i,s.times=0):s={a:e,b:i,times:0},n?Zt.set(e.id,i.id,s):te.set(e.id,i.id,s))},emitTriggerEvent:function(){for(var t=Kt.getLength();t--;){var e=Kt.getKeyByIndex(t),i=Kt.getDataByKey(e);$t.push(i);var n=Xt.getDataByKey(e);n&&($t.push(n),Xt.set(i.a.id,i.b.id,null));var s=i.a.collider,o=i.b.collider;if(s&&o){var r="onTriggerExit";v.type=r,s.needTriggerEvent&&(v.selfCollider=s,v.otherCollider=o,s.emit(r,v)),o.needTriggerEvent&&(v.selfCollider=o,v.otherCollider=s,o.emit(r,v))}}for(Kt.reset(),t=Xt.getLength();t--;){var a=Xt.getKeyByIndex(t),l=Xt.getDataByKey(a),c=l.a.collider,h=l.b.collider;if(c&&c.isValid&&h&&h.isValid){var d=l.times++?"onTriggerStay":"onTriggerEnter";v.type=d,c.needTriggerEvent&&(v.selfCollider=c,v.otherCollider=h,c.emit(d,v)),h.needTriggerEvent&&(v.selfCollider=h,v.otherCollider=c,h.emit(d,v))}else $t.push(l),Xt.set(l.a.id,l.b.id,null)}},onCollision:function(t,e,i,n,s,o){if(e&&i&&(e.collider.needCollisionEvent||i.collider.needCollisionEvent))if(Wt.length>0){var r=Wt.pop();r.type=t,r.a=e,r.b=i,r.contactCount=n,r.buffer=s,r.offset=o,Jt.set(e.id,i.id,r)}else{var a={type:t,a:e,b:i,contactCount:n,buffer:s,offset:o};Jt.set(e.id,i.id,a)}},emitCollisionEvent:function(){for(var t=Jt.getLength();t--;){var e=Jt.getKeyByIndex(t),i=Jt.getDataByKey(e);Wt.push(i);var n=i.a.collider,s=i.b.collider;if(n&&n.isValid&&s&&s.isValid){w.type=i.type,w.impl=i.buffer;var o=i.contactCount;i.buffer;var r=i.offset,a=w.contacts;qt.push.apply(qt,a),a.length=0;for(var l=0;l<o;l++)if(qt.length>0){var c=qt.pop();c.colliderA=n,c.colliderB=s,c.impl=It(l,r),a.push(c)}else{var h=new Ot(w);h.colliderA=n,h.colliderB=s,h.impl=It(l,r),a.push(h)}n.needCollisionEvent&&(w.selfCollider=n,w.otherCollider=s,n.emit(w.type,w)),s.needCollisionEvent&&(w.selfCollider=s,w.otherCollider=n,s.emit(w.type,w))}}Jt.reset()},controllerHitReportCB:{onShapeHit:function(t){var e=rt(t.getCurrentController()),i=rt(t.getTouchedShape()),n=Qt.get(t.getCurrentController(),t.getTouchedShape());if(!n){var s=new u;s.set(t.worldPos.x,t.worldPos.y,t.worldPos.z);var o=new u;o.set(t.worldNormal.x,t.worldNormal.y,t.worldNormal.z);var r=new u;r.set(t.dir.x,t.dir.y,t.dir.z);var a=t.length;n=Qt.set(t.getCurrentController(),t.getTouchedShape(),{PhysXCharacterController:e,PhysXShape:i,worldPos:s,worldNormal:o,motionDir:r,motionLength:a})}},onControllerHit:function(){}},emitCCTCollisionEvent:function(){for(var t=Qt.getLength();t--;){var e=Qt.getKeyByIndex(t),i=Qt.getDataByKey(e),n=i.PhysXCharacterController.characterController,s=i.PhysXShape.collider;n&&n.isValid&&s&&s.isValid&&(jt.controller=n,jt.collider=s,jt.worldPosition.set(i.worldPos),jt.worldNormal.set(i.worldNormal),jt.motionDirection.set(i.motionDir),jt.motionLength=i.motionLength,n.emit("onControllerColliderHit",jt))}Qt.reset()},emitCCTTriggerEvent:function(){for(var t=te.getLength();t--;){var e=te.getKeyByIndex(t),i=te.getDataByKey(e);ee.push(i);var n=Zt.getDataByKey(e);n&&(ee.push(n),Zt.set(i.a.id,i.b.id,null));var s=i.a.collider,o=i.b.characterController;if(s&&o){var r="onControllerTriggerExit";D.type=r,s.needTriggerEvent&&(D.collider=s,D.characterController=o,s.emit(r,D)),o.needTriggerEvent&&(D.collider=s,D.characterController=o,o.emit(r,D))}}for(te.reset(),t=Zt.getLength();t--;){var a=Zt.getKeyByIndex(t),l=Zt.getDataByKey(a),c=l.a.collider,h=l.b.characterController;if(c&&c.isValid&&h&&h.isValid){var d=l.times++?"onControllerTriggerStay":"onControllerTriggerEnter";D.type=d,c.needTriggerEvent&&(D.collider=c,D.characterController=h,c.emit(d,D)),h.needTriggerEvent&&(D.collider=c,D.characterController=h,h.emit(d,D))}else ee.push(l),Zt.set(l.a.id,l.b.id,null)}}},ne=new u,se=function(){function t(){this.isSleepy=!1,this._isEnabled=!1,this._isUsingCCD=!1,this._rigidBody=void 0,this._sharedBody=void 0}var e=t.prototype;return e.initialize=function(t){this._rigidBody=t,this._sharedBody=i.instance.physicsWorld.getSharedBody(t.node,this),this._sharedBody.reference=!0,this.setSleepThreshold(i.instance.sleepThreshold)},e.onEnable=function(){this._isEnabled=!0,this.setMass(this._rigidBody.mass),this.setType(this._rigidBody.type),this.setAllowSleep(this._rigidBody.allowSleep),this.setLinearDamping(this._rigidBody.linearDamping),this.setAngularDamping(this._rigidBody.angularDamping),this.setLinearFactor(this._rigidBody.linearFactor),this.setAngularFactor(this._rigidBody.angularFactor),this.useGravity(this._rigidBody.useGravity),this._sharedBody.enabled=!0},e.onDisable=function(){this._isEnabled=!1,this._sharedBody.enabled=!1},e.onDestroy=function(){this._sharedBody.reference=!1,this._rigidBody=null,this._sharedBody=null},e.setType=function(t){this._sharedBody.setType(t)},e.setMass=function(t){this.isStatic||this._sharedBody.setMass(t)},e.setLinearDamping=function(t){this._sharedBody.setLinearDamping(t)},e.setAngularDamping=function(t){this._sharedBody.setAngularDamping(t)},e.useGravity=function(t){this.isStatic||this.impl.setActorFlag(J.ActorFlag.eDISABLE_GRAVITY,!t)},e.useCCD=function(t){this.isStatic||(this.impl.setRigidBodyFlag(J.RigidBodyFlag.eENABLE_CCD,t),this._isUsingCCD=t)},e.isUsingCCD=function(){return this._isUsingCCD},e.setLinearFactor=function(t){this.isStatic||(this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_X,!t.x),this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_Y,!t.y),this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_LINEAR_Z,!t.z))},e.setAngularFactor=function(t){this.isStatic||(this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_X,!t.x),this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_Y,!t.y),this.impl.setRigidDynamicLockFlag(J.RigidDynamicLockFlag.eLOCK_ANGULAR_Z,!t.z))},e.setAllowSleep=function(t){if(!this.isStaticOrKinematic){var e=t?1e-4:4294967295;this.impl.setWakeCounter(e)}},e.wakeUp=function(){this.isInScene&&!this.isStatic&&this.impl.wakeUp()},e.sleep=function(){this.isInScene&&!this.isStatic&&this.impl.putToSleep()},e.clearState=function(){this.isInScene&&!this.isStatic&&(this.clearForces(),this.clearVelocity())},e.clearForces=function(){this.isInScene&&!this.isStatic&&this._sharedBody.clearForces()},e.clearVelocity=function(){this.isStatic||this._sharedBody.clearVelocity()},e.setSleepThreshold=function(t){if(!this.isStatic){var e=.5*t*t;this.impl.setSleepThreshold(e)}},e.getSleepThreshold=function(){if(this.isStatic)return 0;var t=this.impl.getSleepThreshold();return Math.sqrt(2*t)},e.getLinearVelocity=function(t){this.isStatic||u.copy(t,this.impl.getLinearVelocity())},e.setLinearVelocity=function(t){this.isStaticOrKinematic||this.impl.setLinearVelocity(t,!0)},e.getAngularVelocity=function(t){this.isStatic||u.copy(t,this.impl.getAngularVelocity())},e.setAngularVelocity=function(t){this.isStaticOrKinematic||this.impl.setAngularVelocity(t,!0)},e.applyForce=function(t,e){if(this.isInScene&&!this.isStaticOrKinematic){this._sharedBody.syncSceneToPhysics();var i=e||u.ZERO;ft(!0,this.impl,t,i)}},e.applyLocalForce=function(t,e){if(this.isInScene&&!this.isStaticOrKinematic){this._sharedBody.syncSceneToPhysics();var i=e||u.ZERO;ft(!1,this.impl,t,i)}},e.applyImpulse=function(t,e){if(this.isInScene&&!this.isStaticOrKinematic){this._sharedBody.syncSceneToPhysics();var i=e||u.ZERO;mt(!0,this.impl,t,i)}},e.applyLocalImpulse=function(t,e){if(this.isInScene&&!this.isStaticOrKinematic){this._sharedBody.syncSceneToPhysics();var i=e||u.ZERO;mt(!1,this.impl,t,i)}},e.applyTorque=function(t){this.isInScene&&!this.isStaticOrKinematic&&yt(this.impl,t)},e.applyLocalTorque=function(t){this.isInScene&&!this.isStaticOrKinematic&&(this._sharedBody.syncSceneToPhysics(),u.transformQuat(ne,t,this._sharedBody.node.worldRotation),yt(this.impl,ne))},e.setGroup=function(t){this._sharedBody.setGroup(t)},e.getGroup=function(){return this._sharedBody.getGroup()},e.addGroup=function(t){this._sharedBody.addGroup(t)},e.removeGroup=function(t){this._sharedBody.removeGroup(t)},e.setMask=function(t){this._sharedBody.setMask(t)},e.getMask=function(){return this._sharedBody.getMask()},e.addMask=function(t){this._sharedBody.addMask(t)},e.removeMask=function(t){this._sharedBody.removeMask(t)},a(t,[{key:"impl",get:function(){return this._sharedBody.impl}},{key:"isAwake",get:function(){return!(!this.isInScene||this.isStatic||this.impl.isSleeping())}},{key:"isSleeping",get:function(){return!(this.isInScene&&!this.isStatic)||this.impl.isSleeping()}},{key:"isEnabled",get:function(){return this._isEnabled}},{key:"rigidBody",get:function(){return this._rigidBody}},{key:"sharedBody",get:function(){return this._sharedBody}},{key:"isStatic",get:function(){return!this.impl||this._sharedBody.isStatic}},{key:"isStaticOrKinematic",get:function(){return!this.impl||this._sharedBody.isStatic||this._sharedBody.isKinematic}},{key:"isInScene",get:function(){return this._sharedBody.isInScene}}]),t}(),oe=function(t){function e(){var i;return i=t.call(this,Ft.SPHERE)||this,e.SPHERE_GEOMETRY||(e.SPHERE_GEOMETRY=new J.SphereGeometry(.5)),i}c(e,t);var i=e.prototype;return i.updateRadius=function(){this.updateScale()},i.onComponentSet=function(){this.updateGeometry();var t=this.getSharedMaterial(this.collider.sharedMaterial);this._impl=$.physics.createShape(e.SPHERE_GEOMETRY,t,!0,this._flags)},i.updateScale=function(){this.updateGeometry(),this._impl.setGeometry(e.SPHERE_GEOMETRY),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=this.collider,i=Math.abs(f(this.collider.node.worldScale));e.SPHERE_GEOMETRY.setRadius(Math.max(1e-4,t.radius*i))},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);oe.SPHERE_GEOMETRY=void 0;var re=function(t){function e(){var i;return i=t.call(this,Ft.BOX)||this,e.BOX_GEOMETRY||(A.set(.5,.5,.5),e.BOX_GEOMETRY=new J.BoxGeometry(A)),i}c(e,t);var i=e.prototype;return i.updateSize=function(){this.updateScale()},i.onComponentSet=function(){this.updateGeometry();var t=this.getSharedMaterial(this._collider.sharedMaterial);this._impl=$.physics.createShape(e.BOX_GEOMETRY,t,!0,this._flags)},i.updateScale=function(){this.updateGeometry(),this._impl.setGeometry(e.BOX_GEOMETRY),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=this.collider,i=t.node.worldScale;A.set(t.size).multiplyScalar(.5).multiply(i),e.BOX_GEOMETRY.setHalfExtents(R(A))},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);re.BOX_GEOMETRY=void 0;var ae=function(t){function e(){var i;return i=t.call(this,Ft.CAPSULE)||this,e.CAPSULE_GEOMETRY||(e.CAPSULE_GEOMETRY=new J.CapsuleGeometry(.5,.5)),i}c(e,t);var i=e.prototype;return i.setCylinderHeight=function(){this.updateScale()},i.setDirection=function(){this.updateScale()},i.setRadius=function(){this.updateScale()},i.onComponentSet=function(){this.updateGeometry();var t=this.getSharedMaterial(this._collider.sharedMaterial);this._impl=$.physics.createShape(e.CAPSULE_GEOMETRY,t,!0,this._flags)},i.updateScale=function(){this.updateGeometry(),this._impl.setGeometry(e.CAPSULE_GEOMETRY),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=this.collider,i=t.node.worldScale,n=t.direction,s=.5,o=.5;n===N.Y_AXIS?(s=t.radius*Math.abs(y(i.x,i.z)),o=t.cylinderHeight/2*Math.abs(i.y),p.fromEuler(this._rotation,0,0,90)):n===N.X_AXIS?(s=t.radius*Math.abs(y(i.y,i.z)),o=t.cylinderHeight/2*Math.abs(i.x),p.fromEuler(this._rotation,0,0,0)):(s=t.radius*Math.abs(y(i.x,i.y)),o=t.cylinderHeight/2*Math.abs(i.z),p.fromEuler(this._rotation,0,90,0)),e.CAPSULE_GEOMETRY.setRadius(Math.max(1e-4,s)),e.CAPSULE_GEOMETRY.setHalfHeight(Math.max(1e-4,o))},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);ae.CAPSULE_GEOMETRY=void 0;var le=function(t){function e(){var i;return i=t.call(this,Ft.PLANE)||this,e.PLANE_GEOMETRY||(e.PLANE_GEOMETRY=new J.PlaneGeometry),i}c(e,t);var i=e.prototype;return i.setNormal=function(){this.setCenter()},i.setConstant=function(){this.setCenter()},i.setCenter=function(){var t=this.collider,e=et.translation,i=et.rotation;u.scaleAndAdd(e,t.center,t.normal,t.constant),p.rotationTo(i,u.UNIT_X,t.normal);var n=at(e,i);this._impl.setLocalPose(n)},i.onComponentSet=function(){var t=this.collider,i=this.getSharedMaterial(t.sharedMaterial);this._impl=$.physics.createShape(e.PLANE_GEOMETRY,i,!0,this._flags),this.setCenter()},i.updateScale=function(){this.setCenter()},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);le.PLANE_GEOMETRY=void 0;var ce=function(t){function e(){var e;return(e=t.call(this,Ft.MESH)||this).geometry=void 0,e}c(e,t);var i=e.prototype;return i.setMesh=function(t){if(t&&t.renderingSubMeshes.length>0){null!=this._impl&&(this.removeFromBody(),ot(0,this._impl),this._impl.release(),this._impl=null);var e=$.physics,i=this.collider,n=this.getSharedMaterial(i.sharedMaterial),s=xt.MESH_SCALE;s.setScale(u.ONE),s.setRotation(p.IDENTITY);var o=t.renderingSubMeshes[0].geometricInfo.positions,r=t.renderingSubMeshes[0].geometricInfo.indices;if(r instanceof Uint16Array&&(r=new Uint32Array(r)),r instanceof Uint8Array&&(r=new Uint32Array(r)),i.convex||void 0===r){if(null==J.MESH_CONVEX[t._uuid]){var a=$.cooking;J.MESH_CONVEX[t._uuid]=gt(o,a,e)}var l=J.MESH_CONVEX[t._uuid];this.geometry=new J.ConvexMeshGeometry(l,s,St(0,!0))}else{if(null==J.MESH_STATIC[t._uuid]){var c=$.cooking;J.MESH_STATIC[t._uuid]=Et(o,r,c,e)}var h=J.MESH_STATIC[t._uuid];this.geometry=new J.TriangleMeshGeometry(h,s,St(0,!1))}this.updateGeometry(),this._impl=e.createShape(this.geometry,n,!0,this._flags),this.addToBody(),st(this,this._impl)}},i.onComponentSet=function(){this.setMesh(this.collider.mesh)},i.updateScale=function(){this.updateGeometry(),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=xt.MESH_SCALE;t.setScale(this.collider.node.worldScale),t.setRotation(p.IDENTITY),this.geometry.setScale(t)},i.setMaterial=function(e){this._impl&&t.prototype.setMaterial.call(this,e)},i.setCenter=function(e){this._impl&&t.prototype.setCenter.call(this,e)},i.setAsTrigger=function(e){this._impl&&t.prototype.setAsTrigger.call(this,e)},i.setFilerData=function(e){this._impl&&t.prototype.setFilerData.call(this,e)},i.addToBody=function(){this._impl&&t.prototype.addToBody.call(this)},i.removeFromBody=function(){this._impl&&t.prototype.removeFromBody.call(this)},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt),he=function(t){function e(){return t.call(this,Ft.TERRAIN)||this}c(e,t);var i=e.prototype;return i.setTerrain=function(t){if(t&&null==this._impl){var i=$.physics,n=this.collider;if(null==J.TERRAIN_STATIC[t._uuid]){var s=$.cooking;J.TERRAIN_STATIC[t._uuid]=Tt(t,e.heightScale,s,i)}var o=J.TERRAIN_STATIC[t._uuid],r=this.getSharedMaterial(n.sharedMaterial),a=Ct(o,0,e.heightScale,t.tileSize,t.tileSize);this._impl=i.createShape(a,r,!0,this._flags),this.updateByReAdd()}},i.onComponentSet=function(){this.setTerrain(this.collider.terrain)},i.updateScale=function(){this.setCenter(this._collider.center)},i.setCenter=function(t){this._impl&&this._impl.setLocalPose(at(t,this._rotation))},i.setMaterial=function(e){this._impl&&t.prototype.setMaterial.call(this,e)},i.setAsTrigger=function(e){this._impl&&t.prototype.setAsTrigger.call(this,e)},i.setFilerData=function(e){this._impl&&t.prototype.setFilerData.call(this,e)},i.addToBody=function(){this._impl&&t.prototype.addToBody.call(this)},i.removeFromBody=function(){this._impl&&t.prototype.removeFromBody.call(this)},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);he.heightScale=1/512;var de=function(t){function e(){var e;return(e=t.call(this,Ft.CYLINDER)||this).geometry=void 0,e}c(e,t);var i=e.prototype;return i.setRadius=function(){this.updateGeometry()},i.setHeight=function(){this.updateGeometry()},i.setDirection=function(){this.updateGeometry()},i.onComponentSet=function(){var t=this.collider,i=$.physics;if(!e.CONVEX_MESH){var n=$.cooking,s=k(.5,.5,2,{radialSegments:32,heightSegments:1});e.CONVEX_MESH=gt(s.positions,n,i)}var o=xt.MESH_SCALE;o.setScale(u.ONE),o.setRotation(p.IDENTITY);var r=e.CONVEX_MESH,a=this.getSharedMaterial(t.sharedMaterial);this.geometry=new J.ConvexMeshGeometry(r,o,St(0,!0)),this.updateGeometry(),this._impl=i.createShape(this.geometry,a,!0,this._flags)},i.updateScale=function(){this.updateGeometry(),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=this.collider,e=t.radius,i=t.height,n=t.direction,s=et.translation;u.copy(s,t.node.worldScale),s.y*=Math.max(1e-4,i/2);var o=Math.max(1e-4,e/.5),r=Math.max(s.x,s.z);s.x=s.z=r*o;var a=et.rotation;switch(n){case N.X_AXIS:p.fromEuler(a,0,0,90);break;case N.Y_AXIS:default:p.copy(a,p.IDENTITY);break;case N.Z_AXIS:p.fromEuler(a,90,0,0)}var l=xt.MESH_SCALE;l.setScale(s),l.setRotation(a),this.geometry.setScale(l),p.copy(this._rotation,a)},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);de.CONVEX_MESH=void 0;var ue=function(t){function e(){var e;return(e=t.call(this,Ft.CONE)||this).geometry=void 0,e}c(e,t);var i=e.prototype;return i.setRadius=function(){this.updateGeometry()},i.setHeight=function(){this.updateGeometry()},i.setDirection=function(){this.updateGeometry()},i.onComponentSet=function(){var t=this.collider,i=$.physics;if(!e.CONVEX_MESH){var n=$.cooking,s=k(0,.5,1,{radialSegments:32,heightSegments:1});e.CONVEX_MESH=gt(s.positions,n,i)}var o=xt.MESH_SCALE;o.setScale(u.ONE),o.setRotation(p.IDENTITY);var r=e.CONVEX_MESH,a=this.getSharedMaterial(t.sharedMaterial);this.geometry=new J.ConvexMeshGeometry(r,o,St(0,!0)),this.updateGeometry(),this._impl=i.createShape(this.geometry,a,!0,this._flags)},i.updateScale=function(){this.updateGeometry(),this.setCenter(this._collider.center)},i.updateGeometry=function(){var t=this.collider,e=t.radius,i=t.height,n=t.direction,s=et.translation;u.copy(s,t.node.worldScale),s.y*=Math.max(1e-4,i/1);var o=Math.max(1e-4,e/.5),r=Math.max(s.x,s.z);s.x=s.z=r*o;var a=et.rotation;switch(n){case N.X_AXIS:p.fromEuler(a,0,0,90);break;case N.Y_AXIS:default:p.copy(a,p.IDENTITY);break;case N.Z_AXIS:p.fromEuler(a,90,0,0)}var l=xt.MESH_SCALE;l.setScale(s),l.setRotation(a),this.geometry.setScale(l),p.copy(this._rotation,a)},a(e,[{key:"collider",get:function(){return this._collider}}]),e}(xt);ue.CONVEX_MESH=void 0;var pe=function(){function t(){this._impl=void 0,this._com=void 0,this._rigidBody=void 0,this._connectedBody=null}var e=t.prototype;return e.setConnectedBody=function(t){if(this._connectedBody!==t){var e=this._connectedBody;e&&e.body.sharedBody.removeJoint(this,1);var i=this._rigidBody.body.sharedBody;if(i.removeJoint(this,0),i.addJoint(this,0),t){var n=t.body.sharedBody;ht(this._impl,i.impl,n.impl),n.addJoint(this,1)}else ht(this._impl,i.impl,null);e&&e.wakeUp(),this._connectedBody=t,this.updateScale0(),this.updateScale1()}},e.setEnableCollision=function(t){this._impl.setConstraintFlag(8,t)},e.initialize=function(t){this._com=t,this._rigidBody=t.attachedBody,this._connectedBody=t.connectedBody,this.onComponentSet(),this.setEnableCollision(this._com.enableCollision),this._impl.$$&&(J.IMPL_PTR[this._impl.$$.ptr]=this)},e.enableDebugVisualization=function(t){this.impl&&this.impl.setConstraintFlag(16,t)},e.onComponentSet=function(){},e.updateScale0=function(){},e.updateScale1=function(){},e.onEnable=function(){var t=this._rigidBody.body.sharedBody,e=this._com.connectedBody;if(t.addJoint(this,0),e){var i=e.body.sharedBody;ht(this._impl,t.impl,i.impl),i.addJoint(this,1)}else ht(this._impl,t.impl,null)},e.onDisable=function(){ht(this._impl,t.tempActor,null),this._rigidBody.body.sharedBody.removeJoint(this,0);var e=this.constraint.connectedBody;e&&e.body.sharedBody.removeJoint(this,1)},e.onDestroy=function(){this._impl.$$&&(J.IMPL_PTR[this._impl.$$.ptr]=null,delete J.IMPL_PTR[this._impl.$$.ptr]),this._impl.release(),this._com=null,this._rigidBody=null,this._connectedBody=null,this._impl=null},a(t,[{key:"impl",get:function(){return this._impl}},{key:"constraint",get:function(){return this._com}}],[{key:"tempActor",get:function(){return this._tempActor||(this._tempActor=$.physics.createRigidDynamic(nt)),this._tempActor}}]),t}();pe._tempActor=void 0;var _e=new u,me=new p,fe=new g,ye=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this)._breakForce=0,e._breakTorque=0,e}c(e,t);var i=e.prototype;return i.setBreakForce=function(){this._breakForce=this.constraint.breakForce,this._impl.setBreakForce(this._breakForce,this._breakTorque)},i.setBreakTorque=function(){this._breakTorque=this.constraint.breakTorque,this._impl.setBreakForce(this._breakForce,this._breakTorque)},i.onComponentSet=function(){this._impl=J.createFixedConstraint(pe.tempActor,nt,null,nt),this.setBreakForce(this.constraint.breakForce),this.setBreakTorque(this.constraint.breakTorque),this.updateFrame(),this.enableDebugVisualization(!0)},i.updateFrame=function(){var t=this._rigidBody.body.sharedBody,e=this.constraint.connectedBody;if(g.fromRT(fe,t.node.worldRotation,t.node.worldPosition),g.invert(fe,fe),g.getRotation(me,fe),g.getTranslation(_e,fe),this._impl.setLocalPose(0,at(_e,me)),e){var i=e.body.sharedBody;g.fromRT(fe,i.node.worldRotation,i.node.worldPosition),g.invert(fe,fe),g.getRotation(me,fe),g.getTranslation(_e,fe),this._impl.setLocalPose(1,at(_e,me))}else this._impl.setLocalPose(1,at(u.ZERO,p.IDENTITY))},i.updateScale0=function(){this.updateFrame()},i.updateScale1=function(){this.updateFrame()},a(e,[{key:"constraint",get:function(){return this._com}}]),e}(pe),ge=function(t){function e(){return t.apply(this,arguments)||this}c(e,t);var i=e.prototype;return i.setPivotA=function(){var t=this.constraint,e=et.translation,i=et.rotation;u.multiply(e,t.node.worldScale,t.pivotA),p.copy(i,p.IDENTITY),this._impl.setLocalPose(0,at(e,i)),t.connectedBody||this.setPivotB(t.pivotB)},i.setPivotB=function(){var t=this.constraint,e=t.connectedBody,i=et.translation,n=et.rotation;if(u.copy(i,t.pivotB),p.copy(n,p.IDENTITY),e)u.multiply(i,e.node.worldScale,t.pivotB);else{var s=t.node;u.multiply(i,s.worldScale,t.pivotA),u.transformQuat(i,i,s.worldRotation),u.add(i,i,s.worldPosition),p.multiply(n,n,s.worldRotation)}this._impl.setLocalPose(1,at(i,n))},i.onComponentSet=function(){this._impl=J.createSphericalJoint(pe.tempActor,nt,null,nt),this.setPivotA(this.constraint.pivotA),this.setPivotB(this.constraint.pivotB),this.enableDebugVisualization(!0)},i.updateScale0=function(){this.setPivotA(this.constraint.pivotA)},i.updateScale1=function(){this.setPivotB(this.constraint.pivotB)},a(e,[{key:"constraint",get:function(){return this._com}}]),e}(pe),Se=new u,Ee=new u,Te=new u,Ce=new p,ve=new g,we=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this)._limitPair=new J.PxJointAngularLimitPair(0,0),e}c(e,t);var i=e.prototype;return i.setLimitEnabled=function(t){this._impl.setRevoluteJointFlag(J.RevoluteJointFlags.eLIMIT_ENABLED,t),t&&this._impl.setLimit(this._limitPair)},i.setLowerLimit=function(){this._limitPair.lower=S(this.constraint.lowerLimit),this.constraint.limitEnabled&&this._impl.setLimit(this._limitPair)},i.setUpperLimit=function(){this._limitPair.upper=S(this.constraint.upperLimit),this.constraint.limitEnabled&&this._impl.setLimit(this._limitPair)},i.setMotorEnabled=function(t){this._impl.setRevoluteJointFlag(J.RevoluteJointFlags.eDRIVE_ENABLED,t),t&&(this._impl.setDriveVelocity(this.constraint.motorVelocity/60,!0),this._impl.setDriveForceLimit(this.constraint.motorForceLimit))},i.setMotorVelocity=function(t){this.constraint.motorEnabled&&this._impl.setDriveVelocity(t/60,!0)},i.setMotorForceLimit=function(t){this.constraint.motorEnabled&&this._impl.setDriveForceLimit(t)},i.setPivotA=function(){this.updateFrames()},i.setPivotB=function(){this.updateFrames()},i.setAxis=function(){this.updateFrames()},i.onComponentSet=function(){this._impl=J.createRevoluteJoint(pe.tempActor,nt,null,nt),this._limitPair.stiffness=0,this._limitPair.damping=0,this._limitPair.restitution=.4,this._limitPair.contactDistance=.01,this._impl.setConstraintFlag(6,!0),this._impl.setConstraintFlag(32,!0),this._impl.setProjectionAngularTolerance(.2),this._impl.setProjectionLinearTolerance(.2),this.setPivotA(this.constraint.pivotA),this.setPivotB(this.constraint.pivotB),this.setLimitEnabled(this.constraint.limitEnabled),this.setMotorEnabled(this.constraint.motorEnabled),this.setLowerLimit(this.constraint.lowerLimit),this.setUpperLimit(this.constraint.upperLimit),this.setMotorVelocity(this.constraint.motorVelocity),this.setMotorForceLimit(this.constraint.motorForceLimit),this.updateFrames(),this.enableDebugVisualization(!0)},i.updateFrames=function(){var t=this.constraint,e=t.connectedBody,i=et.translation,n=et.rotation,s=t.node;u.normalize(Se,t.axis),u.cross(Te,Se,u.UNIT_Y),u.len(Te)<1e-4?(u.cross(Ee,u.UNIT_Z,Se),u.cross(Te,Se,Ee)):u.cross(Ee,Te,Se),u.normalize(Ee,Ee),u.normalize(Te,Te),ve.set(Se.x,Se.y,Se.z,0,Ee.x,Ee.y,Ee.z,0,Te.x,Te.y,Te.z,0,0,0,0,1),ve.getRotation(Ce),u.multiply(i,t.node.worldScale,t.pivotA),this._impl.setLocalPose(0,at(i,Ce)),e?(p.multiply(Ce,s.worldRotation,Ce),p.invert(n,e.node.worldRotation),p.multiply(Ce,n,Ce),u.multiply(i,e.node.worldScale,t.pivotB)):(p.multiply(Ce,s.worldRotation,Ce),u.multiply(i,s.worldScale,t.pivotA),u.transformQuat(i,i,s.worldRotation),u.add(i,i,s.worldPosition)),this._impl.setLocalPose(1,at(i,Ce))},i.updateScale0=function(){this.updateFrames()},i.updateScale1=function(){this.updateFrames()},a(e,[{key:"constraint",get:function(){return this._com}}]),e}(pe),De=new u,Ae=new u,Re=new p,Le=new g;function Pe(t){switch(t){case b.FREE:return J.D6Motion.eFREE;case b.LIMITED:return J.D6Motion.eLIMITED;case b.LOCKED:return J.D6Motion.eLOCKED;default:return J.D6Motion.eFREE}}var Ie=function(t){function e(){return t.apply(this,arguments)||this}c(e,t);var i=e.prototype;return i._setLinearLimit=function(){var t=this.constraint.linearLimitSettings,i=e._linearLimitX,n=e._linearLimitY,s=e._linearLimitZ,o=function(e){t.enableSoftConstraint?(e.stiffness=t.stiffness,e.damping=t.damping):(e.stiffness=0,e.damping=0),e.bounceThreshold=.1,e.contactDistance=.1,e.restitution=t.restitution};o(i),o(n),o(s);var r=t.lower,a=t.upper;t.xMotion===b.LIMITED&&(i.lower=r.x,i.upper=a.x,this._impl.setLinearLimit(J.D6Axis.eX,i)),t.yMotion===b.LIMITED&&(n.lower=r.y,n.upper=a.y,this._impl.setLinearLimit(J.D6Axis.eY,n)),t.zMotion===b.LIMITED&&(s.lower=r.z,s.upper=a.z,this._impl.setLinearLimit(J.D6Axis.eZ,s))},i._setSwingLimit=function(){var t=this.constraint.angularLimitSettings,i=e._swingLimit;t.enableSoftConstraintSwing?(i.stiffness=t.swingStiffness,i.damping=t.swingDamping):(i.stiffness=0,i.springDamping=0),i.yAngle=Math.PI,i.zAngle=Math.PI,i.contactDistance=.1,i.bounceThreshold=.1,i.restitution=t.swingRestitution,t.swingMotion1===b.LIMITED&&(i.yAngle=.5*S(Math.max(t.swingExtent1,1e-9)),this._impl.setSwingLimit(i)),t.swingMotion2===b.LIMITED&&(i.zAngle=.5*S(Math.max(t.swingExtent2,1e-9)),this._impl.setSwingLimit(i))},i._setTwistLimit=function(){var t=this.constraint.angularLimitSettings,i=e._twistLimit;t.enableSoftConstraintTwist?(i.stiffness=t.twistStiffness,i.damping=t.twistDamping):(i.stiffness=0,i.damping=0),i.contactDistance=.1,i.bounceThreshold=.1,i.restitution=t.twistRestitution,t.twistMotion===b.LIMITED&&(i.lower=-.5*S(Math.max(t.twistExtent,1e-9)),i.upper=.5*S(Math.max(t.twistExtent,1e-9)),this._impl.setTwistLimit(i))},i._updateDrive=function(t){var i=this,n=J.D6Axis.eX,s=G.DISABLED,o=this.constraint,r=o.linearDriverSettings,a=o.angularDriverSettings;switch(t){case 0:n=J.D6Drive.eX,s=r.xDrive;break;case 1:n=J.D6Drive.eY,s=r.yDrive;break;case 2:n=J.D6Drive.eZ,s=r.zDrive;break;case 3:n=J.D6Drive.eTWIST,s=a.twistDrive;break;case 4:case 5:n=J.D6Drive.eSWING,s=function(){var t=i.constraint.angularDriverSettings;return t.swingDrive1===G.INDUCTION||t.swingDrive2===G.INDUCTION?G.INDUCTION:t.swingDrive1===G.SERVO||t.swingDrive2===G.SERVO?G.SERVO:G.DISABLED}()}var l=e._drive[t];t>=0&&t<3?l.forceLimit=o.linearDriverSettings.strength:t<6&&(l.forceLimit=o.angularDriverSettings.strength),s===G.DISABLED?l.forceLimit=0:s===G.SERVO?(l.damping=0,l.stiffness=1e3):s===G.INDUCTION&&(l.damping=1e3,l.stiffness=0),this._impl.setDrive(n,l)},i._updateDriveTarget=function(){var t=this.constraint.linearDriverSettings.targetPosition,e=this.constraint.angularDriverSettings.targetOrientation;at(t,p.fromEuler(Re,e.x,e.y,e.z)),this._impl.setDrivePosition(nt,!0)},i._updateDriveVelocity=function(){var t=this.constraint.linearDriverSettings.targetVelocity,e=this.constraint.angularDriverSettings.targetVelocity,i=u.set(De,t.x,t.y,t.z),n=u.set(Ae,S(-e.x),S(-e.y),S(-e.z));this._impl.setDriveVelocity(i,n,!0)},i._updateDriveSettings=function(){this._updateDrive(0),this._updateDrive(1),this._updateDrive(2),this._updateDrive(3),this._updateDrive(4),this._updateDrive(5),this._updateDriveTarget(),this._updateDriveVelocity()},i.setConstraintMode=function(t,e){var i=J.D6Axis.eX;switch(t){case 0:i=J.D6Axis.eX;break;case 1:i=J.D6Axis.eY;break;case 2:i=J.D6Axis.eZ;break;case 3:i=J.D6Axis.eTWIST;break;case 4:i=J.D6Axis.eSWING1;break;case 5:i=J.D6Axis.eSWING2}var n=Pe(e);this._impl.setMotion(i,n)},i.setLinearLimit=function(){this._setLinearLimit()},i.setAngularExtent=function(){this._setSwingLimit(),this._setTwistLimit()},i.setLinearRestitution=function(){this._setLinearLimit()},i.setSwingRestitution=function(){this._setSwingLimit()},i.setTwistRestitution=function(){this._setTwistLimit()},i.setLinearSoftConstraint=function(){this._setLinearLimit()},i.setLinearStiffness=function(){this._setLinearLimit()},i.setLinearDamping=function(){this._setLinearLimit()},i.setSwingSoftConstraint=function(){this._setSwingLimit()},i.setSwingStiffness=function(){this._setSwingLimit()},i.setSwingDamping=function(){this._setSwingLimit()},i.setTwistSoftConstraint=function(){this._setTwistLimit()},i.setTwistStiffness=function(){this._setTwistLimit()},i.setTwistDamping=function(){this._setTwistLimit()},i.setDriverMode=function(t){this._updateDrive(t)},i.setLinearMotorTarget=function(){this._updateDriveTarget()},i.setLinearMotorVelocity=function(){this._updateDriveVelocity()},i.setLinearMotorForceLimit=function(){this._updateDrive(0),this._updateDrive(1),this._updateDrive(2)},i.setAngularMotorTarget=function(){this._updateDriveTarget()},i.setAngularMotorVelocity=function(){this._updateDriveVelocity()},i.setAngularMotorForceLimit=function(){this._updateDrive(3),this._updateDrive(4),this._updateDrive(5)},i.setPivotA=function(){this.updateFrames()},i.setPivotB=function(){this.updateFrames()},i.setAutoPivotB=function(){this.updateFrames()},i.setAxis=function(){this.updateFrames()},i.setSecondaryAxis=function(){this.updateFrames()},i.setBreakForce=function(){var t=this.constraint.breakForce,e=this.constraint.breakTorque;this._impl.setBreakForce(t,e)},i.setBreakTorque=function(){var t=this.constraint.breakForce,e=this.constraint.breakTorque;this._impl.setBreakForce(t,e)},i.onComponentSet=function(){e._initCache();var t=this.constraint;this._impl=J.createD6Joint(pe.tempActor,nt,null,nt),this.setBreakForce(t.breakForce),this.setBreakTorque(t.breakTorque);var i=t.linearLimitSettings,n=t.angularLimitSettings;this.setConstraintMode(0,i.xMotion),this.setConstraintMode(1,i.yMotion),this.setConstraintMode(2,i.zMotion),this.setConstraintMode(3,n.twistMotion),this.setConstraintMode(4,n.swingMotion1),this.setConstraintMode(5,n.swingMotion2),this._setLinearLimit(),this._setSwingLimit(),this._setTwistLimit(),this._updateDriveSettings(),this.updateFrames(),this.enableDebugVisualization(!0)},i.updateFrames=function(){var t=this.constraint,e=t.node,i=et.translation,n=et.rotation,s=t.connectedBody,o=t.axis,r=t.secondaryAxis,a=u.cross(De,o,r),l=Re;g.set(Le,o.x,o.y,o.z,0,r.x,r.y,r.z,0,a.x,a.y,a.z,0,0,0,0,1).getRotation(l),u.multiply(i,t.node.worldScale,t.pivotA),this._impl.setLocalPose(0,at(i,l)),s?(p.multiply(l,e.worldRotation,l),p.invert(n,s.node.worldRotation),p.multiply(l,n,l),t.autoPivotB?(u.multiply(i,t.node.worldScale,t.pivotA),u.transformQuat(i,i,e.worldRotation),u.add(i,i,e.worldPosition),u.subtract(i,i,s.node.worldPosition),u.transformQuat(i,i,n)):u.multiply(i,s.node.worldScale,t.pivotB)):(u.multiply(i,e.worldScale,t.pivotA),u.transformQuat(i,i,e.worldRotation),u.add(i,i,e.worldPosition),p.multiply(l,e.worldRotation,l)),this._impl.setLocalPose(1,at(i,l))},i.updateScale0=function(){this.updateFrames()},i.updateScale1=function(){this.updateFrames()},e._initCache=function(){e._jointToleranceScale||(e._jointToleranceScale=$.physics.getTolerancesScale(),e._linearLimitX=new J.PxJointLinearLimitPair(e._jointToleranceScale,0,0),e._linearLimitY=new J.PxJointLinearLimitPair(e._jointToleranceScale,0,0),e._linearLimitZ=new J.PxJointLinearLimitPair(e._jointToleranceScale,0,0),e._twistLimit=new J.PxJointAngularLimitPair(0,0),e._swingLimit=new J.PxJointLimitCone(1.5,1.5),e._drive_x=new J.D6JointDrive,e._drive_y=new J.D6JointDrive,e._drive_z=new J.D6JointDrive,e._drive_twist=new J.D6JointDrive,e._drive_swing1=new J.D6JointDrive,e._drive_swing2=new J.D6JointDrive,e._drive=[e._drive_x,e._drive_y,e._drive_z,e._drive_twist,e._drive_swing1,e._drive_swing2])},a(e,[{key:"constraint",get:function(){return this._com}}]),e}(pe);Ie._jointToleranceScale=null,Ie._linearLimitX=null,Ie._linearLimitY=null,Ie._linearLimitZ=null,Ie._twistLimit=null,Ie._swingLimit=null,Ie._drive_x=null,Ie._drive_y=null,Ie._drive_z=null,Ie._drive_twist=null,Ie._drive_swing1=null,Ie._drive_swing2=null,Ie._drive=[];var Me=new u(0,0,0),Fe=new u(0,1,0),Be=function(t){function e(){return t.apply(this,arguments)||this}c(e,t);var n=e.prototype;return n.onComponentSet=function(){this.create()},n.create=function(){t.prototype.release.call(this),this.component.node.getWorldPosition(Me),Me.add(this.scaledCenter);var e=$.physics.createMaterial(.5,.5,.5),n=i.instance.physicsWorld,s=new J.PxBoxControllerDesc;if(s.halfHeight=this.component.halfHeight,s.halfSideExtent=this.component.halfSideExtent,s.halfForwardExtent=this.component.halfForwardExtent,s.density=10,s.scaleCoeff=.8,s.volumeGrowth=1.5,s.contactOffset=this.component.skinWidth,s.stepOffset=this.component.stepOffset,s.slopeLimit=Math.cos(l(this.component.slopeLimit)),s.upDirection=Fe,s.position={x:Me.x,y:Me.y,z:Me.z},s.setMaterial(e),s.setReportCallback(J.PxUserControllerHitReport.implement(n.callback.controllerHitReportCB)),this._impl=J.createBoxCharacterController(n.controllerManager,s),this._impl.$$){J.IMPL_PTR[this._impl.$$.ptr]=this;var o=this._impl.getShape().$$.ptr;J.IMPL_PTR[o]=this}this.updateScale()},n.setHalfHeight=function(){this.updateScale()},n.setHalfSideExtent=function(){this.updateScale()},n.setHalfForwardExtent=function(){this.updateScale()},n.updateScale=function(){this.updateGeometry()},n.updateGeometry=function(){var t=this.component.node.worldScale;this._impl.setHalfSideExtent(this.component.halfSideExtent*t.x),this._impl.setHalfHeight(this.component.halfHeight*t.y),this._impl.setHalfForwardExtent(this.component.halfForwardExtent*t.z)},a(e,[{key:"component",get:function(){return this._comp}}]),e}(Gt),Oe=new u(0,0,0),xe=new u(0,1,0),Ne=function(t){function e(){return t.apply(this,arguments)||this}c(e,t);var n=e.prototype;return n.onComponentSet=function(){this.create()},n.create=function(){t.prototype.release.call(this),this.component.node.getWorldPosition(Oe),Oe.add(this.scaledCenter);var e=$.physics.createMaterial(.5,.5,.5),n=i.instance.physicsWorld,s=new J.PxCapsuleControllerDesc;if(s.radius=this.component.radius,s.height=this.component.height,s.climbingMode=J.PxCapsuleClimbingMode.eCONSTRAINED,s.density=10,s.scaleCoeff=.8,s.volumeGrowth=1.5,s.contactOffset=this.component.skinWidth,s.stepOffset=this.component.stepOffset,s.slopeLimit=Math.cos(l(this.component.slopeLimit)),s.upDirection=xe,s.position={x:Oe.x,y:Oe.y,z:Oe.z},s.setMaterial(e),s.setReportCallback(J.PxUserControllerHitReport.implement(n.callback.controllerHitReportCB)),this._impl=J.createCapsuleCharacterController(n.controllerManager,s),this._impl.$$){J.IMPL_PTR[this._impl.$$.ptr]=this;var o=this._impl.getShape().$$.ptr;J.IMPL_PTR[o]=this}this.updateScale()},n.setRadius=function(){this._impl&&this.updateScale()},n.setHeight=function(){this._impl&&this.updateScale()},n.updateScale=function(){this.updateGeometry()},n.updateGeometry=function(){var t=this.component.node.worldScale,e=this.component.radius*Math.abs(y(t.x,t.z)),i=this.component.height*Math.abs(t.y);this._impl.setRadius(Math.max(1e-4,e)),this._impl.setHeight(Math.max(1e-4,i))},a(e,[{key:"component",get:function(){return this._comp}}]),e}(Gt);L.once(P.EVENT_PRE_SUBSYSTEM_INIT,(function(){s.register("physx",{PhysicsWorld:zt,RigidBody:se,BoxShape:re,SphereShape:oe,CapsuleShape:ae,TrimeshShape:ce,CylinderShape:de,ConeShape:ue,TerrainShape:he,PlaneShape:le,PointToPointConstraint:ge,HingeConstraint:we,FixedConstraint:ye,ConfigurableConstraint:Ie,BoxCharacterController:Be,CapsuleCharacterController:Ne})}))}}}));
//# sourceMappingURL=physics-physx.js.map
