System.register(["./index-BcjqSS2q.js","./scene-D5fG1En6.js","./node-event-BDYemSfE.js","./gc-object-BD6DANSw.js","./_virtual_internal_constants-CVZmBipG.js","./global-exports-ZavlJGEN.js","./pipeline-state-manager-C4BAah3w.js","./touch-Ch03mDFP.js"],(function(t){"use strict";var e,n,i,a,o,r,s,u,c,_,h,v,d,l,f,g,T,p,E,m,I,b,R,y,S,N,O,L,w,G,C,M,A,D,U,P,H,F,k,K,x,B,V,W,Y,j,X,z,Z,$,Q,q,J,tt,et,nt,it,at,ot,rt,st,ut,ct,_t,ht,vt,dt,lt,ft,gt,Tt,pt;return{setters:[function(t){e=t.W,n=t.J,i=t.V,a=t.f,o=t.Q,r=t.l,s=t.n,u=t.r,c=t.q,_=t.A,h=t.i,v=t.c,d=t.a,l=t.s},function(t){f=t.N,g=t.ab,T=t.aB,p=t.aC,E=t.aD,m=t.aE},function(t){I=t.E,b=t.N,R=t.A},function(t){y=t.j,S=t.ab,N=t.n,O=t.Z,L=t.O,w=t.a3,G=t.F,C=t._,M=t.aA,A=t.I,D=t.a,U=t.T,P=t.z,H=t.d,F=t.w,k=t.az,K=t.a4,x=t.D,B=t.l,V=t.g,W=t.h,Y=t.G,j=t.aB,X=t.p,z=t.ao,Z=t.am,$=t.i,Q=t.e,q=t.aC,J=t.E,tt=t.v,et=t.aD},function(t){nt=t.T,it=t.E},function(t){at=t.l,ot=t.c},function(t){rt=t.L},function(t){st=t.a,ut=t.I,ct=t.e,_t=t.f,ht=t.g,vt=t.K,dt=t.b,lt=t.c,ft=t.T,gt=t.d,Tt=t.S,pt=t.E}],execute:function(){function Et(t,e){for(var n,i=y(e);!(n=i()).done;){var a=n.value;Array.isArray(a)?Et(t,a):t.push(a)}}function mt(t){var e=[];return Et(e,t),e.join("")}t({a:mt,f:fe});var It=t("A",(function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.timestamp=i}));S.Attr.setClassAttr(I,"target","type","Object"),S.Attr.setClassAttr(I,"target","ctor",f),e({SystemEventType:{newName:"Input.EventType",since:"3.3.0",removed:!1}}),e({SystemEvent:{newName:"Input",since:"3.4.0",removed:!1},systemEvent:{newName:"input",since:"3.4.0",removed:!1}});var bt=function(){function t(){this._intervalInMileSeconds=200,this._accelTimer=0,this._eventTarget=new N,this._globalEventClass=window.DeviceMotionEvent||window.DeviceOrientationEvent,O.browserType===L.MOBILE_QQ&&(this._globalEventClass=window.DeviceOrientationEvent),this._deviceEventName=this._globalEventClass===window.DeviceMotionEvent?"devicemotion":"deviceorientation",this._didAccelerateFunc=this._didAccelerate.bind(this)}var e=t.prototype;return e._registerEvent=function(){this._accelTimer=performance.now(),window.addEventListener(this._deviceEventName,this._didAccelerateFunc,!1)},e._unregisterEvent=function(){this._accelTimer=0,window.removeEventListener(this._deviceEventName,this._didAccelerateFunc,!1)},e._didAccelerate=function(t){var e=performance.now();if(!(e-this._accelTimer<this._intervalInMileSeconds)){this._accelTimer=e;var i=0,a=0,o=0;if(this._globalEventClass===window.DeviceMotionEvent){var r=t.accelerationIncludingGravity;i=.1*((null==r?void 0:r.x)||0),a=.1*((null==r?void 0:r.y)||0),o=.1*((null==r?void 0:r.z)||0)}else{var s=t;i=(s.gamma||0)/90*.981,a=-(s.beta||0)/90*.981,o=(s.alpha||0)/90*.981}if(n.isFrameRotated){var u=i;i=-a,a=u}var c=i;90===window.orientation?(i=-a,a=c):-90===window.orientation?(i=a,a=-c):180===window.orientation&&(i=-i,a=-a),O.os===w.ANDROID&&O.browserType!==L.MOBILE_QQ&&(i=-i,a=-a);var _=performance.now(),h=new It(i,a,o,_),v=new st(h);this._eventTarget.emit(ut.DEVICEMOTION,v)}},e.start=function(){var t=this;window.DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){"granted"===e&&t._registerEvent()})).catch((function(t){G(t)})):this._registerEvent()},e.stop=function(){this._unregisterEvent()},e.setInterval=function(t){this._intervalInMileSeconds=t},e.on=function(t,e,n){this._eventTarget.on(t,e,n)},t}(),Rt=function(){},yt=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){throw new Error("Method not implemented.")},e}(Rt),St=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){throw new Error("Method not implemented.")},e}(Rt),Nt=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){throw new Error("Method not implemented.")},e}(Rt),Ot=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){throw new Error("Method not implemented.")},e}(Rt),Lt=function(t){function e(e){var n;return(n=t.call(this)||this).positive=e.positive,n.negative=e.negative,n}return C(e,t),e.prototype.getValue=function(){var t=this.positive.getValue(),e=this.negative.getValue();return Math.abs(t)>Math.abs(e)?t:-e},e}(yt),wt=function(t){function e(e){var n;return(n=t.call(this)||this).up=e.up,n.down=e.down,n.left=e.left,n.right=e.right,n.xAxis=new Lt({positive:n.right,negative:n.left}),n.yAxis=new Lt({positive:n.up,negative:n.down}),n}return C(e,t),e.prototype.getValue=function(){return new i(this.xAxis.getValue(),this.yAxis.getValue())},e}(St);!function(t){function e(e){var n;return(n=t.call(this)||this).up=e.up,n.down=e.down,n.left=e.left,n.right=e.right,n.forward=e.forward,n.backward=e.backward,n.xAxis=new Lt({positive:n.right,negative:n.left}),n.yAxis=new Lt({positive:n.up,negative:n.down}),n.zAxis=new Lt({positive:n.forward,negative:n.backward}),n}C(e,t),e.prototype.getValue=function(){return new a(this.xAxis.getValue(),this.yAxis.getValue(),this.zAxis.getValue())}}(Nt);var Gt,Ct=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){return t.prototype.getValue.call(this)},e}(yt),Mt=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e}(wt),At=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e}(wt),Dt=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){return t.prototype.getValue.call(this)},e}(Ot),Ut=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){return t.prototype.getValue.call(this)},e}(Nt),Pt=function(t){function e(){return t.apply(this,arguments)||this}return C(e,t),e.prototype.getValue=function(){return t.prototype.getValue.call(this)},e}(yt),Ht="left",Ft="right",kt=[];!function(t){t[t.HAND_LEFT=1]="HAND_LEFT",t[t.HAND_RIGHT=4]="HAND_RIGHT",t[t.AIM_LEFT=2]="AIM_LEFT",t[t.AIM_RIGHT=5]="AIM_RIGHT"}(Gt||(Gt={}));var Kt,xt,Bt,Vt,Wt,Yt=function(){function t(t){var e;this._deviceId=-1,this._connected=!1,this._webPoseState=((e={})[Gt.HAND_LEFT]={position:a.ZERO,orientation:o.IDENTITY},e[Gt.HAND_RIGHT]={position:a.ZERO,orientation:o.IDENTITY},e[Gt.AIM_LEFT]={position:a.ZERO,orientation:o.IDENTITY},e[Gt.AIM_RIGHT]={position:a.ZERO,orientation:o.IDENTITY},e),this._deviceId=t,this._initInputSource()}t._init=function(){O.hasFeature(M.EVENT_GAMEPAD)&&t._registerEvent()},t._on=function(e,n,i){t._eventTarget.on(e,n,i)},t._removeInputDevice=function(e){var n=t.all.findIndex((function(t){return t.deviceId===e}));-1!==n&&A(t.all,n)},t._getOrCreateInputDevice=function(e,n){var i=t.all.find((function(t){return t.deviceId===e}));return i||(i=new t(e),t.all.push(i)),i._connected=n,i},t._ensureDirectorDefined=function(e){t._intervalId=setInterval((function(){at.director&&at.Director&&(clearInterval(t._intervalId),t._intervalId=-1,e())}),50)},t._updateGamepadCnt=function(){for(var e=0,n=0,i=t._cachedWebGamepads.length;n<i;n++)t._cachedWebGamepads[n]&&e++;t._totalGamepadCnt=e},t._registerEvent=function(){t._ensureDirectorDefined((function(){t._cachedWebGamepads=t._getWebGamePads(),t._updateGamepadCnt(),at.director.on(at.Director.EVENT_BEGIN_FRAME,t._scanGamepads)})),window.addEventListener("gamepadconnected",(function(e){t._cachedWebGamepads[e.gamepad.index]=e.gamepad,t._updateGamepadCnt();var n=t._getOrCreateInputDevice(e.gamepad.index,!0);t._eventTarget.emit(ut.GAMEPAD_CHANGE,new ct(ut.GAMEPAD_CHANGE,n))})),window.addEventListener("gamepaddisconnected",(function(e){t._cachedWebGamepads[e.gamepad.index]=null,t._updateGamepadCnt();var n=t._getOrCreateInputDevice(e.gamepad.index,!1);t._removeInputDevice(e.gamepad.index),t._eventTarget.emit(ut.GAMEPAD_CHANGE,new ct(ut.GAMEPAD_CHANGE,n))}))},t._scanWebGamepads=function(e){if(0!==t._totalGamepadCnt){var n=t._getWebGamePads();if(n){for(var i=0;i<n.length;++i){var a=n[i];if(a){var o=t._cachedWebGamepads[a.index];if(o){for(var r=void 0,s=o.buttons,u=0;u<s.length;++u){var c=s[u],_=a.buttons[u];if(Math.abs(c.value-_.value)>.01){r=t._getOrCreateInputDevice(a.index,!0);break}}if(r){e.push(r);continue}for(var h=o.axes,v=0;v<h.length;++v){var d=h[v],l=a.axes[v];if(Math.abs(d-l)>.01){r=t._getOrCreateInputDevice(a.index,!0);break}}if(r){e.push(r);continue}}}}t._cachedWebGamepads=n}}},t._scanGamepads=function(){kt.length=0,t._scanWebGamepads(kt),t._scanWebXRGamepads(kt);for(var e=0;e<kt.length;++e){var n=kt[e];t._eventTarget.emit(ut.GAMEPAD_INPUT,new ct(ut.GAMEPAD_INPUT,n))}t._scanWebXRGamepadsPose()},t._scanWebXRGamepads=function(e){var n,i,a=t._getWebXRGamepadMap();if(!a)return t._cachedWebXRGamepadMap=null,void(t.xr&&t.xr._connected&&(t.xr._connected=!1,t._eventTarget.emit(ut.GAMEPAD_CHANGE,new ct(ut.GAMEPAD_CHANGE,t.xr)),e.push(t.xr)));t.xr||(t.xr=new t(-1));var o=a.get(Ht),r=a.get(Ft);o||r?t.xr._connected||(t.xr._connected=!0,t._eventTarget.emit(ut.GAMEPAD_CHANGE,new ct(ut.GAMEPAD_CHANGE,t.xr))):t.xr._connected&&(t.xr._connected=!1,t._eventTarget.emit(ut.GAMEPAD_CHANGE,new ct(ut.GAMEPAD_CHANGE,t.xr))),(t.checkGamepadChanged(o,null==(n=t._cachedWebXRGamepadMap)?void 0:n.get(Ht))||t.checkGamepadChanged(r,null==(i=t._cachedWebXRGamepadMap)?void 0:i.get(Ft)))&&e.push(t.xr),t._cachedWebXRGamepadMap||(t._cachedWebXRGamepadMap=new Map),t._cachedWebXRGamepadMap.set(Ht,t._copyCacheGamepadValue(o)),t._cachedWebXRGamepadMap.set(Ft,t._copyCacheGamepadValue(r))},t.checkGamepadChanged=function(t,e){if(!t&&!e)return!1;if(!t||!e)return!0;for(var n=e.buttons,i=0;i<n.length;++i){var a=n[i];if(0!==t.buttons[i].value||0!==a)return!0}for(var o=e.axes,r=0;r<o.length;++r){var s=o[r];if(0!==t.axes[r]||0!==s)return!0}return!1},t._copyCacheGamepadValue=function(t){if(t){for(var e={buttons:new Array(t.buttons.length),axes:new Array(t.axes.length)},n=0;n<t.buttons.length;++n)e.buttons[n]=t.buttons[n].value;for(var i=0;i<t.axes.length;++i)e.axes[i]=t.axes[i];return e}},t._scanWebXRGamepadsPose=function(){var e,n=null==(e=globalThis.__globalXR)?void 0:e.webxrHandlePoseInfos;if(n&&t.xr){for(var i=0;i<n.length;++i){var a=n[i];t.xr._updateWebPoseState(a)}t._eventTarget.emit(ut.HANDLE_POSE_INPUT,new ct(ut.HANDLE_POSE_INPUT,t.xr))}},t._getWebXRGamepadMap=function(){var t;return null==(t=globalThis.__globalXR)?void 0:t.webxrGamepadMap},t._getWebGamePads=function(){return"function"==typeof navigator.getGamepads?navigator.getGamepads():"function"==typeof navigator.webkitGetGamepads?navigator.webkitGetGamepads():[]},t._getWebGamepad=function(e){for(var n=t._getWebGamePads(),i=0;i<n.length;++i){var a=n[i];if(a&&a.index===e)return a}};var e=t.prototype;return e._axisToButtons=function(t){var e=Math.abs(t);return t>0?{negative:0,positive:e}:t<0?{negative:e,positive:0}:{negative:0,positive:0}},e._updateWebPoseState=function(t){t.code!==Gt.HAND_LEFT&&t.code!==Gt.AIM_LEFT&&t.code!==Gt.HAND_RIGHT&&t.code!==Gt.AIM_RIGHT||(this._webPoseState[t.code]={position:new a(t.position.x,t.position.y,t.position.z),orientation:new o(t.orientation.x,t.orientation.y,t.orientation.z,t.orientation.w)})},e._initInputSource=function(){var e=this;this._buttonNorth=new Ct,this._buttonNorth.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);return i&&i.buttons.length>5?i.buttons[5].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[3].value:0},this._buttonEast=new Ct,this._buttonEast.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);return i&&i.buttons.length>5?i.buttons[5].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[1].value:0},this._buttonWest=new Ct,this._buttonWest.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);return i&&i.buttons.length>4?i.buttons[4].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[2].value:0},this._buttonSouth=new Ct,this._buttonSouth.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);return i&&i.buttons.length>4?i.buttons[4].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[0].value:0},this._buttonL1=new Ct,this._buttonL1.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[4].value:0},this._buttonL2=new Ct,this._buttonL2.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);return i&&i.buttons.length>0?i.buttons[0].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[6].value:0},this._buttonL3=new Ct,this._buttonL3.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i){if(i.buttons.length>3&&0!==i.buttons[3].value)return i.buttons[3].value;if(i.buttons.length>2&&0!==i.buttons[2].value)return i.buttons[2].value}return 0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[10].value:0},this._buttonR1=new Ct,this._buttonR1.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[5].value:0},this._buttonR2=new Ct,this._buttonR2.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);return i&&i.buttons.length>0?i.buttons[0].value:0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[7].value:0},this._buttonR3=new Ct,this._buttonR3.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i){if(i.buttons.length>3&&0!==i.buttons[3].value)return i.buttons[3].value;if(i.buttons.length>2&&0!==i.buttons[2].value)return i.buttons[2].value}return 0}var a=t._getWebGamepad(e.deviceId);return a?a.buttons[11].value:0},this._buttonShare=new Ct,this._buttonShare.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[8].value:0},this._buttonOptions=new Ct,this._buttonOptions.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[9].value:0};var n=new Ct;n.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[12].value:0};var i=new Ct;i.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[13].value:0};var a=new Ct;a.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[14].value:0};var o=new Ct;o.getValue=function(){var n=t._getWebGamepad(e.deviceId);return n?n.buttons[15].value:0},this._dpad=new Mt({up:n,down:i,left:a,right:o});var r=new Ct;r.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i){if(i.axes.length>3&&0!==i.axes[3])return e._axisToButtons(i.axes[3]).negative;if(i.axes.length>1&&0!==i.axes[1])return e._axisToButtons(i.axes[1]).negative}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[1]).negative:0};var s=new Ct;s.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i){if(i.axes.length>3&&0!==i.axes[3])return e._axisToButtons(i.axes[3]).positive;if(i.axes.length>1&&0!==i.axes[1])return e._axisToButtons(i.axes[1]).positive}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[1]).positive:0};var u=new Ct;u.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i){if(i.axes.length>2&&0!==i.axes[2])return e._axisToButtons(i.axes[2]).negative;if(i.axes.length>0&&0!==i.axes[0])return e._axisToButtons(i.axes[0]).negative}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[0]).negative:0};var c=new Ct;c.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i){if(i.axes.length>2&&0!==i.axes[2])return e._axisToButtons(i.axes[2]).positive;if(i.axes.length>0&&0!==i.axes[0])return e._axisToButtons(i.axes[0]).positive}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[0]).positive:0},this._leftStick=new At({up:r,down:s,left:u,right:c});var _=new Ct;_.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i){if(i.axes.length>3&&0!==i.axes[3])return e._axisToButtons(i.axes[3]).negative;if(i.axes.length>1&&0!==i.axes[1])return e._axisToButtons(i.axes[1]).negative}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[3]).negative:0};var h=new Ct;h.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i){if(i.axes.length>3&&0!==i.axes[3])return e._axisToButtons(i.axes[3]).positive;if(i.axes.length>1&&0!==i.axes[1])return e._axisToButtons(i.axes[1]).positive}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[3]).positive:0};var v=new Ct;v.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i){if(i.axes.length>2&&0!==i.axes[2])return e._axisToButtons(i.axes[2]).negative;if(i.axes.length>0&&0!==i.axes[0])return e._axisToButtons(i.axes[0]).negative}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[2]).negative:0};var d=new Ct;d.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i){if(i.axes.length>2&&0!==i.axes[2])return e._axisToButtons(i.axes[2]).positive;if(i.axes.length>0&&0!==i.axes[0])return e._axisToButtons(i.axes[0]).positive}return 0}var a=t._getWebGamepad(e.deviceId);return a?e._axisToButtons(a.axes[2]).positive:0},this._rightStick=new At({up:_,down:h,left:v,right:d}),this._buttonStart=new Ct,this._buttonStart.getValue=function(){return 0},this._gripLeft=new Ct,this._gripLeft.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ht);if(i&&i.buttons.length>1)return i.buttons[1].value}return 0},this._gripRight=new Ct,this._gripRight.getValue=function(){if(-1===e.deviceId){var n,i=null==(n=t._getWebXRGamepadMap())?void 0:n.get(Ft);if(i&&i.buttons.length>1)return i.buttons[1].value}return 0},this._handLeftPosition=new Ut,this._handLeftPosition.getValue=function(){return e._webPoseState[Gt.HAND_LEFT].position},this._handLeftOrientation=new Dt,this._handLeftOrientation.getValue=function(){return e._webPoseState[Gt.HAND_LEFT].orientation},this._handRightPosition=new Ut,this._handRightPosition.getValue=function(){return e._webPoseState[Gt.HAND_RIGHT].position},this._handRightOrientation=new Dt,this._handRightOrientation.getValue=function(){return e._webPoseState[Gt.HAND_RIGHT].orientation},this._aimLeftPosition=new Ut,this._aimLeftPosition.getValue=function(){return e._webPoseState[Gt.AIM_LEFT].position},this._aimLeftOrientation=new Dt,this._aimLeftOrientation.getValue=function(){return e._webPoseState[Gt.AIM_LEFT].orientation},this._aimRightPosition=new Ut,this._aimRightPosition.getValue=function(){return e._webPoseState[Gt.AIM_RIGHT].position},this._aimRightOrientation=new Dt,this._aimRightOrientation.getValue=function(){return e._webPoseState[Gt.AIM_RIGHT].orientation}},D(t,[{key:"buttonNorth",get:function(){return this._buttonNorth}},{key:"buttonEast",get:function(){return this._buttonEast}},{key:"buttonWest",get:function(){return this._buttonWest}},{key:"buttonSouth",get:function(){return this._buttonSouth}},{key:"buttonL1",get:function(){return this._buttonL1}},{key:"buttonL2",get:function(){return this._buttonL2}},{key:"buttonL3",get:function(){return this._buttonL3}},{key:"buttonR1",get:function(){return this._buttonR1}},{key:"buttonR2",get:function(){return this._buttonR2}},{key:"buttonR3",get:function(){return this._buttonR3}},{key:"buttonShare",get:function(){return this._buttonShare}},{key:"buttonOptions",get:function(){return this._buttonOptions}},{key:"dpad",get:function(){return this._dpad}},{key:"leftStick",get:function(){return this._leftStick}},{key:"rightStick",get:function(){return this._rightStick}},{key:"buttonStart",get:function(){return this._buttonStart}},{key:"gripLeft",get:function(){return this._gripLeft}},{key:"gripRight",get:function(){return this._gripRight}},{key:"handLeftPosition",get:function(){return this._handLeftPosition}},{key:"handLeftOrientation",get:function(){return this._handLeftOrientation}},{key:"handRightPosition",get:function(){return this._handRightPosition}},{key:"handRightOrientation",get:function(){return this._handRightOrientation}},{key:"aimLeftPosition",get:function(){return this._aimLeftPosition}},{key:"aimLeftOrientation",get:function(){return this._aimLeftOrientation}},{key:"aimRightPosition",get:function(){return this._aimRightPosition}},{key:"aimRightOrientation",get:function(){return this._aimRightOrientation}},{key:"deviceId",get:function(){return this._deviceId}},{key:"connected",get:function(){return this._connected}}]),t}();Yt.all=[],Yt.xr=null,Yt._eventTarget=new N,Yt._cachedWebGamepads=[],Yt._cachedWebXRGamepadMap=null,Yt._intervalId=-1,Yt._totalGamepadCnt=0,function(t){t[t.BUTTON_EAST=0]="BUTTON_EAST",t[t.BUTTON_SOUTH=1]="BUTTON_SOUTH",t[t.BUTTON_WEST=2]="BUTTON_WEST",t[t.BUTTON_NORTH=3]="BUTTON_NORTH",t[t.BUTTON_TRIGGER_LEFT=4]="BUTTON_TRIGGER_LEFT",t[t.BUTTON_TRIGGER_RIGHT=5]="BUTTON_TRIGGER_RIGHT",t[t.TRIGGER_LEFT=6]="TRIGGER_LEFT",t[t.TRIGGER_RIGHT=7]="TRIGGER_RIGHT",t[t.GRIP_LEFT=8]="GRIP_LEFT",t[t.GRIP_RIGHT=9]="GRIP_RIGHT",t[t.BUTTON_LEFT_STICK=10]="BUTTON_LEFT_STICK",t[t.LEFT_STICK_UP=11]="LEFT_STICK_UP",t[t.LEFT_STICK_DOWN=12]="LEFT_STICK_DOWN",t[t.LEFT_STICK_LEFT=13]="LEFT_STICK_LEFT",t[t.LEFT_STICK_RIGHT=14]="LEFT_STICK_RIGHT",t[t.BUTTON_RIGHT_STICK=15]="BUTTON_RIGHT_STICK",t[t.RIGHT_STICK_UP=16]="RIGHT_STICK_UP",t[t.RIGHT_STICK_DOWN=17]="RIGHT_STICK_DOWN",t[t.RIGHT_STICK_LEFT=18]="RIGHT_STICK_LEFT",t[t.RIGHT_STICK_RIGHT=19]="RIGHT_STICK_RIGHT",t[t.ROKID_MENU=20]="ROKID_MENU",t[t.ROKID_START=21]="ROKID_START"}(Kt||(Kt={})),function(t){t[t.KET_CLICK=0]="KET_CLICK",t[t.KET_STICK=1]="KET_STICK",t[t.KET_GRAB=2]="KET_GRAB",t[t.KET_TOUCH=3]="KET_TOUCH"}(xt||(xt={})),function(t){t[t.UNDEFINE=0]="UNDEFINE",t[t.A=1]="A",t[t.B=2]="B",t[t.X=3]="X",t[t.Y=4]="Y",t[t.L1=5]="L1",t[t.R1=6]="R1",t[t.MINUS=7]="MINUS",t[t.PLUS=8]="PLUS",t[t.L3=9]="L3",t[t.R3=10]="R3",t[t.MENU=11]="MENU",t[t.START=12]="START",t[t.TRIGGER_LEFT=13]="TRIGGER_LEFT",t[t.TRIGGER_RIGHT=14]="TRIGGER_RIGHT"}(Bt||(Bt={})),function(t){t[t.UNDEFINE=0]="UNDEFINE",t[t.X=1]="X",t[t.Y=2]="Y",t[t.LEFT_STICK_X=3]="LEFT_STICK_X",t[t.LEFT_STICK_Y=4]="LEFT_STICK_Y",t[t.RIGHT_STICK_X=5]="RIGHT_STICK_X",t[t.RIGHT_STICK_Y=6]="RIGHT_STICK_Y",t[t.L2=7]="L2",t[t.R2=8]="R2",t[t.LEFT_GRIP=9]="LEFT_GRIP",t[t.RIGHT_GRIP=10]="RIGHT_GRIP"}(Vt||(Vt={})),function(t){t[t.UNDEFINE=0]="UNDEFINE",t[t.A=1]="A",t[t.B=2]="B",t[t.X=3]="X",t[t.Y=4]="Y",t[t.LEFT_TRIGGER=5]="LEFT_TRIGGER",t[t.RIGHT_TRIGGER=6]="RIGHT_TRIGGER",t[t.LEFT_THUMBSTICK=7]="LEFT_THUMBSTICK",t[t.RIGHT_THUMBSTICK=8]="RIGHT_THUMBSTICK"}(Wt||(Wt={}));var jt,Xt={1:Kt.BUTTON_EAST,2:Kt.BUTTON_SOUTH,3:Kt.BUTTON_NORTH,4:Kt.BUTTON_WEST,9:Kt.BUTTON_LEFT_STICK,10:Kt.BUTTON_RIGHT_STICK,11:Kt.ROKID_MENU,12:Kt.ROKID_START,13:Kt.BUTTON_TRIGGER_LEFT,14:Kt.BUTTON_TRIGGER_RIGHT},zt=function(){function t(){var t,e,n=this;this._eventTarget=new N,this._nativeButtonState=((t={})[Kt.BUTTON_SOUTH]=0,t[Kt.BUTTON_EAST]=0,t[Kt.BUTTON_WEST]=0,t[Kt.BUTTON_NORTH]=0,t[Kt.BUTTON_TRIGGER_LEFT]=0,t[Kt.BUTTON_TRIGGER_RIGHT]=0,t[Kt.TRIGGER_LEFT]=0,t[Kt.TRIGGER_RIGHT]=0,t[Kt.GRIP_LEFT]=0,t[Kt.GRIP_RIGHT]=0,t[Kt.LEFT_STICK_UP]=0,t[Kt.LEFT_STICK_DOWN]=0,t[Kt.LEFT_STICK_LEFT]=0,t[Kt.LEFT_STICK_RIGHT]=0,t[Kt.RIGHT_STICK_UP]=0,t[Kt.RIGHT_STICK_DOWN]=0,t[Kt.RIGHT_STICK_LEFT]=0,t[Kt.RIGHT_STICK_RIGHT]=0,t[Kt.BUTTON_LEFT_STICK]=0,t[Kt.BUTTON_RIGHT_STICK]=0,t[Kt.ROKID_MENU]=0,t[Kt.ROKID_START]=0,t),this._nativeTouchState=((e={})[Wt.UNDEFINE]=0,e[Wt.A]=0,e[Wt.B]=0,e[Wt.X]=0,e[Wt.Y]=0,e[Wt.LEFT_TRIGGER]=0,e[Wt.RIGHT_TRIGGER]=0,e[Wt.LEFT_THUMBSTICK]=0,e[Wt.RIGHT_THUMBSTICK]=0,e),this._initInputSource(),window.addEventListener("xr-remote-input",(function(t){var e=t,i=e.detail.keyEventType,a=e.detail.stickAxisCode,o=e.detail.stickAxisValue,r=e.detail.stickKeyCode,s=e.detail.isButtonPressed,u=e.detail.touchCode,c=e.detail.touchValue;if(i===xt.KET_CLICK){var _=Xt[r];n._nativeButtonState[_]=s?1:0}else if(i===xt.KET_STICK||i===xt.KET_GRAB){var h,v,d;switch(a){case Vt.LEFT_STICK_X:h=Kt.LEFT_STICK_LEFT,v=Kt.LEFT_STICK_RIGHT,d=n._axisToButtons(o);break;case Vt.LEFT_STICK_Y:h=Kt.LEFT_STICK_DOWN,v=Kt.LEFT_STICK_UP,d=n._axisToButtons(o);break;case Vt.RIGHT_STICK_X:h=Kt.RIGHT_STICK_LEFT,v=Kt.RIGHT_STICK_RIGHT,d=n._axisToButtons(o);break;case Vt.RIGHT_STICK_Y:h=Kt.RIGHT_STICK_DOWN,v=Kt.RIGHT_STICK_UP,d=n._axisToButtons(o);break;case Vt.L2:n._nativeButtonState[Kt.TRIGGER_LEFT]=o;break;case Vt.R2:n._nativeButtonState[Kt.TRIGGER_RIGHT]=o;break;case Vt.LEFT_GRIP:n._nativeButtonState[Kt.GRIP_LEFT]=o;break;case Vt.RIGHT_GRIP:n._nativeButtonState[Kt.GRIP_RIGHT]=o}h&&v&&d&&(n._nativeButtonState[h]=d.negative,n._nativeButtonState[v]=d.positive)}else if(i===xt.KET_TOUCH)switch(u){case Wt.A:case Wt.B:case Wt.X:case Wt.Y:case Wt.LEFT_TRIGGER:case Wt.RIGHT_TRIGGER:case Wt.LEFT_THUMBSTICK:case Wt.RIGHT_THUMBSTICK:n._nativeTouchState[u]=c}n._eventTarget.emit(ut.HANDLE_INPUT,new _t(ut.HANDLE_INPUT,n))}))}var e=t.prototype;return e._axisToButtons=function(t){var e=Math.abs(t);return t>0?{negative:0,positive:e}:t<0?{negative:e,positive:0}:{negative:0,positive:0}},e._on=function(t,e,n){this._eventTarget.on(t,e,n)},e._initInputSource=function(){var t=this;this._buttonNorth=new Ct,this._buttonNorth.getValue=function(){return t._nativeButtonState[Kt.BUTTON_NORTH]},this._buttonEast=new Ct,this._buttonEast.getValue=function(){return t._nativeButtonState[Kt.BUTTON_EAST]},this._buttonWest=new Ct,this._buttonWest.getValue=function(){return t._nativeButtonState[Kt.BUTTON_WEST]},this._buttonSouth=new Ct,this._buttonSouth.getValue=function(){return t._nativeButtonState[Kt.BUTTON_SOUTH]},this._buttonTriggerLeft=new Ct,this._buttonTriggerLeft.getValue=function(){return t._nativeButtonState[Kt.BUTTON_TRIGGER_LEFT]},this._buttonTriggerRight=new Ct,this._buttonTriggerRight.getValue=function(){return t._nativeButtonState[Kt.BUTTON_TRIGGER_RIGHT]},this._triggerLeft=new Ct,this._triggerLeft.getValue=function(){return t._nativeButtonState[Kt.TRIGGER_LEFT]},this._triggerRight=new Ct,this._triggerRight.getValue=function(){return t._nativeButtonState[Kt.TRIGGER_RIGHT]},this._gripLeft=new Ct,this._gripLeft.getValue=function(){return t._nativeButtonState[Kt.GRIP_LEFT]},this._gripRight=new Ct,this._gripRight.getValue=function(){return t._nativeButtonState[Kt.GRIP_RIGHT]},this._buttonLeftStick=new Ct,this._buttonLeftStick.getValue=function(){return t._nativeButtonState[Kt.BUTTON_LEFT_STICK]};var e=new Ct;e.getValue=function(){return t._nativeButtonState[Kt.LEFT_STICK_UP]};var n=new Ct;n.getValue=function(){return t._nativeButtonState[Kt.LEFT_STICK_DOWN]};var i=new Ct;i.getValue=function(){return t._nativeButtonState[Kt.LEFT_STICK_LEFT]};var r=new Ct;r.getValue=function(){return t._nativeButtonState[Kt.LEFT_STICK_RIGHT]},this._leftStick=new At({up:e,down:n,left:i,right:r}),this._buttonRightStick=new Ct,this._buttonRightStick.getValue=function(){return t._nativeButtonState[Kt.BUTTON_RIGHT_STICK]};var s=new Ct;s.getValue=function(){return t._nativeButtonState[Kt.RIGHT_STICK_UP]};var u=new Ct;u.getValue=function(){return t._nativeButtonState[Kt.RIGHT_STICK_DOWN]};var c=new Ct;c.getValue=function(){return t._nativeButtonState[Kt.RIGHT_STICK_LEFT]};var _=new Ct;_.getValue=function(){return t._nativeButtonState[Kt.RIGHT_STICK_RIGHT]},this._rightStick=new At({up:s,down:u,left:c,right:_}),this._buttonOptions=new Ct,this._buttonOptions.getValue=function(){return t._nativeButtonState[Kt.ROKID_MENU]},this._buttonStart=new Ct,this._buttonStart.getValue=function(){return t._nativeButtonState[Kt.ROKID_START]},this._handLeftPosition=new Ut,this._handLeftPosition.getValue=function(){return a.ZERO},this._handLeftOrientation=new Dt,this._handLeftOrientation.getValue=function(){return o.IDENTITY},this._handRightPosition=new Ut,this._handRightPosition.getValue=function(){return a.ZERO},this._handRightOrientation=new Dt,this._handRightOrientation.getValue=function(){return o.IDENTITY},this._aimLeftPosition=new Ut,this._aimLeftPosition.getValue=function(){return a.ZERO},this._aimLeftOrientation=new Dt,this._aimLeftOrientation.getValue=function(){return o.IDENTITY},this._aimRightPosition=new Ut,this._aimRightPosition.getValue=function(){return a.ZERO},this._aimRightOrientation=new Dt,this._aimRightOrientation.getValue=function(){return o.IDENTITY},this._touchButtonA=new Pt,this._touchButtonA.getValue=function(){return t._nativeTouchState[Wt.A]},this._touchButtonB=new Pt,this._touchButtonB.getValue=function(){return t._nativeTouchState[Wt.B]},this._touchButtonX=new Pt,this._touchButtonX.getValue=function(){return t._nativeTouchState[Wt.X]},this._touchButtonY=new Pt,this._touchButtonY.getValue=function(){return t._nativeTouchState[Wt.Y]},this._touchButtonTriggerLeft=new Pt,this._touchButtonTriggerLeft.getValue=function(){return t._nativeTouchState[Wt.LEFT_TRIGGER]},this._touchButtonTriggerRight=new Pt,this._touchButtonTriggerRight.getValue=function(){return t._nativeTouchState[Wt.RIGHT_TRIGGER]},this._touchButtonThumbStickLeft=new Pt,this._touchButtonThumbStickLeft.getValue=function(){return t._nativeTouchState[Wt.LEFT_THUMBSTICK]},this._touchButtonThumbStickRight=new Pt,this._touchButtonThumbStickRight.getValue=function(){return t._nativeTouchState[Wt.RIGHT_THUMBSTICK]}},D(t,[{key:"buttonNorth",get:function(){return this._buttonNorth}},{key:"buttonEast",get:function(){return this._buttonEast}},{key:"buttonWest",get:function(){return this._buttonWest}},{key:"buttonSouth",get:function(){return this._buttonSouth}},{key:"buttonTriggerLeft",get:function(){return this._buttonTriggerLeft}},{key:"buttonTriggerRight",get:function(){return this._buttonTriggerRight}},{key:"triggerLeft",get:function(){return this._triggerLeft}},{key:"triggerRight",get:function(){return this._triggerRight}},{key:"gripLeft",get:function(){return this._gripLeft}},{key:"gripRight",get:function(){return this._gripRight}},{key:"leftStick",get:function(){return this._leftStick}},{key:"rightStick",get:function(){return this._rightStick}},{key:"buttonLeftStick",get:function(){return this._buttonLeftStick}},{key:"buttonRightStick",get:function(){return this._buttonRightStick}},{key:"buttonOptions",get:function(){return this._buttonOptions}},{key:"buttonStart",get:function(){return this._buttonStart}},{key:"handLeftPosition",get:function(){return this._handLeftPosition}},{key:"handLeftOrientation",get:function(){return this._handLeftOrientation}},{key:"handRightPosition",get:function(){return this._handRightPosition}},{key:"handRightOrientation",get:function(){return this._handRightOrientation}},{key:"aimLeftPosition",get:function(){return this._aimLeftPosition}},{key:"aimLeftOrientation",get:function(){return this._aimLeftOrientation}},{key:"aimRightPosition",get:function(){return this._aimRightPosition}},{key:"aimRightOrientation",get:function(){return this._aimRightOrientation}},{key:"touchButtonA",get:function(){return this._touchButtonA}},{key:"touchButtonB",get:function(){return this._touchButtonB}},{key:"touchButtonX",get:function(){return this._touchButtonX}},{key:"touchButtonY",get:function(){return this._touchButtonY}},{key:"touchButtonTriggerLeft",get:function(){return this._touchButtonTriggerLeft}},{key:"touchButtonTriggerRight",get:function(){return this._touchButtonTriggerRight}},{key:"touchButtonThumbStickLeft",get:function(){return this._touchButtonThumbStickLeft}},{key:"touchButtonThumbStickRight",get:function(){return this._touchButtonThumbStickRight}}]),t}();!function(t){t[t.VIEW_LEFT=0]="VIEW_LEFT",t[t.VIEW_RIGHT=3]="VIEW_RIGHT",t[t.HEAD_MIDDLE=6]="HEAD_MIDDLE"}(jt||(jt={}));var Zt,$t,Qt=function(){function t(){var t;this._eventTarget=new N,this._intervalId=-1,this._webPoseState=((t={})[jt.VIEW_LEFT]={position:a.ZERO,orientation:o.IDENTITY},t[jt.VIEW_RIGHT]={position:a.ZERO,orientation:o.IDENTITY},t[jt.HEAD_MIDDLE]={position:a.ZERO,orientation:o.IDENTITY},t),this._initInputSource(),this._registerEvent()}var e=t.prototype;return e._ensureDirectorDefined=function(){var t=this;return new Promise((function(e){t._intervalId=setInterval((function(){at.director&&at.Director&&(clearInterval(t._intervalId),t._intervalId=-1,e())}),50)}))},e._registerEvent=function(){var t=this;this._ensureDirectorDefined().then((function(){at.director.on(at.Director.EVENT_BEGIN_FRAME,t._scanHmd,t)})).catch((function(){}))},e._scanHmd=function(){var t,e=null==(t=globalThis.__globalXR)?void 0:t.webxrHmdPoseInfos;if(e){for(var n=0;n<e.length;++n){var i=e[n];this._updateWebPoseState(i)}this._eventTarget.emit(ut.HMD_POSE_INPUT,new ht(ut.HMD_POSE_INPUT,this))}},e._on=function(t,e,n){this._eventTarget.on(t,e,n)},e._updateWebPoseState=function(t){t.code!==jt.VIEW_LEFT&&t.code!==jt.VIEW_RIGHT&&t.code!==jt.HEAD_MIDDLE||(this._webPoseState[t.code]={position:new a(t.position.x,t.position.y,t.position.z),orientation:new o(t.orientation.x,t.orientation.y,t.orientation.z,t.orientation.w)})},e._initInputSource=function(){var t=this;this._viewLeftPosition=new Ut,this._viewLeftPosition.getValue=function(){return t._webPoseState[jt.VIEW_LEFT].position},this._viewLeftOrientation=new Dt,this._viewLeftOrientation.getValue=function(){return t._webPoseState[jt.VIEW_LEFT].orientation},this._viewRightPosition=new Ut,this._viewRightPosition.getValue=function(){return t._webPoseState[jt.VIEW_RIGHT].position},this._viewRightOrientation=new Dt,this._viewRightOrientation.getValue=function(){return t._webPoseState[jt.VIEW_RIGHT].orientation},this._headMiddlePosition=new Ut,this._headMiddlePosition.getValue=function(){return t._webPoseState[jt.HEAD_MIDDLE].position},this._headMiddleOrientation=new Dt,this._headMiddleOrientation.getValue=function(){return t._webPoseState[jt.HEAD_MIDDLE].orientation}},D(t,[{key:"viewLeftPosition",get:function(){return this._viewLeftPosition}},{key:"viewLeftOrientation",get:function(){return this._viewLeftOrientation}},{key:"viewRightPosition",get:function(){return this._viewRightPosition}},{key:"viewRightOrientation",get:function(){return this._viewRightOrientation}},{key:"headMiddlePosition",get:function(){return this._headMiddlePosition}},{key:"headMiddleOrientation",get:function(){return this._headMiddleOrientation}}]),t}(),qt=function(){function t(){this._eventTarget=new N,this._initInputSource()}var e=t.prototype;return e._on=function(t,e,n){this._eventTarget.on(t,e,n)},e._initInputSource=function(){this._handheldPosition=new Ut,this._handheldPosition.getValue=function(){return a.ZERO},this._handheldOrientation=new Dt,this._handheldOrientation.getValue=function(){return o.IDENTITY}},D(t,[{key:"handheldPosition",get:function(){return this._handheldPosition}},{key:"handheldOrientation",get:function(){return this._handheldOrientation}}]),t}(),Jt={Backspace:vt.BACKSPACE,Tab:vt.TAB,Enter:vt.ENTER,ShiftLeft:vt.SHIFT_LEFT,ControlLeft:vt.CTRL_LEFT,AltLeft:vt.ALT_LEFT,ShiftRight:vt.SHIFT_RIGHT,ControlRight:vt.CTRL_RIGHT,AltRight:vt.ALT_RIGHT,Pause:vt.PAUSE,CapsLock:vt.CAPS_LOCK,Escape:vt.ESCAPE,Space:vt.SPACE,PageUp:vt.PAGE_UP,PageDown:vt.PAGE_DOWN,End:vt.END,Home:vt.HOME,ArrowLeft:vt.ARROW_LEFT,ArrowUp:vt.ARROW_UP,ArrowRight:vt.ARROW_RIGHT,ArrowDown:vt.ARROW_DOWN,Insert:vt.INSERT,Delete:vt.DELETE,Digit0:vt.DIGIT_0,Digit1:vt.DIGIT_1,Digit2:vt.DIGIT_2,Digit3:vt.DIGIT_3,Digit4:vt.DIGIT_4,Digit5:vt.DIGIT_5,Digit6:vt.DIGIT_6,Digit7:vt.DIGIT_7,Digit8:vt.DIGIT_8,Digit9:vt.DIGIT_9,KeyA:vt.KEY_A,KeyB:vt.KEY_B,KeyC:vt.KEY_C,KeyD:vt.KEY_D,KeyE:vt.KEY_E,KeyF:vt.KEY_F,KeyG:vt.KEY_G,KeyH:vt.KEY_H,KeyI:vt.KEY_I,KeyJ:vt.KEY_J,KeyK:vt.KEY_K,KeyL:vt.KEY_L,KeyM:vt.KEY_M,KeyN:vt.KEY_N,KeyO:vt.KEY_O,KeyP:vt.KEY_P,KeyQ:vt.KEY_Q,KeyR:vt.KEY_R,KeyS:vt.KEY_S,KeyT:vt.KEY_T,KeyU:vt.KEY_U,KeyV:vt.KEY_V,KeyW:vt.KEY_W,KeyX:vt.KEY_X,KeyY:vt.KEY_Y,KeyZ:vt.KEY_Z,Numpad0:vt.NUM_0,Numpad1:vt.NUM_1,Numpad2:vt.NUM_2,Numpad3:vt.NUM_3,Numpad4:vt.NUM_4,Numpad5:vt.NUM_5,Numpad6:vt.NUM_6,Numpad7:vt.NUM_7,Numpad8:vt.NUM_8,Numpad9:vt.NUM_9,NumpadMultiply:vt.NUM_MULTIPLY,NumpadAdd:vt.NUM_PLUS,NumpadSubtract:vt.NUM_SUBTRACT,NumpadDecimal:vt.NUM_DECIMAL,NumpadDivide:vt.NUM_DIVIDE,NumpadEnter:vt.NUM_ENTER,F1:vt.F1,F2:vt.F2,F3:vt.F3,F4:vt.F4,F5:vt.F5,F6:vt.F6,F7:vt.F7,F8:vt.F8,F9:vt.F9,F10:vt.F10,F11:vt.F11,F12:vt.F12,NumLock:vt.NUM_LOCK,ScrollLock:vt.SCROLL_LOCK,Semicolon:vt.SEMICOLON,Equal:vt.EQUAL,Comma:vt.COMMA,Minus:vt.DASH,Period:vt.PERIOD,Slash:vt.SLASH,Backquote:vt.BACK_QUOTE,BracketLeft:vt.BRACKET_LEFT,Backslash:vt.BACKSLASH,BracketRight:vt.BRACKET_RIGHT,Quote:vt.QUOTE},te=function(){function t(){this._eventTarget=new N,this._registerEvent()}var e=t.prototype;return e.dispatchKeyboardDownEvent=function(t){this._handleKeyboardDown(t)},e.dispatchKeyboardUpEvent=function(t){this._handleKeyboardUp(t)},e.on=function(t,e,n){this._eventTarget.on(t,e,n)},e._registerEvent=function(){var t=document.getElementById("GameCanvas");null==t||t.addEventListener("keydown",this._handleKeyboardDown.bind(this)),null==t||t.addEventListener("keyup",this._handleKeyboardUp.bind(this))},e._getInputEvent=function(t,e){var n,i=(n=t.code,Jt[n]||vt.NONE);return new dt(i,e)},e._handleKeyboardDown=function(t){if(t.stopPropagation(),t.preventDefault(),t.repeat){var e=this._getInputEvent(t,ut.KEY_PRESSING);this._eventTarget.emit(ut.KEY_PRESSING,e)}else{var n=this._getInputEvent(t,ut.KEY_DOWN);this._eventTarget.emit(ut.KEY_DOWN,n)}},e._handleKeyboardUp=function(t){var e=this._getInputEvent(t,ut.KEY_UP);t.stopPropagation(),t.preventDefault(),this._eventTarget.emit(ut.KEY_UP,e)},t}(),ee=function(){function t(){this._canvas=void 0,this._eventTarget=new N,this._pointLocked=!1,this._isPressed=!1,this._preMousePos=new i,this._handleMouseDown=void 0,this._handleMouseMove=void 0,this._handleMouseUp=void 0,O.hasFeature(M.EVENT_MOUSE)&&(this._canvas=document.getElementById("GameCanvas"),this._canvas||nt||it||G("failed to access canvas"),this._handleMouseDown=this._createCallback(ut.MOUSE_DOWN),this._handleMouseMove=this._createCallback(ut.MOUSE_MOVE),this._handleMouseUp=this._createCallback(ut.MOUSE_UP),this._registerEvent())}var e=t.prototype;return e.dispatchMouseDownEvent=function(t){this._handleMouseDown(t)},e.dispatchMouseMoveEvent=function(t){this._handleMouseMove(t)},e.dispatchMouseUpEvent=function(t){this._handleMouseUp(t)},e.dispatchScrollEvent=function(t){this._handleMouseWheel(t)},e.on=function(t,e,n){this._eventTarget.on(t,e,n)},e._getCanvasRect=function(){var t=this._canvas,e=null==t?void 0:t.getBoundingClientRect();return e?new r(e.x,e.y,e.width,e.height):new r(0,0,0,0)},e._getLocation=function(t){var e=this._getCanvasRect(),a=n.devicePixelRatio,o=this._pointLocked?this._preMousePos.x/a+t.movementX:t.clientX-e.x,r=this._pointLocked?this._preMousePos.y/a-t.movementY:e.y+e.height-t.clientY;return new i(o*=a,r*=a)},e._registerEvent=function(){var t,e,n,i,a,o,r=this;window.addEventListener("mousedown",(function(){r._isPressed=!0})),null==(t=this._canvas)||t.addEventListener("mousedown",this._handleMouseDown),null==(e=this._canvas)||e.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp),null==(n=this._canvas)||n.addEventListener("mouseup",this._handleMouseUp),null==(i=this._canvas)||i.addEventListener("wheel",this._handleMouseWheel.bind(this)),this._registerPointerLockEvent(),null==(a=this._canvas)||a.addEventListener("mouseleave",this._handleMouseLeave.bind(this)),null==(o=this._canvas)||o.addEventListener("mouseenter",this._handleMouseEnter.bind(this))},e._registerPointerLockEvent=function(){var t=this,e=function(){var e=t._canvas;document.pointerLockElement===e||document.mozPointerLockElement===e?t._pointLocked=!0:t._pointLocked=!1};"onpointerlockchange"in document?document.addEventListener("pointerlockchange",e,!1):"onmozpointerlockchange"in document&&document.addEventListener("mozpointerlockchange",e,!1)},e._createCallback=function(t){var e=this;return function(n){var i,a=e._getLocation(n),o=n.button,r=n.buttons,s=o;switch(t){case ut.MOUSE_DOWN:null==(i=e._canvas)||i.focus(),e._isPressed=!0;break;case ut.MOUSE_UP:e._isPressed=!1;break;case ut.MOUSE_MOVE:s=1&r?lt.BUTTON_LEFT:2&r?lt.BUTTON_RIGHT:4&r?lt.BUTTON_MIDDLE:lt.BUTTON_MISSING}var u=new lt(t,!1,e._preMousePos);u.setLocation(a.x,a.y),u.setButton(s),u.movementX=n.movementX,u.movementY=n.movementY,e._preMousePos.set(a.x,a.y),n.stopPropagation(),n.target===e._canvas&&n.preventDefault(),e._eventTarget.emit(t,u)}},e._handleMouseWheel=function(t){var e=ut.MOUSE_WHEEL,n=this._getLocation(t),i=t.button,a=new lt(e,!1,this._preMousePos);a.setLocation(n.x,n.y),a.setButton(i),a.movementX=t.movementX,a.movementY=t.movementY,a.setScrollData(5*t.deltaX,5*-t.deltaY),this._preMousePos.set(n.x,n.y),t.stopPropagation(),t.target===this._canvas&&t.preventDefault(),this._eventTarget.emit(e,a)},e._handleMouseLeave=function(){var t=ut.MOUSE_LEAVE,e=new lt(t,!1);this._eventTarget.emit(t,e)},e._handleMouseEnter=function(){var t=ut.MOUSE_ENTER,e=new lt(t,!1);this._eventTarget.emit(t,e)},e.dispatchEventsInCache=function(){},t}(),ne=new i,ie=new(function(){function t(){this._touchMap=new Map,this._maxTouches=8}var e=t.prototype;return e._createTouch=function(t,e,n){if(this._touchMap.has(t))U(2301);else{if(!this._checkTouchMapSizeMoreThanMax(t)){var i=new ft(e,n,t);return this._touchMap.set(t,i),this._updateTouch(i,e,n),i}U(2300)}},e.releaseTouch=function(t){this._touchMap.has(t)&&this._touchMap.delete(t)},e.getTouch=function(t){return this._touchMap.get(t)},e.getOrCreateTouch=function(t,e,n){var i=this.getTouch(t);return i?this._updateTouch(i,e,n):i=this._createTouch(t,e,n),i},e.getAllTouches=function(){var t=[];return this._touchMap.forEach((function(e){e&&t.push(e)})),t},e.getTouchCount=function(){return this._touchMap.size},e._updateTouch=function(t,e,n){t.getLocation(ne),t.setPrevPoint(ne),t.setPoint(e,n)},e._checkTouchMapSizeMoreThanMax=function(t){var e=this;if(this._touchMap.has(t))return!1;var n=P.ENABLE_MULTI_TOUCH?this._maxTouches:1;if(this._touchMap.size<n)return!1;var i=performance.now();return this._touchMap.forEach((function(t){i-t.lastModified>P.TOUCH_TIMEOUT&&(U(2302,t.getID()),e.releaseTouch(t.getID()))})),n>=this._touchMap.size},t}()),ae=function(){function t(){this._canvas=void 0,this._eventTarget=new N,O.hasFeature(M.INPUT_TOUCH)&&(this._canvas=document.getElementById("GameCanvas"),this._canvas||nt||it||G("failed to access canvas"),this._registerEvent())}var e=t.prototype;return e._registerEvent=function(){var t,e,n,i;null==(t=this._canvas)||t.addEventListener("touchstart",this._createCallback(ut.TOUCH_START)),null==(e=this._canvas)||e.addEventListener("touchmove",this._createCallback(ut.TOUCH_MOVE)),null==(n=this._canvas)||n.addEventListener("touchend",this._createCallback(ut.TOUCH_END)),null==(i=this._canvas)||i.addEventListener("touchcancel",this._createCallback(ut.TOUCH_CANCEL))},e._createCallback=function(t){var e=this;return function(n){for(var i,a=e._getCanvasRect(),o=[],r=n.changedTouches.length,s=0;s<r;++s){var u=n.changedTouches[s],c=u.identifier;if(null!==c){var _=e._getLocation(u,a),h=ie.getOrCreateTouch(c,_.x,_.y);h&&(t!==ut.TOUCH_END&&t!==ut.TOUCH_CANCEL||ie.releaseTouch(c),o.push(h))}}if(n.stopPropagation(),n.target===e._canvas&&n.preventDefault(),t===ut.TOUCH_START&&(null==(i=e._canvas)||i.focus()),o.length>0){var v=new gt(o,!1,t,ie.getAllTouches());e._eventTarget.emit(t,v)}}},e._getCanvasRect=function(){var t=this._canvas,e=null==t?void 0:t.getBoundingClientRect();return e?new r(e.x,e.y,e.width,e.height):new r(0,0,0,0)},e._getLocation=function(t,e){if(globalThis.__globalXR&&globalThis.__globalXR.ar&&globalThis.__globalXR.ar.isWebXR())return new i(t.clientX,t.clientY);var a=t.clientX-e.x,o=e.y+e.height-t.clientY;if(n.isFrameRotated){var r=a;a=e.height-o,o=r}var s=n.devicePixelRatio;return new i(a*=s,o*=s)},e.on=function(t,e,n){this._eventTarget.on(t,e,n)},e.dispatchEventsInCache=function(){},t}();t("E",$t),function(t){t[t.GLOBAL=0]="GLOBAL",t[t.UI=1]="UI"}($t||t("E",$t={}));var oe=function(){function t(t){this.priority=$t.GLOBAL,this._inputEventTarget=t}var e=t.prototype;return e.onThrowException=function(){},e.dispatchEvent=function(t){return this._inputEventTarget.emit(t.type,t),!0},t}(),re=((Zt={})[ut.MOUSE_DOWN]=ut.TOUCH_START,Zt[ut.MOUSE_MOVE]=ut.TOUCH_MOVE,Zt[ut.MOUSE_UP]=ut.TOUCH_END,Zt),se=t("I",function(){function t(){this._eventTarget=new N,this._touchInput=new ae,this._mouseInput=new ee,this._keyboardInput=new te,this._accelerometerInput=new bt,this._eventKeyboardList=[],this._eventAccelerationList=[],this._eventGamepadList=[],this._eventHandleList=[],this._eventHMDList=[],this._eventHandheldList=[],this._needSimulateTouchMoveEvent=!1,this._eventDispatcherList=[],this._handleInput=new zt,this._hmdInput=new Qt,this._handheldInput=new qt,this._registerEvent(),this._inputEventDispatcher=new oe(this._eventTarget),this._registerEventDispatcher(this._inputEventDispatcher),Yt._init()}var e=t.prototype;return e._dispatchMouseDownEvent=function(t){var e,n;null==(e=(n=this._mouseInput).dispatchMouseDownEvent)||e.call(n,t)},e._dispatchMouseMoveEvent=function(t){var e,n;null==(e=(n=this._mouseInput).dispatchMouseMoveEvent)||e.call(n,t)},e._dispatchMouseUpEvent=function(t){var e,n;null==(e=(n=this._mouseInput).dispatchMouseUpEvent)||e.call(n,t)},e._dispatchMouseScrollEvent=function(t){var e,n;null==(e=(n=this._mouseInput).dispatchScrollEvent)||e.call(n,t)},e._dispatchKeyboardDownEvent=function(t){var e,n;null==(e=(n=this._keyboardInput).dispatchKeyboardDownEvent)||e.call(n,t)},e._dispatchKeyboardUpEvent=function(t){var e,n;null==(e=(n=this._keyboardInput).dispatchKeyboardUpEvent)||e.call(n,t)},e.on=function(t,e,n){return this._eventTarget.on(t,e,n),e},e.once=function(t,e,n){return this._eventTarget.once(t,e,n),e},e.off=function(t,e,n){this._eventTarget.off(t,e,n)},e.getTouch=function(t){return ie.getTouch(t)},e.getAllTouches=function(){return ie.getAllTouches()},e.getTouchCount=function(){return ie.getTouchCount()},e.setAccelerometerEnabled=function(t){t?this._accelerometerInput.start():this._accelerometerInput.stop()},e.setAccelerometerInterval=function(t){this._accelerometerInput.setInterval(t)},e._simulateEventTouch=function(t){var e=re[t.type],n=ie.getOrCreateTouch(0,t.getLocationX(),t.getLocationY());if(n){var i=[n],a=new gt(i,!1,e,e===ut.TOUCH_END?[]:i);a.windowId=t.windowId,e===ut.TOUCH_END&&ie.releaseTouch(0),this._dispatchEventTouch(a)}},e._registerEventDispatcher=function(t){this._eventDispatcherList.push(t),this._eventDispatcherList.sort((function(t,e){return e.priority-t.priority}))},e._emitEvent=function(t){for(var e=this._eventDispatcherList.length,n=0;n<e;++n){var i=this._eventDispatcherList[n];try{if(!i.dispatchEvent(t))break}catch(t){throw this._clearEvents(),i.onThrowException(),t}}},e._registerEvent=function(){var t=this,e=t._touchInput,n=t._mouseInput,i=t._keyboardInput,a=t._handleInput;if(s.hasFeature(s.Feature.INPUT_TOUCH)&&(e.on(ut.TOUCH_START,(function(e){t._dispatchEventTouch(e)})),e.on(ut.TOUCH_MOVE,(function(e){t._dispatchEventTouch(e)})),e.on(ut.TOUCH_END,(function(e){t._dispatchEventTouch(e)})),e.on(ut.TOUCH_CANCEL,(function(e){t._dispatchEventTouch(e)}))),s.hasFeature(s.Feature.EVENT_MOUSE)&&(n.on(ut.MOUSE_DOWN,(function(e){t._needSimulateTouchMoveEvent=!0,t._simulateEventTouch(e),t._dispatchEventMouse(e)})),n.on(ut.MOUSE_MOVE,(function(e){t._needSimulateTouchMoveEvent&&t._simulateEventTouch(e),t._dispatchEventMouse(e)})),n.on(ut.MOUSE_UP,(function(e){t._needSimulateTouchMoveEvent=!1,t._simulateEventTouch(e),t._dispatchEventMouse(e)})),n.on(ut.MOUSE_WHEEL,(function(e){t._dispatchEventMouse(e)})),n.on(ut.MOUSE_LEAVE,(function(e){t._dispatchEventMouse(e)})),n.on(ut.MOUSE_ENTER,(function(e){t._dispatchEventMouse(e)}))),s.hasFeature(s.Feature.EVENT_KEYBOARD)){var o=t._eventKeyboardList;i.on(ut.KEY_DOWN,(function(e){t._dispatchOrPushEvent(e,o)})),i.on(ut.KEY_PRESSING,(function(e){t._dispatchOrPushEvent(e,o)})),i.on(ut.KEY_UP,(function(e){t._dispatchOrPushEvent(e,o)}))}if(s.hasFeature(s.Feature.EVENT_ACCELEROMETER)){var r=t._eventAccelerationList;t._accelerometerInput.on(ut.DEVICEMOTION,(function(e){t._dispatchOrPushEvent(e,r)}))}if(s.hasFeature(s.Feature.EVENT_GAMEPAD)){var u=t._eventGamepadList;Yt._on(ut.GAMEPAD_CHANGE,(function(e){t._dispatchOrPushEvent(e,u)})),Yt._on(ut.GAMEPAD_INPUT,(function(e){t._dispatchOrPushEvent(e,u)})),Yt._on(ut.HANDLE_POSE_INPUT,(function(e){t._dispatchOrPushEvent(e,u)}))}if(s.hasFeature(s.Feature.EVENT_HANDLE)){var c=t._eventHandleList;a._on(ut.HANDLE_INPUT,(function(e){t._dispatchOrPushEvent(e,c)})),a._on(ut.HANDLE_POSE_INPUT,(function(e){t._dispatchOrPushEvent(e,c)}))}if(s.hasFeature(s.Feature.EVENT_HMD)){var _=t._eventHMDList;t._hmdInput._on(ut.HMD_POSE_INPUT,(function(e){t._dispatchOrPushEvent(e,_)}))}if(s.hasFeature(s.Feature.EVENT_HANDHELD)){var h=t._eventHandheldList;t._handheldInput._on(ut.HANDHELD_POSE_INPUT,(function(e){t._dispatchOrPushEvent(e,h)}))}},e._clearEvents=function(){this._eventKeyboardList.length=0,this._eventAccelerationList.length=0,this._eventGamepadList.length=0,this._eventHandleList.length=0,this._eventHMDList.length=0},e._dispatchOrPushEvent=function(t){this._emitEvent(t)},e._dispatchEventMouse=function(t){this._emitEvent(t)},e._dispatchEventTouch=function(t){for(var e=t.getTouches(),n=e.length,i=0;i<n;++i)t.touch=e[i],t.propagationStopped=t.propagationImmediateStopped=!1,this._emitEvent(t)},e._frameDispatchEvents=function(){},t}());se.EventType=ut;var ue=t("i",new se),ce=t("S",function(t){function e(){var e;return e=t.call(this)||this,ue.on(ut.MOUSE_DOWN,(function(t){e.emit(Tt.MOUSE_DOWN,t)})),ue.on(ut.MOUSE_MOVE,(function(t){e.emit(Tt.MOUSE_MOVE,t)})),ue.on(ut.MOUSE_UP,(function(t){e.emit(Tt.MOUSE_UP,t)})),ue.on(ut.MOUSE_WHEEL,(function(t){e.emit(Tt.MOUSE_WHEEL,t)})),ue.on(ut.TOUCH_START,(function(t){e.emit(Tt.TOUCH_START,t.touch,t)})),ue.on(ut.TOUCH_MOVE,(function(t){e.emit(Tt.TOUCH_MOVE,t.touch,t)})),ue.on(ut.TOUCH_END,(function(t){e.emit(Tt.TOUCH_END,t.touch,t)})),ue.on(ut.TOUCH_CANCEL,(function(t){e.emit(Tt.TOUCH_CANCEL,t.touch,t)})),ue.on(ut.KEY_DOWN,(function(t){e.emit(Tt.KEY_DOWN,t)})),ue.on(ut.KEY_PRESSING,(function(t){e.emit(Tt.KEY_DOWN,t)})),ue.on(ut.KEY_UP,(function(t){e.emit(Tt.KEY_UP,t)})),ue.on(ut.DEVICEMOTION,(function(t){e.emit(Tt.DEVICEMOTION,t)})),e}C(e,t);var n=e.prototype;return n.setAccelerometerEnabled=function(t){ue.setAccelerometerEnabled(t)},n.setAccelerometerInterval=function(t){ue.setAccelerometerInterval(t)},n.on=function(e,n,i,a){return t.prototype.on.call(this,e,n,i,a),n},n.off=function(e,n,i){t.prototype.off.call(this,e,n,i)},e}(N));ce.EventType=Tt,ot.SystemEvent=ce;var _e,he=t("s",new ce);ot.systemEvent=he,u(Tt,"Node.EventType",[{name:"POSITION_PART",newName:"TRANSFORM_CHANGED"},{name:"ROTATION_PART",newName:"TRANSFORM_CHANGED"},{name:"SCALE_PART",newName:"TRANSFORM_CHANGED"}]),u(pt,"Event",[{name:"ACCELERATION",newName:"DEVICEMOTION",target:ce.EventType,targetName:"SystemEvent.EventType"}]),c(pt,"Event",[{name:"TOUCH",suggest:"please use SystemEvent.EventType.TOUCH_START, SystemEvent.EventType.TOUCH_MOVE, SystemEvent.EventType.TOUCH_END and SystemEvent.EventType.TOUCH_CANCEL instead"},{name:"MOUSE",suggest:"please use SystemEvent.EventType.MOUSE_DOWN, SystemEvent.EventType.MOUSE_MOVE, SystemEvent.EventType.MOUSE_UP, SystemEvent.EventType.MOUSE_WHEEL, Node.EventType.MOUSE_ENTER and Node.EventType.MOUSE_LEAVE instead"},{name:"KEYBOARD",suggest:"please use SystemEvent.EventType.KEY_DOWN and SystemEvent.EventType.KEY_UP instead"}]),u(lt,"EventMouse",["DOWN","UP","MOVE"].map((function(t){return{name:t,newName:"MOUSE_"+t,target:ce.EventType,targetName:"SystemEvent.EventType"}}))),u(lt,"EventMouse",[{name:"SCROLL",newName:"MOUSE_WHEEL",target:ce.EventType,targetName:"SystemEvent.EventType"}]),c(lt.prototype,"EventMouse.prototype",[{name:"eventType",suggest:"please use EventMouse.prototype.type instead"}]),u(gt,"EventTouch",[{name:"BEGAN",newName:"TOUCH_START",target:ce.EventType,targetName:"SystemEvent.EventType"}]),u(gt,"EventTouch",[{name:"MOVED",newName:"TOUCH_MOVE",target:ce.EventType,targetName:"SystemEvent.EventType"}]),u(gt,"EventTouch",[{name:"ENDED",newName:"TOUCH_END",target:ce.EventType,targetName:"SystemEvent.EventType"}]),u(gt,"EventTouch",[{name:"CANCELLED",newName:"TOUCH_CANCEL",target:ce.EventType,targetName:"SystemEvent.EventType"}]),c(gt.prototype,"EventTouch.prototype",[{name:"getEventCode",suggest:"please use EventTouch.prototype.type instead"}]),u(gt.prototype,"EventTouch.prototype",[{name:"getUILocationInView",newName:"getLocationInView",target:gt,targetName:"EventTouch"}]),c(P.KEY,"macro.KEY",["back","menu","0","1","2","3","4","5","6","7","8","9","0","*","+","-","/",";","=",",",".","[","]","dpadLeft","dpadRight","dpadUp","dpadDown","dpadCenter"].map((function(t){return{name:t}}))),c(P.KEY,"macro.KEY",[{name:"shift",suggest:"please use KeyCode.SHIFT_LEFT instead"}]),c(P.KEY,"macro.KEY",[{name:"ctrl",suggest:"please use KeyCode.CTRL_LEFT instead"}]),c(P.KEY,"macro.KEY",[{name:"alt",suggest:"please use KeyCode.ALT_LEFT instead"}]),c(P,"macro",[{name:"KEY",suggest:"please use KeyCode instead"}]),u(f.prototype,"Node",[{name:"childrenCount",newName:"children.length",customGetter:function(){return this.children.length}}]),u(f.prototype,"Node",[{name:"width",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._getUITransformComp().width},customSetter:function(t){this._getUITransformComp().width=t}},{name:"height",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._getUITransformComp().height},customSetter:function(t){this._getUITransformComp().height=t}},{name:"anchorX",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._getUITransformComp().anchorX},customSetter:function(t){this._getUITransformComp().anchorX=t}},{name:"anchorY",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._getUITransformComp().anchorY},customSetter:function(t){this._getUITransformComp().anchorY=t}},{name:"getAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(t){return t||(t=new i),t.set(this._getUITransformComp().anchorPoint),t}},{name:"setAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(t,e){this._getUITransformComp().setAnchorPoint(t,e)}},{name:"getContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(t){return t||(t=new _),t.set(this._getUITransformComp().contentSize),t}},{name:"setContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(t,e){"number"==typeof t?this._getUITransformComp().setContentSize(t,e):this._getUITransformComp().setContentSize(t)}}]),h(g.prototype,"SceneGlobals.prototype",[{name:"aspect"},{name:"selfShadow"},{name:"linear"},{name:"packing"},{name:"autoAdapt"},{name:"fixedArea"},{name:"pcf"},{name:"bias"},{name:"normalBias"},{name:"near"},{name:"far"},{name:"shadowDistance"},{name:"invisibleOcclusionRange"},{name:"orthoSize"},{name:"saturation"}]),u(g.prototype,"SceneGlobals.prototype",[{name:"distance",newName:"planeHeight"},{name:"normal",newName:"planeDirection"},{name:"size",newName:"shadowMapSize"}]),h(f.prototype,"Node.prototype",[{name:"addLayer"},{name:"removeLayer"}]),u(T.prototype,"NodeUIProperties",[{name:"opacityDirty",newName:"colorDirty"}]),h(rt,"Layers",[{name:"All"},{name:"RaycastMask"},{name:"check"}]),u(rt,"Layers",[{name:"Default",newName:"DEFAULT",target:rt.Enum,targetName:"Layers.Enum"},{name:"Always",newName:"ALWAYS",target:rt.Enum,targetName:"Layers.Enum"},{name:"IgnoreRaycast",newName:"IGNORE_RAYCAST",target:rt.Enum,targetName:"Layers.Enum"},{name:"Gizmos",newName:"GIZMOS",target:rt.Enum,targetName:"Layers.Enum"},{name:"Editor",newName:"EDITOR",target:rt.Enum,targetName:"Layers.Enum"},{name:"UI",newName:"UI_3D",target:rt.Enum,targetName:"Layers.Enum"},{name:"UI2D",newName:"UI_2D",target:rt.Enum,targetName:"Layers.Enum"},{name:"SceneGizmo",newName:"SCENE_GIZMO",target:rt.Enum,targetName:"Layers.Enum"},{name:"makeInclusiveMask",newName:"makeMaskInclude",target:rt,targetName:"Layers"},{name:"makeExclusiveMask",newName:"makeMaskExclude",target:rt,targetName:"Layers"}]),h(rt.Enum,"Layers.Enum",[{name:"ALWAYS"}]),h(rt.BitMask,"Layers.BitMask",[{name:"ALWAYS"}]);var ve=H.HideInHierarchy,de=H.DontSave,le=t("b",v("cc.PrivateNode")(_e=function(t){function e(e){var n;return n=t.call(this,e)||this,F(12003,n.name),n.hideFlags|=de|ve,n}return C(e,t),e}(f))||_e);function fe(t,e){if(!e){var n=at.director.getScene();if(!n)return null;e=n}return e.getChildByPath(t)}u(Tt,"SystemEventType",["MOUSE_ENTER","MOUSE_LEAVE","TRANSFORM_CHANGED","SCENE_CHANGED_FOR_PERSISTS","SIZE_CHANGED","ANCHOR_CHANGED","COLOR_CHANGED","CHILD_ADDED","CHILD_REMOVED","PARENT_CHANGED","NODE_DESTROYED","LAYER_CHANGED","SIBLING_ORDER_CHANGED"].map((function(t){return{name:t,target:f.EventType,targetName:"Node.EventType"}}))),u(f.EventType,"Node.EventType",[{name:"DEVICEMOTION",target:ce.EventType,targetName:"SystemEvent.EventType"},{name:"KEY_DOWN",target:ce.EventType,targetName:"SystemEvent.EventType"},{name:"KEY_UP",target:ce.EventType,targetName:"SystemEvent.EventType"}]),at.PrivateNode=le,e({BaseNode:{newName:"Node",since:"3.7.0",removed:!1}}),at.find=fe;var ge=A,Te=H.IsStartCalled,pe=H.IsOnEnableCalled;function Ee(t,e){for(var n=e.constructor._executionOrder,i=e._id,a=0,o=t.length-1,r=o>>>1;a<=o;r=a+o>>>1){var s=t[r],u=s.constructor._executionOrder;if(u>n)o=r-1;else if(u<n)a=r+1;else{var c=s._id;if(c>i)o=r-1;else{if(!(c<i))return r;a=r+1}}}return~a}function me(t,e){for(var n=t.array,i=t.i+1;i<n.length;){var a=n[i];a.node._activeInHierarchy?++i:(t.removeAt(i),e&&(a._objFlags&=~e))}}H.IsEditorOnEnableCalled;var Ie=function(){function t(t){var e=k;this._zero=new e([]),this._neg=new e([]),this._pos=new e([]),this._invoke=t}return D(t,[{key:"zero",get:function(){return this._zero}},{key:"neg",get:function(){return this._neg}},{key:"pos",get:function(){return this._pos}}]),t}();function be(t,e){return t.constructor._executionOrder-e.constructor._executionOrder}Ie.stableRemoveInactive=me;var Re=function(t){function e(){return t.apply(this,arguments)||this}C(e,t);var n=e.prototype;return n.add=function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).array.push(t)},n.remove=function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).fastRemove(t)},n.cancelInactive=function(t){me(this._zero,t),me(this._neg,t),me(this._pos,t)},n.invoke=function(){var t=this._neg;t.array.length>0&&(t.array.sort(be),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort(be),this._invoke(e),e.array.length=0)},e}(Ie),ye=function(t){function e(e){return t.call(this,e)||this}C(e,t);var n=e.prototype;return n.add=function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var n=e<0?this._neg.array:this._pos.array,i=Ee(n,t);i<0&&n.splice(~i,0,t)}},n.remove=function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var n=e<0?this._neg:this._pos,i=Ee(n.array,t);i>=0&&n.removeAt(i)}},n.invoke=function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)},e}(Ie);function Se(t,e,n){var i="var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];"+t+"}",a=e?Function("it","dt",i):Function("it",i);return Ne(Function("c","dt",t),a,n)}function Ne(t,e,n){return function(i,a){try{e(i,a)}catch(e){at._throw(e);var o=i.array;for(n&&(o[i.i]._objFlags|=n),++i.i;i.i<o.length;++i.i)try{t(o[i.i],a)}catch(t){at._throw(t),n&&(o[i.i]._objFlags|=n)}}}}var Oe=Se("c.start();c._objFlags|="+Te,!1,Te),Le=Se("c.update(dt)",!0),we=Se("c.lateUpdate(dt)",!0),Ge=function(t){var e=at.director._compScheduler,n=t.array;for(t.i=0;t.i<n.length;++t.i){var i=n[t.i];i._enabled&&(i.onEnable(),!i.node._activeInHierarchy||e._onEnabled(i))}},Ce=(t("C",function(){function t(){this._deferredComps=[],this.unscheduleAll()}var e=t.prototype;return e.unscheduleAll=function(){this.startInvoker=new Re(Oe),this.updateInvoker=new ye(Le),this.lateUpdateInvoker=new ye(we),this._updating=!1},e._onEnabled=function(t){at.director.getScheduler().resumeTarget(t),t._objFlags|=pe,this._updating?this._deferredComps.push(t):this._scheduleImmediate(t)},e._onDisabled=function(t){at.director.getScheduler().pauseTarget(t),t._objFlags&=~pe;var e=this._deferredComps.indexOf(t);e>=0?ge(this._deferredComps,e):(!t.internalStart||t._objFlags&Te||this.startInvoker.remove(t),t.internalUpdate&&this.updateInvoker.remove(t),t.internalLateUpdate&&this.lateUpdateInvoker.remove(t))},e.enableComp=function(t,e){if(!(t._objFlags&pe)){if(t.internalOnEnable){if(e)return void e.add(t);if(t.internalOnEnable(),!t.node.activeInHierarchy)return}this._onEnabled(t)}},e.disableComp=function(t){t._objFlags&pe&&(t.internalOnDisable&&t.internalOnDisable(),this._onDisabled(t))},e.startPhase=function(){this._updating=!0,this.startInvoker.invoke(),this._startForNewComps()},e.updatePhase=function(t){this.updateInvoker.invoke(t)},e.lateUpdatePhase=function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1,this._startForNewComps()},e._startForNewComps=function(){this._deferredComps.length>0&&(this._deferredSchedule(),this.startInvoker.invoke())},e._scheduleImmediate=function(t){"function"!=typeof t.internalStart||t._objFlags&Te||this.startInvoker.add(t),"function"==typeof t.internalUpdate&&this.updateInvoker.add(t),"function"==typeof t.internalLateUpdate&&this.lateUpdateInvoker.add(t)},e._deferredSchedule=function(){for(var t=this._deferredComps,e=0,n=t.length;e<n;e++)this._scheduleImmediate(t[e]);t.length=0},t}()),H.IsPreloadStarted),Me=H.IsOnLoadStarted,Ae=H.IsOnLoadCalled,De=H.IsOnEnableCalled,Ue=H.Deactivating,Pe=function(t){function e(e){return t.call(this,e)||this}C(e,t);var n=e.prototype;return n.add=function(t){this._zero.array.push(t)},n.remove=function(t){this._zero.fastRemove(t)},n.cancelInactive=function(t){Ie.stableRemoveInactive(this._zero,t)},n.invoke=function(){this._invoke(this._zero),this._zero.array.length=0},e}(Ie),He=Se("c.__preload();"),Fe=Se("c.onLoad();c._objFlags|="+Ae,!1,Ae),ke=new K(4);function Ke(t,e,n){W(3817,t.name,n),Y("Corrupted component value:",e),e?t._removeComponent(e):j(t.getWritableComponents(),n)}ke.get=function(){var t=this._get()||{preload:new Pe(He),onLoad:new Re(Fe),onEnable:new Re(Ge)};t.preload.zero.i=-1;var e=t.onLoad;return e.zero.i=-1,e.neg.i=-1,e.pos.i=-1,(e=t.onEnable).zero.i=-1,e.neg.i=-1,e.pos.i=-1,t},t("N",function(){function t(){this.reset()}var e=t.prototype;return e.reset=function(){this._activatingStack=[]},e.activateNode=function(t,e){if(e){var n=ke.get();n&&(this._activatingStack.push(n),this._activateNodeRecursively(t,n.preload,n.onLoad,n.onEnable),n.preload.invoke(),n.onLoad.invoke(),n.onEnable.invoke(),this._activatingStack.pop(),ke.put(n))}else{this._deactivateNodeRecursively(t);for(var i,a=this._activatingStack,o=y(a);!(i=o()).done;){var r=i.value;r.preload.cancelInactive(Ce),r.onLoad.cancelInactive(Me),r.onEnable.cancelInactive(De)}}t.emit(b.ACTIVE_IN_HIERARCHY_CHANGED,t)},e.activateComp=function(t,e,n,i){if(x(t,!0)&&(t._objFlags&Ce||(t._objFlags|=Ce,t.internalPreload&&(e?e.add(t):t.internalPreload())),t._objFlags&Me||(t._objFlags|=Me,t.internalOnLoad?n?n.add(t):(t.internalOnLoad(),t._objFlags|=Ae):t._objFlags|=Ae),t._enabled)){if(B(t.node,V(3823,t.uuid,t.name)),!t.node.activeInHierarchy)return;at.director._compScheduler.enableComp(t,i)}},e.destroyComp=function(t){at.director._compScheduler.disableComp(t),t.internalOnDestroy&&t._objFlags&Ae&&t.internalOnDestroy()},e._activateNodeRecursively=function(t,e,n,i){if(t._objFlags&Ue)W(3816,t.name);else{t._setActiveInHierarchy(!0);for(var a=t.components.length,o=0;o<a;++o){var r=t.components[o];r instanceof at.Component?this.activateComp(r,e,n,i):(Ke(t,r,o),--o,--a)}for(var s=0,u=t.children.length;s<u;++s){var c=t.children[s];c.active&&this._activateNodeRecursively(c,e,n,i)}t._onPostActivated(!0)}},e._deactivateNodeRecursively=function(t){t._objFlags|=Ue,t._setActiveInHierarchy(!1);for(var e=t.components.length,n=0;n<e;++n){var i=t.components[n];if(i._enabled&&(at.director._compScheduler.disableComp(i),t.activeInHierarchy))return void(t._objFlags&=~Ue)}for(var a=0,o=t.children.length;a<o;++a){var r=t.children[a];if(r.activeInHierarchy&&(this._deactivateNodeRecursively(r),t.activeInHierarchy))return void(t._objFlags&=~Ue)}t._onPostActivated(!1),t._objFlags&=~Ue},t}());var xe=H.Destroyed,Be=H.PersistentMask,Ve=S.Attr.DELIMETER+"default",We=S.IDENTIFIER_RE,Ye="var ",je="o",Xe={"cc.ClickEvent":!1,"cc.PrefabInfo":!1},ze=S.escapeForJS,Ze=function(){function t(t,e){this.varName=t,this.expression=e}return t.prototype.toString=function(){return Ye+this.varName+"="+this.expression+";"},t}();function $e(t,e){return e instanceof Ze?new Ze(e.varName,t+e.expression):t+e}function Qe(t,e,n){Array.isArray(n)?(n[0]=$e(e,n[0]),t.push(n)):t.push($e(e,n)+";")}var qe=function(){function t(t){this._exps=[],this._targetExp=t}var e=t.prototype;return e.setTargetExp=function(t){this._targetExp=t},e.append=function(t,e){this._exps.push([t,e])},e.writeCode=function(t){var e;if(this._exps.length>1)t.push("t="+this._targetExp+";"),e="t";else{if(1!==this._exps.length)return;e=this._targetExp}for(var n=0;n<this._exps.length;n++){var i=this._exps[n];Qe(t,e+Je(i[0])+"=",i[1])}},t}();function Je(t){return We.test(t)?"."+t:"["+ze(t)+"]"}qe.pool=new K((function(t){t._exps.length=0,t._targetExp=null}),1),qe.pool.get=function(t){var e=this._get()||new qe;return e.setTargetExp(t),e};var tn,en,nn,an,on,rn,sn=function(){function t(t,e){var n;this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.parent=e,this.funcModuleCache=X(),z(this.funcModuleCache,Xe),this.codeArray.push(Ye+je+",t;","if(R){","o=R;","}else{","o=R=new "+this.getFuncModule(t.constructor,!0)+"();","}"),t._iN$t={globalVar:"R"},this.objsToClear_iN$t.push(t),this.enumerateObject(this.codeArray,t),this.globalVariables.length>0&&(n=Ye+this.globalVariables.join(",")+";");var i=mt(["return (function(R){",n||[],this.codeArray,"return o;","})"]);this.result=Function("O","F",i)(this.objs,this.funcs);for(var a=0,o=this.objsToClear_iN$t.length;a<o;++a)this.objsToClear_iN$t[a]._iN$t=null;this.objsToClear_iN$t.length=0}var e=t.prototype;return e.getFuncModule=function(t,e){var n=Z(t);if(n){var i=this.funcModuleCache[n];if(i)return i;if(void 0===i){var a=-1!==n.indexOf(".");if(a)try{if(a=t===Function("return "+n)())return this.funcModuleCache[n]=n,n}catch(t){}}}var o=this.funcs.indexOf(t);o<0&&(o=this.funcs.length,this.funcs.push(t));var r="F["+o+"]";return e&&(r="("+r+")"),this.funcModuleCache[n]=r,r},e.getObjRef=function(t){var e=this.objs.indexOf(t);return e<0&&(e=this.objs.length,this.objs.push(t)),"O["+e+"]"},e.setValueType=function(t,e,n,i){var a=qe.pool.get(i),o=e.constructor.__props__;o||(o=Object.keys(e));for(var r=0;r<o.length;r++){var s=o[r],u=n[s];if(e[s]!==u){var c=this.enumerateField(n,s,u);a.append(s,c)}}a.writeCode(t),qe.pool.put(a)},e.enumerateCCClass=function(t,e,n){for(var i=n.__values__,a=S.Attr.getClassAttrs(n),o=0;o<i.length;o++){var r=i[o],s=e[r],u=a[r+Ve];if(!un(u,s))if("object"==typeof s&&s instanceof ot.ValueType&&(u=S.getDefault(u))&&u.constructor===s.constructor){var c=je+Je(r);this.setValueType(t,u,s,c)}else this.setObjProp(t,e,r,s)}},e.instantiateArray=function(t){if(0===t.length)return"[]";var e="a"+ ++this.localVariableId,n=[new Ze(e,"new Array("+t.length+")")];t._iN$t={globalVar:"",source:n},this.objsToClear_iN$t.push(t);for(var i=0;i<t.length;++i)Qe(n,e+"["+i+"]=",this.enumerateField(t,i,t[i]));return n},e.instantiateTypedArray=function(t){var e=t.constructor.name;if(0===t.length)return"new "+e;var n="a"+ ++this.localVariableId,i=[new Ze(n,"new "+e+"("+t.length+")")];t._iN$t={globalVar:"",source:i},this.objsToClear_iN$t.push(t);for(var a=0;a<t.length;++a)0!==t[a]&&Qe(i,n+"["+a+"]=",t[a]);return i},e.enumerateField=function(t,e,n){if("object"==typeof n&&n){var i=n._iN$t;if(i){var a=i.globalVar;if(!a){a=i.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(a);var o=i.source[0];i.source[0]=$e(a+"=",o)}return a}return ArrayBuffer.isView(n)?this.instantiateTypedArray(n):Array.isArray(n)?this.instantiateArray(n):this.instantiateObj(n)}return"function"==typeof n?this.getFuncModule(n):"string"==typeof n?ze(n):("_objFlags"===e&&$(t)&&(n&=Be),n)},e.setObjProp=function(t,e,n,i){Qe(t,je+Je(n)+"=",this.enumerateField(e,n,i))},e.enumerateObject=function(t,e){var n=e.constructor;if(Q(n))this.enumerateCCClass(t,e,n);else for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&(95!==i.charCodeAt(0)||95!==i.charCodeAt(1)||"__type__"===i)){var a=e[i];"object"==typeof a&&a&&a===e._iN$t||this.setObjProp(t,e,i,a)}},e.instantiateObj=function(t){if(t instanceof ot.ValueType)return S.getNewValueTypeCode(t);if(t instanceof ot.Asset)return this.getObjRef(t);if(t._objFlags&xe)return null;var e,n=t.constructor;if(Q(n)){if(this.parent)if(this.parent instanceof ot.Component){if(t instanceof ot.Node||t instanceof ot.Component)return this.getObjRef(t)}else if(this.parent instanceof ot.Node)if(t instanceof ot.Node){if(!t.isChildOf(this.parent))return this.getObjRef(t)}else if(t instanceof ot.Component){var i;if(null==(i=t.node)||!i.isChildOf(this.parent))return this.getObjRef(t)}e=new Ze(je,"new "+this.getFuncModule(n,!0)+"()")}else if(n===Object)e=new Ze(je,"{}");else{if(n)return this.getObjRef(t);e=new Ze(je,"Object.create(null)")}var a=[e];return t._iN$t={globalVar:"",source:a},this.objsToClear_iN$t.push(t),this.enumerateObject(a,t),["(function(){",a,"return o;})();"]},t}();function un(t,e){if("function"==typeof t)try{t=t()}catch(t){return!1}if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e&&t.constructor===e.constructor)if(t instanceof ot.ValueType){if(t.equals(e))return!0}else{if(Array.isArray(t))return 0===t.length&&0===e.length;if(t.constructor===Object)return q(t)&&q(e)}return!1}var cn=J({AUTO:0,SINGLE_INSTANCE:1,MULTI_INSTANCE:2}),_n=t("P",v("cc.Prefab")((rn=function(t){function e(){var e;return(e=t.call(this)||this).data=nn&&nn(),e.optimizationPolicy=an&&an(),e.persistent=on&&on(),e._createFunction=null,e._instantiatedTimes=0,e}C(e,t);var n=e.prototype;return n.createNode=function(t){var e=at.instantiate(this);e.name=this.name,t(null,e)},n.compileCreateFunction=function(){var t,e;this._createFunction=(e=(t=this.data)instanceof ot.Node&&t,new sn(t,e).result)},n._doInstantiate=function(t){return this.data._prefab||F(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(t)},n._instantiate=function(){var t;return this.optimizationPolicy!==cn.SINGLE_INSTANCE&&(this.optimizationPolicy===cn.MULTI_INSTANCE||this._instantiatedTimes+1>=e.OptimizationPolicyThreshold)?(t=this._doInstantiate(),this.data._instantiate(t)):t=this.data._instantiate(),++this._instantiatedTimes,t},n.initDefault=function(e){t.prototype.initDefault.call(this,e),this.data=new f,this.data.name="(Missing Node)";var n=new at._PrefabInfo;n.asset=this,n.root=this.data,this.data._prefab=n},n.validate=function(){return!!this.data},n.onLoaded=function(){var t=this.data;p(t),E(t)},e}(R),rn.OptimizationPolicy=cn,rn.OptimizationPolicyThreshold=3,nn=d((en=rn).prototype,"data",[l],(function(){return null})),an=d(en.prototype,"optimizationPolicy",[l],(function(){return cn.AUTO})),on=d(en.prototype,"persistent",[l],(function(){return!1})),tn=en))||tn);tt(_n,"_utils",m),at.Prefab=_n,et(at,"cc._Prefab","Prefab")}}}));
//# sourceMappingURL=prefab-CJahvMeV.js.map
