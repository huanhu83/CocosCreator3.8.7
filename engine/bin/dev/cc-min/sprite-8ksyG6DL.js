System.register(["./gc-object-BD6DANSw.js","./index-BcjqSS2q.js","./_virtual_internal_constants-CVZmBipG.js","./global-exports-ZavlJGEN.js","./debug-view-zRQBd5E1.js","./node-event-BDYemSfE.js","./scene-D5fG1En6.js","./sprite-frame-CT0e6iHI.js","./ui-renderer-BG8n0rhU.js"],(function(t){"use strict";var e,r,i,a,s,n,o,p,l,_,u,c,h,f,y,d,m,D,F,T,A,M,R,S,E;return{setters:[function(t){e=t._,r=t.p,i=t.q,a=t.r,s=t.w,n=t.a,o=t.b},function(t){p=t.c,l=t.a,_=t.s,u=t.t,c=t.j,h=t.b,f=t.V},null,function(t){y=t.c},function(t){d=t.R},function(t){m=t.A},function(t){D=t.f,F=t.P,T=t.d,A=t.b},function(t){M=t.S,R=t.a},function(t){S=t.I,E=t.U}],execute:function(){var g,U,v,L,I,C,P,b,V,O,z,k,j,x,G,w,B,H,N,W,Z,Y,q,X,J,K,Q,$=t("b",p("cc.SpriteAtlas")((U=function(t){function a(e){var r;return(r=t.call(this,e)||this).spriteFrames=v&&v(),r}e(a,t);var s=a.prototype;return s.getTexture=function(){var t=Object.keys(this.spriteFrames);if(t.length>0){var e=this.spriteFrames[t[0]];return e&&e.texture}return null},s.getSpriteFrame=function(t){var e=this.spriteFrames[t];return e?(e.name||(e.name=t),e):null},s.getSpriteFrames=function(){var t=[],e=this.spriteFrames;for(var r in e)t.push(e[r]);return t},s._serialize=function(){return null},s._deserialize=function(t,e){var a=t;this._name=a.name;var s=a.spriteFrames;this.spriteFrames=r();for(var n=0;n<s.length;n+=2)e.result.push(this.spriteFrames,s[n],s[n+1],i(M))},a}(m),v=l(U.prototype,"spriteFrames",[_],(function(){return r()})),g=U))||g);y.SpriteAtlas=$,function(t){t[t.SIMPLE=0]="SIMPLE",t[t.SLICED=1]="SLICED",t[t.TILED=2]="TILED",t[t.FILLED=3]="FILLED"}(X||(X={})),a(X),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.RADIAL=2]="RADIAL"}(J||(J={})),a(J),function(t){t[t.CUSTOM=0]="CUSTOM",t[t.TRIMMED=1]="TRIMMED",t[t.RAW=2]="RAW"}(K||(K={})),a(K),t("a",Q),function(t){t.SPRITE_FRAME_CHANGED="spriteframe-changed"}(Q||t("a",Q={}));var tt=t("S",(L=p("cc.Sprite"),I=c(110),C=u($),P=u(M),b=u(X),V=u(J),O=u(K),L(z=I((q=function(t){function r(){var e;return(e=t.call(this)||this)._spriteFrame=j&&j(),e._type=x&&x(),e._fillType=G&&G(),e._sizeMode=w&&w(),e._fillCenter=B&&B(),e._fillStart=H&&H(),e._fillRange=N&&N(),e._isTrimmedMode=W&&W(),e._useGrayscale=Z&&Z(),e._atlas=Y&&Y(),e}e(r,t);var i=r.prototype;return i.__preload=function(){this.changeMaterialForDefine(),t.prototype.__preload.call(this)},i.onEnable=function(){t.prototype.onEnable.call(this),this._activateMaterial();var e=this._spriteFrame;e&&(this._updateUVs(),this._type===X.SLICED&&e.on(R.UV_UPDATED,this._updateUVs,this))},i.onDisable=function(){t.prototype.onDisable.call(this),this._spriteFrame&&this._type===X.SLICED&&this._spriteFrame.off(R.UV_UPDATED,this._updateUVs,this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.changeSpriteFrameFromAtlas=function(t){if(this._atlas){var e=this._atlas.getSpriteFrame(t);this.spriteFrame=e}else s(16377)},i.changeMaterialForDefine=function(){var t,e=this._instanceMaterialType;this._spriteFrame&&(t=this._spriteFrame.texture);var r=!1;if(t instanceof D){var i=t.getPixelFormat();r=i===F.RGBA_ETC1||i===F.RGB_A_PVRTC_4BPPV1||i===F.RGB_A_PVRTC_2BPPV1}r&&this.grayscale?this._instanceMaterialType=S.USE_ALPHA_SEPARATED_AND_GRAY:r?this._instanceMaterialType=S.USE_ALPHA_SEPARATED:this.grayscale?this._instanceMaterialType=S.GRAYSCALE:this._instanceMaterialType=S.ADD_COLOR_AND_TEXTURE,e!==this._instanceMaterialType&&this.updateMaterial()},i._updateBuiltinMaterial=function(){var e=t.prototype._updateBuiltinMaterial.call(this);if(this.spriteFrame&&this.spriteFrame.texture instanceof d){var r="rt-"+e.name,i=T.get(r);i||((i=new A(r)).copy(e,{defines:{SAMPLE_FROM_RT:!0}}),T.addAsset(r,i)),e=i}return e},i._render=function(t){t.commitComp(this,this.renderData,this._spriteFrame,this._assembler,null)},i._canRender=function(){if(!t.prototype._canRender.call(this))return!1;var e=this._spriteFrame;return!(!e||!e.texture)},i._flushAssembler=function(){var t=this,e=r.Assembler.getAssembler(t);t._assembler!==e&&(t.destroyRenderData(),t._assembler=e),t._renderData||e&&e.createData&&((t._renderData=e.createData(t)).material=t.getRenderMaterial(0),t._markForUpdateRenderData(),t.spriteFrame&&e.updateUVs(t),t._updateColor());var i=t._spriteFrame;i&&(t._type===X.SLICED?i.on(R.UV_UPDATED,t._updateUVs,t):i.off(R.UV_UPDATED,t._updateUVs,t))},i._applySpriteSize=function(){var t=this,e=t._spriteFrame;if(e){var r=t.node._uiProps;if(K.RAW===t._sizeMode){var i=e.originalSize;r.uiTransformComp.setContentSize(i)}else if(K.TRIMMED===t._sizeMode){var a=e.rect;r.uiTransformComp.setContentSize(a.width,a.height)}}},i._resized=function(){},i._activateMaterial=function(){var t=this._spriteFrame,e=this.getRenderMaterial(0);t&&e&&this._markForUpdateRenderData(),this.renderData&&(this.renderData.material=e)},i._updateUVs=function(){this._assembler&&this._assembler.updateUVs(this)},i._applySpriteFrame=function(t){var e=this,r=e._spriteFrame;t&&e._type===X.SLICED&&t.off(R.UV_UPDATED,e._updateUVs,e);var i=!1;r&&(t&&t.texture===r.texture||(i=!0),i&&(e.renderData&&(e.renderData.textureDirty=!0),(!!t&&t.texture instanceof d)!=r.texture instanceof d&&(e._instanceMaterialType=-1),e.changeMaterialForDefine()),e._applySpriteSize(),e._type===X.SLICED&&r.on(R.UV_UPDATED,e._updateUVs,e))},n(r,[{key:"spriteAtlas",get:function(){return this._atlas},set:function(t){this._atlas!==t&&(this._atlas=t)}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(this._spriteFrame!==t){var e=this._spriteFrame;this._spriteFrame=t,this._markForUpdateRenderData(),this._applySpriteFrame(e)}}},{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this._flushAssembler())}},{key:"fillType",get:function(){return this._fillType},set:function(t){this._fillType!==t&&(t===J.RADIAL||this._fillType===J.RADIAL?this.destroyRenderData():this.renderData&&this._markForUpdateRenderData(!0)),this._fillType=t,this._flushAssembler()}},{key:"fillCenter",get:function(){return this._fillCenter},set:function(t){this._fillCenter.x=t.x,this._fillCenter.y=t.y,this._type===X.FILLED&&this.renderData&&this._markForUpdateRenderData()}},{key:"fillStart",get:function(){return this._fillStart},set:function(t){this._fillStart=h(t,0,1),this._type===X.FILLED&&this.renderData&&(this._markForUpdateRenderData(),this._updateUVs())}},{key:"fillRange",get:function(){return this._fillRange},set:function(t){this._fillRange=h(t,-1,1),this._type===X.FILLED&&this.renderData&&(this._markForUpdateRenderData(),this._updateUVs())}},{key:"trim",get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._type===X.SIMPLE&&this.renderData&&this._markForUpdateRenderData(!0))}},{key:"grayscale",get:function(){return this._useGrayscale},set:function(t){this._useGrayscale!==t&&(this._useGrayscale=t,this.changeMaterialForDefine(),this.updateMaterial())}},{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode!==t&&(this._sizeMode=t,t!==K.CUSTOM&&this._applySpriteSize())}}]),r}(E),q.FillType=J,q.Type=X,q.SizeMode=K,q.EventType=Q,o((k=q).prototype,"spriteAtlas",[C],Object.getOwnPropertyDescriptor(k.prototype,"spriteAtlas"),k.prototype),o(k.prototype,"spriteFrame",[P],Object.getOwnPropertyDescriptor(k.prototype,"spriteFrame"),k.prototype),o(k.prototype,"type",[b],Object.getOwnPropertyDescriptor(k.prototype,"type"),k.prototype),o(k.prototype,"fillType",[V],Object.getOwnPropertyDescriptor(k.prototype,"fillType"),k.prototype),o(k.prototype,"sizeMode",[O],Object.getOwnPropertyDescriptor(k.prototype,"sizeMode"),k.prototype),j=l(k.prototype,"_spriteFrame",[_],(function(){return null})),x=l(k.prototype,"_type",[_],(function(){return X.SIMPLE})),G=l(k.prototype,"_fillType",[_],(function(){return J.HORIZONTAL})),w=l(k.prototype,"_sizeMode",[_],(function(){return K.TRIMMED})),B=l(k.prototype,"_fillCenter",[_],(function(){return new f(0,0)})),H=l(k.prototype,"_fillStart",[_],(function(){return 0})),N=l(k.prototype,"_fillRange",[_],(function(){return 0})),W=l(k.prototype,"_isTrimmedMode",[_],(function(){return!0})),Z=l(k.prototype,"_useGrayscale",[_],(function(){return!1})),Y=l(k.prototype,"_atlas",[_],(function(){return null})),z=k))||z)||z));y.Sprite=tt}}}));
//# sourceMappingURL=sprite-8ksyG6DL.js.map
